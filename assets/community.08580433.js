import{s}from"./supabase.c4c6be5d.js";const n=async e=>{try{const{data:o,error:r}=await s.from("follows").select("followed_id").eq("follower_id",e);if(r)throw r;const t=o.map(a=>a.followed_id);if(t.length===0)return[];const{data:c,error:l}=await s.from("players").select("*").in("user_id",t);if(l)throw l;return c}catch(o){throw console.error("Error fetching following:",o),o}},w=async e=>{try{const{data:o,error:r}=await s.from("follows").select("follower_id").eq("followed_id",e);if(r)throw r;const t=o.map(a=>a.follower_id);if(t.length===0)return[];const{data:c,error:l}=await s.from("players").select("*").in("user_id",t);if(l)throw l;return c}catch(o){throw console.error("Error fetching followers:",o),o}},d=async(e,o=[])=>{try{if(o.length===0){const{data:l,error:a}=await s.from("follows").select("followed_id").eq("follower_id",e);if(a)throw a;o=l.map(f=>f.followed_id)}const{data:r,error:t}=await s.from("players").select("*").neq("user_id",e).limit(20);if(t)throw t;return r.filter(l=>!o.includes(l.user_id)).slice(0,10)}catch(r){throw console.error("Error fetching suggested players:",r),r}},y=async(e,o)=>{try{const{error:r}=await s.from("follows").delete().eq("follower_id",e).eq("followed_id",o);if(r)throw r;return{success:!0}}catch(r){throw console.error("Error unfollowing player:",r),r}},h=async(e,o)=>{try{const{error:r}=await s.from("follows").insert([{follower_id:e,followed_id:o}]);if(r)throw r;return{success:!0}}catch(r){throw console.error("Error following player:",r),r}},u=(e,o)=>!e||!Array.isArray(e)?!1:e.some(r=>r.user_id===o);export{w as a,d as b,h as c,n as f,u as i,y as u};
