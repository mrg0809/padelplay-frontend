import{a6 as y,o as p,z as _,A as t,d as a,ac as b,a9 as c,D as g,B as s,a7 as u,a8 as m,E as h,t as i,e as D}from"./index.343c8145.js";import{Q as w}from"./QToolbarTitle.9aa9d658.js";import{Q}from"./QToolbar.998a6c3e.js";import{Q as x}from"./QHeader.74e9ea06.js";import{Q as T}from"./QSelect.3addf350.js";import{Q as C}from"./QBadge.79f62308.js";import{Q as f}from"./QTd.405af279.js";import{Q as A}from"./QTable.9143b50e.js";import{Q as V}from"./QBanner.5b79c17c.js";import{Q as k}from"./QPage.c2a4954a.js";import{Q as q,a as N}from"./QLayout.cf8964e2.js";import{a as I,b as F}from"./admin.3e0a6143.js";import{A as M}from"./AdminNavigationMenu.07f9c1dd.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.29699f7b.js";import"./QItem.a116c19a.js";import"./QItemLabel.05574ce5.js";import"./QMenu.0333eeb9.js";import"./position-engine.74637788.js";import"./selection.77230eb1.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.0714427a.js";import"./QMarkupTable.c8086169.js";import"./use-fullscreen.8f39ced4.js";import"./api.c78da0f8.js";import"./QTabs.ffe1e49b.js";import"./QFooter.32609e6a.js";const S={name:"AdminTransactions",components:{AdminNavigationMenu:M},data(){return{transactionData:{transactions:[],total_count:0},clubOptions:[],filters:{startDate:"",endDate:"",clubId:null},loading:!1,error:null,pagination:{rowsPerPage:15},columns:[{name:"order_date",required:!0,label:"Fecha",align:"left",field:"order_date",sortable:!0},{name:"transaction_id",label:"ID Transacci\xF3n",align:"left",field:"transaction_id"},{name:"user_name",label:"Usuario",align:"left",field:"user_name"},{name:"club_name",label:"Club",align:"left",field:"club_name"},{name:"total_amount",label:"Monto",align:"right",field:"total_amount",sortable:!0},{name:"payment_method",label:"M\xE9todo",align:"center",field:"payment_method"},{name:"payment_status",label:"Estado",align:"center",field:"payment_status"}]}},computed:{totalAmount(){return this.transactionData.transactions.reduce((e,l)=>e+(parseFloat(l.total_amount)||0),0)},averageAmount(){return this.transactionData.transactions.length>0?this.totalAmount/this.transactionData.transactions.length:0}},async mounted(){await this.loadClubs(),await this.loadTransactions()},methods:{async loadClubs(){try{const e=await I();this.clubOptions=[{label:"Todos los clubes",value:null},...e.clubs.map(l=>({label:l.name,value:l.id}))]}catch(e){console.error("Error loading clubs:",e)}},async loadTransactions(){this.loading=!0,this.error=null;try{const e={startDate:this.filters.startDate||void 0,endDate:this.filters.endDate||void 0,clubId:this.filters.clubId||void 0};this.transactionData=await F(e)}catch(e){this.error="Error al cargar las transacciones: "+e.message,console.error("Error loading transactions:",e)}finally{this.loading=!1}},clearFilters(){this.filters={startDate:"",endDate:"",clubId:null},this.loadTransactions()},onRequest(e){},formatCurrency(e){return e?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e):"$0.00"},formatDate(e){return e?new Date(e).toLocaleDateString("es-MX"):"N/A"},formatStatus(e){return{succeeded:"Exitoso",pending:"Pendiente",failed:"Fallido",cancelled:"Cancelado"}[e]||e},getStatusColor(e){return{succeeded:"positive",pending:"warning",failed:"negative",cancelled:"grey"}[e]||"grey"}}},U={class:"q-pa-md"},E={class:"row q-gutter-md items-end"},P={class:"col-md-3 col-sm-6"},R={class:"col-md-3 col-sm-6"},L={class:"col-md-4 col-sm-12"},O={class:"col-auto"},X={class:"row q-gutter-md q-mb-lg"},z={class:"col-md-4"},H={class:"text-h4 text-primary"},j={class:"col-md-4"},G={class:"text-h4 text-positive"},J={class:"col-md-4"},K={class:"text-h4 text-secondary"},W={class:"text-weight-bold"};function Y(e,l,Z,$,r,n){const v=y("AdminNavigationMenu");return p(),_(q,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[a(x,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[a(Q,null,{default:t(()=>[a(w,null,{default:t(()=>[a(b,{name:"account_balance_wallet",class:"q-mr-sm"}),l[3]||(l[3]=c(" Transacciones ",-1))]),_:1}),a(g,{flat:"",icon:"refresh",onClick:n.loadTransactions,loading:r.loading,label:"Actualizar"},null,8,["onClick","loading"])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(k,{padding:"",class:"bg-dark"},{default:t(()=>[s("div",U,[l[7]||(l[7]=s("div",{class:"row q-mb-lg"},[s("div",{class:"col"},[s("p",{class:"text-grey-4"}," Consulta todas las transacciones de la plataforma ")])],-1)),a(u,{class:"filter-card q-mb-md"},{default:t(()=>[a(m,null,{default:t(()=>[s("div",E,[s("div",P,[a(h,{modelValue:r.filters.startDate,"onUpdate:modelValue":[l[0]||(l[0]=o=>r.filters.startDate=o),n.loadTransactions],type:"date",label:"Fecha inicio",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",R,[a(h,{modelValue:r.filters.endDate,"onUpdate:modelValue":[l[1]||(l[1]=o=>r.filters.endDate=o),n.loadTransactions],type:"date",label:"Fecha fin",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",L,[a(T,{modelValue:r.filters.clubId,"onUpdate:modelValue":[l[2]||(l[2]=o=>r.filters.clubId=o),n.loadTransactions],options:r.clubOptions,"option-value":"value","option-label":"label",label:"Filtrar por club",filled:"",dark:"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",O,[a(g,{flat:"",icon:"clear",color:"grey-7",onClick:n.clearFilters,label:"Limpiar"},null,8,["onClick"])])])]),_:1})]),_:1}),s("div",X,[s("div",z,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[4]||(l[4]=s("div",{class:"text-h6 text-white"},"Total Transacciones",-1)),s("div",H,i(r.transactionData.total_count),1)]),_:1})]),_:1})]),s("div",j,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[5]||(l[5]=s("div",{class:"text-h6 text-white"},"Monto Total",-1)),s("div",G,i(n.formatCurrency(n.totalAmount)),1)]),_:1})]),_:1})]),s("div",J,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[6]||(l[6]=s("div",{class:"text-h6 text-white"},"Promedio",-1)),s("div",K,i(n.formatCurrency(n.averageAmount)),1)]),_:1})]),_:1})])]),a(u,{class:"table-card"},{default:t(()=>[a(m,{class:"q-pa-none"},{default:t(()=>[a(A,{rows:r.transactionData.transactions,columns:r.columns,"row-key":"id",flat:"",dark:"",loading:r.loading,pagination:r.pagination,onRequest:n.onRequest},{"body-cell-payment_status":t(o=>[a(f,{props:o},{default:t(()=>[a(C,{color:n.getStatusColor(o.value),label:n.formatStatus(o.value)},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-total_amount":t(o=>[a(f,{props:o},{default:t(()=>[s("span",W,i(n.formatCurrency(o.value)),1)]),_:2},1032,["props"])]),"body-cell-order_date":t(o=>[a(f,{props:o},{default:t(()=>[c(i(n.formatDate(o.value)),1)]),_:2},1032,["props"])]),"body-cell-club_name":t(o=>[a(f,{props:o},{default:t(()=>{var d;return[c(i(((d=o.row.clubs)==null?void 0:d.name)||"N/A"),1)]}),_:2},1032,["props"])]),"body-cell-user_name":t(o=>[a(f,{props:o},{default:t(()=>{var d;return[c(i(((d=o.row.profiles)==null?void 0:d.full_name)||"N/A"),1)]}),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","pagination","onRequest"])]),_:1})]),_:1}),r.error?(p(),_(V,{key:0,class:"bg-negative text-white q-mt-md"},{avatar:t(()=>[a(b,{name:"error"})]),default:t(()=>[c(" "+i(r.error),1)]),_:1})):D("",!0)])]),_:1})]),_:1}),a(v)]),_:1})}var Va=B(S,[["render",Y],["__scopeId","data-v-33df11b0"]]);export{Va as default};
