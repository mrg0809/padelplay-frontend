import{y as w,a6 as h,o as d,z as p,A as r,d as o,B as s,a9 as v,D as n,a7 as g,a8 as u,a as f,Q as _,ac as C,af as k,E as c,ad as Q,ae as V}from"./index.a0492954.js";import{Q as x}from"./QHeader.30ed5ffd.js";import{Q as D}from"./QTd.a13ab39d.js";import{Q as q}from"./QTable.d1eadde1.js";import{Q as N}from"./QSelect.a49ffe54.js";import{Q as E}from"./QPage.ba13530a.js";import{Q as M,a as B}from"./QLayout.34772a42.js";import{C as T}from"./ClosePopup.5f41115c.js";import{n as U}from"./navigationUtils.2c4b9dee.js";import{C as S}from"./ClubNavigationMenu.dfae488b.js";import{g as b,a as y}from"./api.fb60109d.js";import{s as I}from"./supabase.6e6ca5a2.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import"./QList.87883dfb.js";import"./QMarkupTable.f8726413.js";import"./use-fullscreen.576a914f.js";import"./QChip.a56927f6.js";import"./QItem.f78ebf7f.js";import"./QItemLabel.5c5982b3.js";import"./QMenu.c2db426c.js";import"./position-engine.f9bd9f7c.js";import"./selection.3cd24490.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QTabs.9c45f5db.js";import"./QFooter.a1ddf79c.js";const z={data(){return{loading:!1,isProductDialogOpen:!1,products:[],newProduct:{name:"",brand:"",category:"",price:0,modality:"venta"},columns:[{name:"name",label:"Nombre",field:"name",align:"left"},{name:"brand",label:"Marca",field:"brand",align:"left"},{name:"category",label:"Categor\xEDa",field:"category",align:"left"},{name:"price",label:"Precio",field:"price",align:"left"},{name:"modality",label:"Modalidad",field:"modality",align:"left"},{name:"actions",label:"Acciones",field:"actions",align:"center"}]}},components:{ClubNavigationMenu:S},setup(){return{userStore:w()}},methods:{async fetchProducts(){this.loading=!0;try{const l=b();if(!l||!l.club_id)throw new Error("No se pudo obtener el club_id del usuario.");const{data:e,error:m}=await I.from("club_products").select("*").eq("club_id",l.club_id);if(m)throw m;this.products=e}catch(l){console.error("Error al obtener los productos:",l),this.$q.notify({type:"negative",message:"Error al cargar los productos"})}finally{this.loading=!1}},openProductDialog(){this.isProductDialogOpen=!0},async saveProduct(){try{const l=b();if(!l||!l.club_id)throw new Error("No se pudo obtener el club_id del usuario.");const e={...this.newProduct,club_id:l.club_id};await y.post("/products",e),this.isProductDialogOpen=!1,await this.fetchProducts(),this.$q.notify({type:"positive",message:"Producto agregado exitosamente."})}catch(l){console.error("Error al guardar el producto:",l),this.$q.notify({type:"negative",message:"Error al guardar el producto. Intenta nuevamente."})}},async deleteProduct(l){try{await y.delete(`/products/${l}`),await this.fetchProducts(),this.$q.notify({type:"positive",message:"Producto eliminado exitosamente."})}catch(e){console.error("Error al eliminar el producto:",e),this.$q.notify({type:"negative",message:"Error al eliminar el producto. Intenta nuevamente."})}},goBack(){this.$router.back()},goToDashboard(){U(this.$router,this.userStore)}},mounted(){this.fetchProducts()}},A={class:"header-content"},F={class:"greeting"},L={class:"header-icons"},G={key:0,class:"text-center q-pa-md"},H={key:1,class:"text-center q-pa-md"};function R(l,e,m,j,t,i){const P=h("ClubNavigationMenu");return d(),p(M,{view:"hHh lpR fFf",class:"body text-black"},{default:r(()=>[o(x,{elevated:"",class:"bg-primary text-white"},{default:r(()=>[s("div",A,[s("div",F,[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...a)=>i.goToDashboard&&i.goToDashboard(...a))}),e[7]||(e[7]=v(" Gesti\xF3n de Productos ",-1))]),s("div",L,[o(n,{flat:"",round:"",icon:"close",onClick:i.goBack},null,8,["onClick"])])])]),_:1}),o(B,null,{default:r(()=>[o(E,{class:"q-pa-md"},{default:r(()=>[o(g,{class:"transparent-card q-mb-md"},{default:r(()=>[o(u,null,{default:r(()=>[...e[8]||(e[8]=[s("div",{class:"text-h6"},"Lista de Productos",-1)])]),_:1}),o(u,null,{default:r(()=>[t.loading?(d(),f("div",G,[o(_,{color:"primary",size:"xl"}),e[9]||(e[9]=s("p",{class:"q-mt-sm"},"Cargando productos...",-1))])):t.products.length===0?(d(),f("div",H,[o(C,{name:"o_shopping_cart",size:"2em"}),e[10]||(e[10]=s("p",{class:"q-mt-sm"},"No hay productos registrados.",-1))])):(d(),p(q,{key:2,rows:t.products,columns:t.columns,"row-key":"id",flat:"",bordered:"",class:"transparent-table"},{"body-cell-actions":r(a=>[o(D,{props:a},{default:r(()=>[o(n,{flat:"",round:"",color:"negative",icon:"delete",onClick:J=>i.deleteProduct(a.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]))]),_:1})]),_:1}),o(n,{glossy:"",round:"",size:"lg",color:"black",icon:"add",class:"fixed-bottom-right q-mb-xl",onClick:i.openProductDialog},null,8,["onClick"]),o(k,{modelValue:t.isProductDialogOpen,"onUpdate:modelValue":e[6]||(e[6]=a=>t.isProductDialogOpen=a)},{default:r(()=>[o(g,{class:"bg-black text-white",style:{"min-width":"400px"}},{default:r(()=>[o(u,null,{default:r(()=>[...e[11]||(e[11]=[s("div",{class:"text-h6"},"Agregar Producto",-1)])]),_:1}),o(u,null,{default:r(()=>[o(c,{modelValue:t.newProduct.name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.newProduct.name=a),label:"Nombre",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.brand,"onUpdate:modelValue":e[2]||(e[2]=a=>t.newProduct.brand=a),label:"Marca",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.category,"onUpdate:modelValue":e[3]||(e[3]=a=>t.newProduct.category=a),label:"Familia/Categor\xEDa",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.price,"onUpdate:modelValue":e[4]||(e[4]=a=>t.newProduct.price=a),label:"Precio",type:"number",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(N,{modelValue:t.newProduct.modality,"onUpdate:modelValue":e[5]||(e[5]=a=>t.newProduct.modality=a),options:[{label:"Venta",value:"sale"},{label:"Renta",value:"rental"}],label:"Modalidad",outlined:"",dense:"",color:"white","emit-value":"","map-options":""},null,8,["modelValue"])]),_:1}),o(Q,{align:"right"},{default:r(()=>[V(o(n,{flat:"",label:"Cancelar",color:"primary"},null,512),[[T]]),o(n,{flat:"",label:"Guardar",color:"secondary",onClick:i.saveProduct},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(P)]),_:1})}var he=O(z,[["render",R],["__scopeId","data-v-43a56a8c"]]);export{he as default};
