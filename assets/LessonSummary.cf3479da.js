import{Q as L}from"./QHeader.50bc2e62.js";import{a9 as A,F as E,r as d,j as C,B as H,aa as M,q as v,G as J,H as r,v as t,I as o,ab as N,ac as D,ad as i,x as n,s as f,ae as k,af as T,ag as R,ah as F,J as y,ai as U,aj as j,K as z}from"./index.2a30a2c5.js";import{Q as G}from"./QTooltip.5f181cc9.js";import{Q as K}from"./QPage.5044f4b9.js";import{Q as W,a as X}from"./QLayout.8d0b6f53.js";import{Q as Y}from"./QItemLabel.b752b1cc.js";import{Q as Z,a as I}from"./QItem.78b33975.js";import{C as $}from"./ClosePopup.6a051228.js";import{u as aa}from"./use-quasar.86cd4a79.js";import{g as ea}from"./products.c2ff2211.js";import{n as oa}from"./navigationUtils.2c4b9dee.js";import{a as ta}from"./api.2af71db3.js";import{P as la}from"./PlayerNavigationMenu.963e5d5c.js";import{_ as ra}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.ee8ad296.js";import"./selection.6ef1e55c.js";import"./supabase.aa6636fe.js";import"./QTabs.51c705f8.js";import"./rtl.276c3f1b.js";import"./QFooter.6e10ed36.js";const na={components:{PlayerNavigationMenu:la},setup(){const u=A(),a=E(),x=aa(),e=d({clubId:u.query.clubId||"",clubName:u.query.clubName||"Club no especificado",coachName:u.query.coachName||"No especificado",courtId:u.query.courtId||"",courtName:u.query.courtName||"Cancha no especificada",date:u.query.date||"Fecha no especificada",people:u.query.people||0,time:u.query.time||"Hora no especificada",price:parseFloat(u.query.price)||0}),b=d(4),_=d(e.value.price+b.value*e.value.price/100),c=d(),l=d({}),m=d([]),P=d(!1),g=d("partial"),w=d([{label:"Pagar mi parte",value:"partial"},{label:"Pagar el total",value:"total"}]),S=C(()=>`Continuar al pago de $${g.value==="total"?p.value.toFixed(2):(p.value/4).toFixed(2)}`),q=C(()=>m.value&&Array.isArray(m.value)?m.value.reduce((s,Q)=>s+Q.product.price*Q.quantity,0):0),p=C(()=>_.value+q.value),V=()=>{P.value=!0},B=()=>{m.value=c.value.filter(s=>l.value[s.id]>0).map(s=>({product:s,quantity:l.value[s.id]})),P.value=!1},O=async()=>{try{const s=g.value==="total"?p.value:p.value/4,h=(await ta.post("payments/payment_order_and_split_payment",{total_price:p.value,pay_total:g.value==="total"})).data.payment_order_id;a.push({name:"StripePayment",query:{reservationDetails:JSON.stringify({...e.value,payment_order_id:h}),total:p.value,paymentOption:g.value,selectedProducts:JSON.stringify(m.value),amountToPay:s}})}catch(s){console.error("Error al obtener payment_order:",s),x.notify({type:"negative",message:"Error al generar orden de pago. Por favor intente de nuevo."})}};return H(async()=>{c.value=await ea(e.value.clubId),c.value.forEach(s=>l.value[s.id]=0)}),{reservationDetails:e,commission:b,subtotal:_,products:c,productQuantities:l,selectedProducts:m,productDialog:P,paymentOption:g,paymentOptions:w,total:p,showProductDialog:V,addProductToOrder:B,goToPayment:O,productTotal:q,paymentButtonLabel:S,goToDashboard:()=>{oa(a,userStore)}}}},sa={class:"header-content"},ia={class:"greeting"},ua={class:"q-ml-lg"};function da(u,a,x,e,b,_){const c=M("PlayerNavigationMenu");return v(),J(W,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:r(()=>[t(L,{elevated:"",class:"text-white"},{default:r(()=>[o("div",sa,[o("div",ia,[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:a[0]||(a[0]=(...l)=>e.goToDashboard&&e.goToDashboard(...l))})]),a[2]||(a[2]=o("div",{class:"header-icons"},null,-1))])]),_:1}),t(X,null,{default:r(()=>[t(K,{class:"q-pa-md"},{default:r(()=>[t(N,{class:"text-white"},{default:r(()=>[t(D,null,{default:r(()=>a[3]||(a[3]=[o("h3",{class:"text-white"},"Entrenamiento:",-1)])),_:1}),t(D,null,{default:r(()=>[o("p",null,[a[4]||(a[4]=o("strong",null,"Club:",-1)),i(" "+n(e.reservationDetails.clubName),1)]),o("p",null,[a[5]||(a[5]=o("strong",null,"Coach:",-1)),i(" "+n(e.reservationDetails.coachName),1)]),o("p",null,[a[6]||(a[6]=o("strong",null,"Fecha:",-1)),i(" "+n(e.reservationDetails.date),1)]),o("p",null,[a[7]||(a[7]=o("strong",null,"Horario:",-1)),i(" "+n(e.reservationDetails.time)+" hrs.",1)]),a[14]||(a[14]=o("p",null,[o("strong",null,"Duraci\xF3n:"),i(" 60 minutos")],-1)),o("p",null,[a[8]||(a[8]=o("strong",null,"Participantes:",-1)),i(" "+n(e.reservationDetails.people),1)]),o("p",null,[a[9]||(a[9]=o("strong",null,"Precio:",-1)),i(" $"+n(e.reservationDetails.price.toFixed(2)),1)]),o("p",null,[a[10]||(a[10]=o("strong",null,"Subtotal:",-1)),i(" $"+n(e.subtotal.toFixed(2)),1)]),o("p",null,[a[11]||(a[11]=o("strong",null,"Adicionales:",-1)),i(" $"+n(e.productTotal),1)]),o("ul",ua,[(v(!0),f(T,null,k(e.selectedProducts,l=>(v(),f("li",{key:l.product.id},n(l.product.name)+" x "+n(l.quantity)+" - $"+n((l.product.price*l.quantity).toFixed(2)),1))),128))]),o("p",null,[a[13]||(a[13]=o("strong",null,"Total a pagar:",-1)),i(" $"+n(e.total.toFixed(2))+" ",1),t(R,{name:"o_info",size:"xs",class:"cursor-help"},{default:r(()=>[t(G,{anchor:"top middle",self:"bottom middle",offset:[0,10]},{default:r(()=>a[12]||(a[12]=[i(" Precio total con impuestos y comisiones incluidas ")])),_:1})]),_:1})])]),_:1}),t(F,{align:"right"},{default:r(()=>[t(y,{label:"Agregar Productos",color:"primary",onClick:e.showProductDialog},null,8,["onClick"]),t(y,{label:e.paymentButtonLabel,color:"green",onClick:e.goToPayment},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),t(j,{modelValue:e.productDialog,"onUpdate:modelValue":a[1]||(a[1]=l=>e.productDialog=l)},{default:r(()=>[t(N,null,{default:r(()=>[t(D,null,{default:r(()=>[(v(!0),f(T,null,k(e.products,l=>(v(),f("div",{key:l.id,class:"q-mb-md"},[t(Z,null,{default:r(()=>[t(I,null,{default:r(()=>[t(Y,null,{default:r(()=>[i(n(l.name)+" - $"+n(l.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(I,{side:""},{default:r(()=>[t(z,{modelValue:e.productQuantities[l.id],"onUpdate:modelValue":m=>e.productQuantities[l.id]=m,type:"number",min:"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),t(F,{align:"right"},{default:r(()=>[t(y,{label:"Aceptar",color:"primary",onClick:e.addProductToOrder},null,8,["onClick"]),U(t(y,{label:"Cancelar",color:"grey-dark"},null,512),[[$]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(c)]),_:1})}var Sa=ra(na,[["render",da],["__scopeId","data-v-6ccf1d60"]]);export{Sa as default};
