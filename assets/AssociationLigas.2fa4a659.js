import{Q as F}from"./QHeader.289f0645.js";import{x as H,r as n,h as j,a6 as Q,o as m,z as v,A as t,d as e,B as s,D as r,a7 as D,a8 as _,Q as G,ac as J,a as K,aa as O,ab as W,t as b,E as N,aI as X,ad as A,ae as T,af as I,a9 as h}from"./index.687b44e8.js";import{Q as V}from"./QItemLabel.bbebea39.js";import{Q as Y,a as E}from"./QItem.eb9291fb.js";import{Q as Z}from"./QList.1288e946.js";import{Q as $}from"./QPage.fcc9aae1.js";import{Q as ee,a as ae}from"./QLayout.30990248.js";import{C as M}from"./ClosePopup.89fae5e1.js";import{u as oe}from"./use-quasar.ba375293.js";import{A as le,a as te}from"./AssociationTopMenu.c2c9d0dc.js";import{N as ie}from"./NotificationBell.9fdba392.js";import{B as ne}from"./BannerPromoScrolling.1700e538.js";import{a as se,u as re,c as de,d as ce}from"./association.b92d73c6.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./QTabs.979bee57.js";import"./rtl.276c3f1b.js";import"./QFooter.b7b22f15.js";import"./QBtnDropdown.17175f2e.js";import"./QBtnGroup.6b9d07ee.js";import"./QMenu.df8dfc7c.js";import"./position-engine.46674690.js";import"./selection.0f785986.js";import"./haptics.57409bd0.js";import"./QBadge.0c3a126f.js";import"./api.1c42dce4.js";const me={name:"AssociationLigas",components:{AssociationNavigationMenu:le,AssociationTopMenu:te,NotificationBell:ie,BannerPromoScrolling:ne},setup(){const u=oe(),l=H(),y=n([]),a=n(!0),C=n(!1),k=n(!1),g=n(!1),f=n(!1),d=n(null),c=n(null),o=n({name:"",description:"",is_public:!0}),w=()=>l.push("/dashboard/association"),S=i=>l.push(`/leagues/${i}/ranking`),L=async()=>{a.value=!0;try{const i=await se();y.value=i.data||[]}catch(i){console.error("Error loading leagues:",i),y.value=[]}finally{a.value=!1}},B=()=>{o.value={name:"",description:"",is_public:!0},d.value=null},q=async()=>{var i,p,x;if(!!((i=o.value.name)!=null&&i.trim())){g.value=!0;try{d.value?(await re(d.value,o.value),u.notify({type:"positive",message:"Liga actualizada"})):(await de(o.value),u.notify({type:"positive",message:"Liga creada"})),C.value=!1,B(),L()}catch(z){u.notify({type:"negative",message:((x=(p=z.response)==null?void 0:p.data)==null?void 0:x.detail)||"Error al guardar"})}finally{g.value=!1}}},P=i=>{d.value=i.id,o.value={name:i.name,description:i.description||"",is_public:i.is_public!==!1},C.value=!0},R=i=>{c.value=i,k.value=!0},U=async()=>{var i,p;if(!!c.value){f.value=!0;try{await ce(c.value.id),u.notify({type:"positive",message:"Liga eliminada"}),k.value=!1,c.value=null,L()}catch(x){u.notify({type:"negative",message:((p=(i=x.response)==null?void 0:i.data)==null?void 0:p.detail)||"Error al eliminar"})}finally{f.value=!1}}};return j(L),{leagues:y,loading:a,showCreateDialog:C,showDeleteConfirm:k,saving:g,deleting:f,editingId:d,leagueToDelete:c,form:o,goToDashboard:w,goToRanking:S,resetForm:B,submitLeague:q,editLeague:P,confirmDelete:R,doDelete:U}}},ge={class:"header-content"},fe={class:"greeting"},pe={class:"header-icons"},ve={class:"row justify-between items-center q-mb-md"},_e={class:"text-h6"};function be(u,l,y,a,C,k){const g=Q("NotificationBell"),f=Q("AssociationTopMenu"),d=Q("BannerPromoScrolling"),c=Q("AssociationNavigationMenu");return m(),v(ee,{view:"hHh lpR fFf",class:"text-white"},{default:t(()=>[e(F,{elevated:"",class:"text-white"},{default:t(()=>[s("div",ge,[s("div",fe,[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:l[0]||(l[0]=(...o)=>a.goToDashboard&&a.goToDashboard(...o))}),l[8]||(l[8]=s("span",{class:"text-subtitle1"},"Ligas",-1))]),s("div",pe,[e(g),e(f)])]),e(d)]),_:1}),e(ae,null,{default:t(()=>[e($,{class:"q-pa-md"},{default:t(()=>[s("div",ve,[l[9]||(l[9]=s("div",{class:"text-h5"},"Mis ligas",-1)),e(r,{color:"primary",icon:"add",label:"Crear liga","text-color":"black",onClick:l[1]||(l[1]=o=>a.showCreateDialog=!0)})]),a.loading?(m(),v(D,{key:0,flat:"",bordered:"",class:"bg-transparent text-white"},{default:t(()=>[e(_,{class:"text-center"},{default:t(()=>[e(G,{color:"primary",size:"40px"})]),_:1})]),_:1})):a.leagues.length?(m(),v(Z,{key:2,bordered:"",class:"rounded-borders bg-transparent"},{default:t(()=>[(m(!0),K(W,null,O(a.leagues,o=>(m(),v(Y,{key:o.id,class:"q-mb-sm bg-grey-9"},{default:t(()=>[e(E,null,{default:t(()=>[e(V,{class:"text-weight-medium"},{default:t(()=>[h(b(o.name),1)]),_:2},1024),e(V,{caption:""},{default:t(()=>[h(b(o.description||"Sin descripci\xF3n"),1)]),_:2},1024),e(V,{caption:""},{default:t(()=>[h(" Ranking "+b(o.is_public?"p\xFAblico":"privado"),1)]),_:2},1024)]),_:2},1024),e(E,{side:""},{default:t(()=>[e(r,{flat:"",dense:"",icon:"o_leaderboard",onClick:w=>a.goToRanking(o.id)},null,8,["onClick"]),e(r,{flat:"",dense:"",icon:"edit",onClick:w=>a.editLeague(o)},null,8,["onClick"]),e(r,{flat:"",dense:"",icon:"delete",color:"negative",onClick:w=>a.confirmDelete(o)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(m(),v(D,{key:1,flat:"",bordered:"",class:"bg-grey-9 text-white"},{default:t(()=>[e(_,{class:"text-center"},{default:t(()=>[e(J,{name:"o_workspace_premium",size:"48px",class:"q-mb-sm"}),l[10]||(l[10]=s("p",null,"No tienes ligas. Crea una para asociar torneos y generar ranking.",-1)),e(r,{color:"primary",label:"Crear liga","text-color":"black",onClick:l[2]||(l[2]=o=>a.showCreateDialog=!0)})]),_:1})]),_:1}))]),_:1})]),_:1}),e(c),e(I,{modelValue:a.showCreateDialog,"onUpdate:modelValue":l[6]||(l[6]=o=>a.showCreateDialog=o),persistent:""},{default:t(()=>[e(D,{class:"bg-grey-9 text-white",style:{"min-width":"320px"}},{default:t(()=>[e(_,null,{default:t(()=>[s("div",_e,b(a.editingId?"Editar liga":"Nueva liga"),1)]),_:1}),e(_,{class:"q-gutter-md"},{default:t(()=>[e(N,{modelValue:a.form.name,"onUpdate:modelValue":l[3]||(l[3]=o=>a.form.name=o),label:"Nombre",outlined:"",dark:"",dense:""},null,8,["modelValue"]),e(N,{modelValue:a.form.description,"onUpdate:modelValue":l[4]||(l[4]=o=>a.form.description=o),label:"Descripci\xF3n",outlined:"",dark:"",dense:"",type:"textarea",rows:"2"},null,8,["modelValue"]),e(X,{modelValue:a.form.is_public,"onUpdate:modelValue":l[5]||(l[5]=o=>a.form.is_public=o),label:"Ranking p\xFAblico"},null,8,["modelValue"])]),_:1}),e(A,{align:"right"},{default:t(()=>[T(e(r,{flat:"",label:"Cancelar",onClick:a.resetForm},null,8,["onClick"]),[[M]]),e(r,{color:"primary",label:a.editingId?"Guardar":"Crear","text-color":"black",onClick:a.submitLeague,loading:a.saving},null,8,["label","onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:a.showDeleteConfirm,"onUpdate:modelValue":l[7]||(l[7]=o=>a.showDeleteConfirm=o),persistent:""},{default:t(()=>[e(D,{class:"bg-grey-9 text-white"},{default:t(()=>[e(_,null,{default:t(()=>{var o;return[h('\xBFEliminar la liga "'+b((o=a.leagueToDelete)==null?void 0:o.name)+'"?',1)]}),_:1}),e(A,{align:"right"},{default:t(()=>[T(e(r,{flat:"",label:"Cancelar"},null,512),[[M]]),e(r,{flat:"",color:"negative",label:"Eliminar",onClick:a.doDelete,loading:a.deleting},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var je=ue(me,[["render",be],["__scopeId","data-v-f5e2706c"]]);export{je as default};
