import{Q as u}from"./QToolbarTitle.e6fda56e.js";import{Q as c}from"./QToolbar.4e3ff194.js";import{Q as p}from"./QHeader.fafcae42.js";import{Q as f}from"./QSelect.a3d4647e.js";import{Q as _}from"./QTable.4d3cbfb0.js";import{k as h,G as g,H as t,p as r,ad as b,I as i,q as d,J as m}from"./index.63dc7e23.js";import{Q as U}from"./QPage.2aaa1d93.js";import{Q as v,a as y}from"./QLayout.554612a4.js";import{s as Q}from"./supabase.87115abf.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.5e2441ba.js";import"./QItem.0839bf79.js";import"./QItemLabel.8574eb87.js";import"./QMenu.c6f4e2d1.js";import"./position-engine.fc47911a.js";import"./selection.f8391a45.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.e359b89a.js";import"./QMarkupTable.307971d8.js";import"./use-fullscreen.c01b49ff.js";const w={name:"ManageUsers",data(){return{users:[],filteredUsers:[],selectedFilter:"all",filters:[{label:"Todos",value:"all"},{label:"Clubes",value:"club"},{label:"Asociaciones",value:"association"}],columns:[{name:"email",label:"Correo",align:"left",field:"email"},{name:"name",label:"Nombre",align:"left",field:"name"}]}},computed:{totalClubs(){return this.users.filter(e=>e.user_type==="club").length},totalAssociations(){return this.users.filter(e=>e.user_type==="association").length}},methods:{async fetchUsers(){try{const{data:e,error:s}=await Q.rpc("get_users_with_profiles");if(s){console.error("Error al obtener usuarios:",s.message);return}this.users=e.map(l=>({id:l.id,email:l.email,name:l.full_name,user_type:l.user_type})),console.log("Usuarios cargados:",this.users),this.filterUsers()}catch(e){console.error("Error inesperado:",e.message)}},filterUsers(){console.log("Filtro seleccionado:",this.selectedFilter),console.log("Usuarios antes de filtrar:",this.users),this.selectedFilter.value==="all"?this.filteredUsers=[...this.users]:this.filteredUsers=this.users.filter(e=>(console.log("Comparando:",e.user_type,"con",this.selectedFilter.value),e.user_type===this.selectedFilter.value)),console.log("Usuarios filtrados:",this.filteredUsers)},addUser(e){this.$router.push(`/admin/add-user?type=${e}`)}},watch:{selectedFilter:"filterUsers"},mounted(){this.fetchUsers()}},x={class:"q-mb-md"},F={class:"q-mt-md text-white"},k={class:"q-mb-md text-right"};function A(e,s,l,T,o,a){return h(),g(v,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[r(p,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[r(c,null,{default:t(()=>[r(u,null,{default:t(()=>s[3]||(s[3]=[b("Administrar Usuarios")])),_:1})]),_:1})]),_:1}),r(y,null,{default:t(()=>[r(U,{class:"q-pa-md"},{default:t(()=>[i("div",x,[r(f,{modelValue:o.selectedFilter,"onUpdate:modelValue":s[0]||(s[0]=n=>o.selectedFilter=n),options:o.filters,label:"Filtrar por tipo de usuario",outlined:"",dense:"",color:"primary",onChange:a.filterUsers},null,8,["modelValue","options","onChange"])]),r(_,{flat:"",rows:o.filteredUsers,columns:o.columns,"row-key":"id",dense:"",class:"text-white bg-dark","hide-bottom":""},null,8,["rows","columns"]),i("div",F,[i("p",null,"Total Clubes: "+d(a.totalClubs),1),i("p",null,"Total Asociaciones: "+d(a.totalAssociations),1)]),i("div",k,[r(m,{label:"Agregar Club",color:"primary",icon:"add",class:"q-mr-md",onClick:s[1]||(s[1]=n=>a.addUser("club"))}),r(m,{label:"Agregar Asociaci\xF3n",color:"primary",icon:"add",onClick:s[2]||(s[2]=n=>a.addUser("association"))})])]),_:1})]),_:1})]),_:1})}var Y=C(w,[["render",A],["__scopeId","data-v-388c2e0e"]]);export{Y as default};
