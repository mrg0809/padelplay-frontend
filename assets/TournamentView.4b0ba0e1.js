import{a7 as j,F as R,r as _,j as L,B as G,a8 as k,q as d,G as Q,H as l,v as a,I as t,J as H,s as c,a9 as P,aa as T,x as r,ab as m,aM as J,ad as I,ac as B,ae as p,y,aQ as U}from"./index.e023fc86.js";import{Q as O}from"./QHeader.56feab89.js";import{Q as A}from"./QSpinnerDots.2633cb28.js";import{Q as K,a as M}from"./QTabs.5da5ba79.js";import{Q as v}from"./QBadge.8ff69d7d.js";import{a as W,Q as C}from"./QTabPanel.b8b736db.js";import{Q as X}from"./QMarkupTable.82668ccd.js";import{Q as Y}from"./QPage.9f755cb5.js";import{Q as Z,a as $}from"./QLayout.5de9f2c5.js";import{u as tt}from"./use-quasar.116c74f8.js";import{u as et}from"./userStore.3700a688.js";import{s as D}from"./supabase.a7ca61c0.js";import{a as V}from"./api.2af71db3.js";import{P as at}from"./PlayerNavigationMenu.2e382568.js";import{N as st}from"./NotificationBell.5c9292ad.js";import{B as ot}from"./BannerPromoScrolling.bfd76df5.js";import{D as nt}from"./DesktopNavigation.624c1c61.js";import{g as rt}from"./tournamentUtils.cfdf57cc.js";import{_ as lt}from"./plugin-vue_export-helper.21dcd24c.js";import"./rtl.276c3f1b.js";import"./use-panel.009d0490.js";import"./use-render-cache.770e5fe8.js";import"./selection.709b2df1.js";import"./pinia.eb62d3f8.js";import"./QFooter.1e0bb873.js";import"./admin.c99b9bfe.js";import"./QTooltip.05a23e3d.js";import"./position-engine.28b0865b.js";const it={name:"TournamentView",components:{PlayerNavigationMenu:at,NotificationBell:st,BannerPromoScrolling:ot,DesktopNavigation:nt},setup(){const g=j(),e=R(),h=tt(),s=et(),S=_(null),x=_([]),b=_([]),q=_(null),f=_(!1),N=_("my-matches"),o=L(()=>s.userId?x.value.filter(n=>n.team1_players.includes(s.userId)||n.team2_players.includes(s.userId)):[]);G(async()=>{await w(),await z(),await E(),await F()});const w=async()=>{f.value=!0;try{const n=g.params.tournamentId,{data:i,error:u}=await D.from("tournaments").select("*").eq("id",n).single();if(u)throw u;S.value=i}catch(n){console.error("Error loading tournament:",n),h.notify({type:"negative",message:"Error al cargar el torneo"})}finally{f.value=!1}},z=async()=>{try{const n=g.params.tournamentId,{data:i,error:u}=await D.from("tournament_teams").select("id").eq("tournament_id",n).or(`player1_id.eq.${s.userId},player2_id.eq.${s.userId}`).single();!u&&i&&(q.value=i.id)}catch(n){console.error("Error loading my team:",n)}},E=async()=>{try{const n=g.params.tournamentId,i=await V.get(`/tournaments/${n}/matches`);x.value=i.data.matches}catch(n){console.error("Error loading matches:",n),h.notify({type:"negative",message:"Error al cargar los partidos"})}},F=async()=>{try{const n=g.params.tournamentId,i=await V.get(`/tournaments/${n}/standings`);b.value=i.data.standings}catch(n){console.error("Error loading standings:",n),h.notify({type:"negative",message:"Error al cargar las posiciones"})}};return{tournament:S,matches:x,myMatches:o,standings:b,loading:f,activeTab:N,getSystemName:n=>rt(n),formatDate:n=>{const i=new Date(n),u={year:"numeric",month:"long",day:"numeric"};return i.toLocaleDateString("es-ES",u)},formatScore:n=>{if(!n)return"Sin resultado";try{const i=typeof n=="string"?JSON.parse(n):n;let u=[];return i.set1&&u.push(`${i.set1.team1}-${i.set1.team2}`),i.set2&&u.push(`${i.set2.team1}-${i.set2.team2}`),i.set3&&u.push(`${i.set3.team1}-${i.set3.team2}`),u.join(", ")}catch{return"Error en formato"}},isMyTeam:n=>n===q.value,goBack:()=>{e.back()}}}},mt={class:"header-content"},dt={class:"header-icons"},ct={key:0,class:"text-center q-mt-md"},ut={key:1},pt={class:"q-mt-none"},_t={class:"row q-gutter-md"},gt={class:"col"},ft={class:"col"},yt={class:"matches-list"},vt={class:"match-header"},ht={class:"q-my-none"},xt={class:"text-caption q-mb-none"},bt={class:"text-caption q-mb-none"},qt={key:0,class:"q-mt-md result-section"},kt={key:1,class:"q-mt-md"},Qt={key:0,class:"text-center q-pa-xl"},Pt={class:"matches-list"},Tt={class:"match-header"},St={class:"q-my-none"},Nt={class:"text-caption q-mb-none"},wt={class:"text-caption q-mb-none"},It={key:0,class:"q-mt-md result-section"},Bt={key:1,class:"q-mt-md"},Mt={key:0,class:"text-center q-pa-xl"},Ct={class:"text-left"},Dt={class:"text-left"},Vt={class:"text-center"},zt={class:"text-center"},Et={class:"text-center"},Ft={class:"text-center"},jt={key:0,class:"text-center q-pa-xl"};function Rt(g,e,h,s,S,x){const b=k("NotificationBell"),q=k("BannerPromoScrolling"),f=k("DesktopNavigation"),N=k("PlayerNavigationMenu");return d(),Q(Z,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:l(()=>[a(O,{elevated:"",class:"text-white"},{default:l(()=>[t("div",mt,[e[2]||(e[2]=t("div",{class:"greeting"},[t("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})],-1)),t("div",dt,[a(b),a(H,{flat:"",round:"",icon:"arrow_back",onClick:s.goBack},null,8,["onClick"])])]),a(q)]),_:1}),a(f),a($,null,{default:l(()=>[a(Y,{class:"q-pa-md"},{default:l(()=>[s.loading?(d(),c("div",ct,[a(A,{color:"primary",size:"xl"}),e[3]||(e[3]=t("p",null,"Cargando informaci\xF3n del torneo...",-1))])):s.tournament?(d(),c("div",ut,[a(P,{class:"q-mb-md transparent-card"},{default:l(()=>[a(T,null,{default:l(()=>[t("h4",pt,r(s.tournament.name),1),t("div",_t,[t("div",gt,[t("p",null,[e[4]||(e[4]=t("strong",null,"Sistema:",-1)),m(" "+r(s.getSystemName(s.tournament.system)),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"Categor\xEDa:",-1)),m(" "+r(s.tournament.category),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"G\xE9nero:",-1)),m(" "+r(s.tournament.gender),1)])]),t("div",ft,[t("p",null,[e[7]||(e[7]=t("strong",null,"Fecha Inicio:",-1)),m(" "+r(s.tournament.start_date),1)]),t("p",null,[e[8]||(e[8]=t("strong",null,"Fecha Fin:",-1)),m(" "+r(s.tournament.end_date),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"Premio:",-1)),m(" "+r(s.tournament.prize),1)])])])]),_:1})]),_:1}),a(K,{modelValue:s.activeTab,"onUpdate:modelValue":e[0]||(e[0]=o=>s.activeTab=o),dense:"",class:"text-white","active-color":"primary","indicator-color":"primary",align:"justify"},{default:l(()=>[a(M,{name:"my-matches",label:"Mis Partidos",icon:"calendar_today"}),a(M,{name:"all-matches",label:"Todos los Partidos",icon:"sports_tennis"}),a(M,{name:"standings",label:"Posiciones",icon:"emoji_events"})]),_:1},8,["modelValue"]),a(J),a(W,{modelValue:s.activeTab,"onUpdate:modelValue":e[1]||(e[1]=o=>s.activeTab=o),animated:"",class:"transparent-bg"},{default:l(()=>[a(C,{name:"my-matches"},{default:l(()=>[t("div",yt,[(d(!0),c(I,null,B(s.myMatches,o=>(d(),Q(P,{key:o.id,class:"q-mb-md transparent-card"},{default:l(()=>[a(T,null,{default:l(()=>[t("div",vt,[t("h6",ht,r(o.team1)+" vs "+r(o.team2),1),t("p",xt,[a(p,{name:"event",size:"xs"}),m(" "+r(s.formatDate(o.match_date))+" - "+r(o.match_time.substring(0,5)),1)]),t("p",bt,[a(p,{name:"place",size:"xs"}),m(" Cancha: "+r(o.court_name),1)])]),o.has_result?(d(),c("div",qt,[a(v,{color:"green",class:"q-mb-sm"},{default:l(()=>e[10]||(e[10]=[m("Finalizado")])),_:1}),t("p",null,[e[11]||(e[11]=t("strong",null,"Resultado:",-1)),m(" "+r(s.formatScore(o.score)),1)])])):(d(),c("div",kt,[a(v,{color:"orange"},{default:l(()=>e[12]||(e[12]=[m("Pendiente")])),_:1})]))]),_:2},1024)]),_:2},1024))),128)),s.myMatches.length===0?(d(),c("div",Qt,[a(p,{name:"info",size:"3em",color:"grey"}),e[13]||(e[13]=t("p",null,"No tienes partidos programados",-1))])):y("",!0)])]),_:1}),a(C,{name:"all-matches"},{default:l(()=>[t("div",Pt,[(d(!0),c(I,null,B(s.matches,o=>(d(),Q(P,{key:o.id,class:"q-mb-md transparent-card"},{default:l(()=>[a(T,null,{default:l(()=>[t("div",Tt,[t("h6",St,r(o.team1)+" vs "+r(o.team2),1),t("p",Nt,[a(p,{name:"event",size:"xs"}),m(" "+r(s.formatDate(o.match_date))+" - "+r(o.match_time.substring(0,5)),1)]),t("p",wt,[a(p,{name:"place",size:"xs"}),m(" Cancha: "+r(o.court_name),1)])]),o.has_result?(d(),c("div",It,[a(v,{color:"green",class:"q-mb-sm"},{default:l(()=>e[14]||(e[14]=[m("Finalizado")])),_:1}),t("p",null,[e[15]||(e[15]=t("strong",null,"Resultado:",-1)),m(" "+r(s.formatScore(o.score)),1)])])):(d(),c("div",Bt,[a(v,{color:"orange"},{default:l(()=>e[16]||(e[16]=[m("Pendiente")])),_:1})]))]),_:2},1024)]),_:2},1024))),128)),s.matches.length===0?(d(),c("div",Mt,[a(p,{name:"info",size:"3em",color:"grey"}),e[17]||(e[17]=t("p",null,"No hay partidos programados",-1))])):y("",!0)])]),_:1}),a(C,{name:"standings"},{default:l(()=>[a(P,{class:"transparent-card"},{default:l(()=>[a(T,null,{default:l(()=>[e[21]||(e[21]=t("h6",{class:"q-mt-none"},"Tabla de Posiciones",-1)),a(X,{flat:"",bordered:"",class:"standings-table"},{default:l(()=>[e[19]||(e[19]=t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"Pos"),t("th",{class:"text-left"},"Equipo"),t("th",{class:"text-center"},"PJ"),t("th",{class:"text-center"},"PG"),t("th",{class:"text-center"},"PP"),t("th",{class:"text-center"},"Pts")])],-1)),t("tbody",null,[(d(!0),c(I,null,B(s.standings,(o,w)=>(d(),c("tr",{key:o.team_id,class:U({"my-team":s.isMyTeam(o.team_id)})},[t("td",Ct,r(w+1),1),t("td",Dt,[m(r(o.team_name)+" ",1),s.isMyTeam(o.team_id)?(d(),Q(v,{key:0,color:"primary",class:"q-ml-sm"},{default:l(()=>e[18]||(e[18]=[m(" Mi equipo ")])),_:1})):y("",!0)]),t("td",Vt,r(o.matches_played),1),t("td",zt,r(o.wins),1),t("td",Et,r(o.losses),1),t("td",Ft,[t("strong",null,r(o.points),1)])],2))),128))])]),_:1}),s.standings.length===0?(d(),c("div",jt,[a(p,{name:"info",size:"3em",color:"grey"}),e[20]||(e[20]=t("p",null,"No hay resultados registrados a\xFAn",-1))])):y("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):y("",!0)]),_:1})]),_:1}),a(N)]),_:1})}var xe=lt(it,[["render",Rt],["__scopeId","data-v-2bc57fea"]]);export{xe as default};
