import{s as d}from"./supabase.d0690741.js";const u=async e=>{if(!e)return console.error("getTournamentsByClub llamado sin clubId."),[];const n=new Date().toISOString().split("T")[0];console.log(`Buscando torneos futuros para club ${e} desde fecha: ${n}`);try{const{data:r,error:c}=await d.from("tournaments").select("id, name, start_date, category, gender").eq("club_id",e).gte("start_date",n).order("start_date",{ascending:!0});return c?(console.error(`Error fetching future tournaments for club ${e}:`,c),[]):(console.log(`Encontrados ${(r==null?void 0:r.length)||0} torneos futuros para club ${e}.`),r||[])}catch(r){return console.error(`Excepci\xF3n en getTournamentsByClub para club ${e}:`,r),[]}},g=async e=>{console.log("Buscando torneos con filtros:",e);try{const n=new Date().toISOString().split("T")[0],r=new Date;r.setMonth(r.getMonth()-1);const c=r.toISOString().split("T")[0];let t=d.from("tournaments").select(`
              id,
              name,
              start_date,
              category,
              gender,
              price_per_pair,
              prize,
              details,
              club_id,
              clubs ( city, name )
          `).gte("start_date",c).or("is_padelite.is.null,is_padelite.eq.false");(e==null?void 0:e.city)&&e.city!==""&&(console.log(`Aplicando filtro ciudad: ${e.city}`),t=t.eq("clubs.city",e.city)),(e==null?void 0:e.category)&&e.category!==""&&(console.log(`Aplicando filtro categor\xEDa: ${e.category}`),t=t.eq("category",e.category)),(e==null?void 0:e.gender)&&e.gender!==""&&(console.log(`Aplicando filtro g\xE9nero: ${e.gender}`),t=t.eq("gender",e.gender)),t=t.order("start_date",{ascending:!0});const{data:s,error:i}=await t;return i?(console.error("Error de Supabase al buscar torneos:",i),(i.message.includes("relation")||i.message.includes("schema"))&&console.warn("Posible problema con el filtro de relaci\xF3n (ciudad)."),[]):(console.log(`Se encontraron ${(s==null?void 0:s.length)||0} torneos.`),s||[])}catch(o){return console.error("Excepci\xF3n en fetchTournaments:",o),[]}},y=async e=>{const{data:o,error:n}=await d.from("tournaments").select("id, name, start_date, end_date, start_time, end_time, category, gender, system, price_per_pair, prize, details, status, clubs(name, city)").eq("id",e);if(n)throw Error(n.message);return o||[]},p=async e=>{const{data:o,error:n}=await d.from("tournament_teams").select("player1_id, player2_id").eq("tournament_id",e);if(n)throw new Error(n.message);if(!o||o.length===0)return[];const r=Array.from(new Set(o.flatMap(a=>[a.player1_id,a.player2_id]).filter(a=>a!==null))),{data:c,error:t}=await d.from("players").select("id, user_id, photo_url").in("user_id",r);if(t)throw new Error(t.message);const s=new Map(c.map(a=>[a.user_id,a]));return o.map(a=>({player1:s.get(a.player1_id),player2:s.get(a.player2_id)}))};export{y as a,p as b,g as f,u as g};
