import{Q as L}from"./QHeader.fafcae42.js";import{a9 as R,F as H,r as u,j as C,y as U,aa as N,k as y,G as E,H as r,p as e,I as l,ab as T,ac as f,ad as s,q as n,l as b,ae as V,af as F,ag as J,aM as j,aN as G,ah as O,J as P,ai as z,aj as K,K as W}from"./index.63dc7e23.js";import{Q as X}from"./QTooltip.3d9e405e.js";import{Q as Y}from"./QPage.2aaa1d93.js";import{Q as Z,a as $}from"./QLayout.554612a4.js";import{Q as aa}from"./QItemLabel.8574eb87.js";import{Q as oa,a as I}from"./QItem.0839bf79.js";import{C as ea}from"./ClosePopup.dd006cf1.js";import{u as ta}from"./use-quasar.a32cc7fc.js";import{g as la}from"./products.46621418.js";import{n as ra}from"./navigationUtils.2c4b9dee.js";import{a as na}from"./api.e96a150b.js";import{P as ia}from"./PlayerNavigationMenu.f00bb1db.js";import{D as sa}from"./DesktopNavigation.6e047a14.js";import{_ as ua}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.fc47911a.js";import"./selection.f8391a45.js";import"./supabase.87115abf.js";import"./index.c98ef0da.js";import"./QTabs.6a3d63d5.js";import"./rtl.276c3f1b.js";import"./QFooter.9d6e02eb.js";const da={components:{PlayerNavigationMenu:ia,DesktopNavigation:sa},setup(){const d=R(),a=H(),k=ta(),o=u({clubId:d.query.clubId||"",clubName:d.query.clubName||"Club no especificado",courtId:d.query.courtId||"",courtName:d.query.courtName||"Cancha no especificada",date:d.query.date||"Fecha no especificada",time:d.query.time||"Hora no especificada",duration:d.query.duration||0,price:parseFloat(d.query.price)||0}),_=u(4),Q=u(o.value.price+_.value*o.value.price/100),p=u(),c=u({}),t=u([]),g=u(!1),x=u(!1),v=u("partial"),w=u([{label:"Pagar mi parte",value:"partial"},{label:"Pagar el total",value:"total"}]),S=C(()=>`Continuar al pago de $${v.value==="total"?m.value.toFixed(2):(m.value/4).toFixed(2)}`),q=C(()=>t.value&&Array.isArray(t.value)?t.value.reduce((i,D)=>i+D.product.price*D.quantity,0):0),m=C(()=>Q.value+q.value),h=()=>{g.value=!0},M=()=>{t.value=p.value.filter(i=>c.value[i.id]>0).map(i=>({product:i,quantity:c.value[i.id]})),g.value=!1},B=async()=>{try{const i=v.value==="total"?m.value:m.value/4,A=(await na.post("payments/payment_order_and_split_payment",{total_price:m.value,pay_total:v.value==="total"})).data.payment_order_id;a.push({name:"StripePayment",query:{reservationDetails:JSON.stringify({...o.value,payment_order_id:A}),total:m.value,paymentOption:v.value,selectedProducts:JSON.stringify(t.value),isPublicMatch:x.value,amountToPay:i}})}catch(i){console.error("Error al obtener payment_order:",i),k.notify({type:"negative",message:"Error al generar orden de pago. Por favor intente de nuevo."})}};return U(async()=>{p.value=await la(o.value.clubId),p.value.forEach(i=>c.value[i.id]=0)}),{reservationDetails:o,commission:_,subtotal:Q,products:p,productQuantities:c,selectedProducts:t,productDialog:g,isPublicMatch:x,paymentOption:v,paymentOptions:w,total:m,showProductDialog:h,addProductToOrder:M,goToPayment:B,productTotal:q,paymentButtonLabel:S,goToDashboard:()=>{ra(a,userStore)}}}},ma={class:"header-content"},pa={class:"greeting"},ca={class:"q-ml-lg"};function ga(d,a,k,o,_,Q){const p=N("DesktopNavigation"),c=N("PlayerNavigationMenu");return y(),E(Z,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:r(()=>[e(L,{elevated:"",class:"text-white"},{default:r(()=>[l("div",ma,[l("div",pa,[l("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:a[0]||(a[0]=(...t)=>o.goToDashboard&&o.goToDashboard(...t))})]),a[4]||(a[4]=l("div",{class:"header-icons"},null,-1))])]),_:1}),e(p),e($,null,{default:r(()=>[e(Y,{class:"q-pa-md"},{default:r(()=>[e(T,{class:"text-white"},{default:r(()=>[e(f,null,{default:r(()=>a[5]||(a[5]=[l("h3",{class:"text-white"},"Reserva:",-1)])),_:1}),e(f,null,{default:r(()=>[l("p",null,[a[6]||(a[6]=l("strong",null,"Club:",-1)),s(" "+n(o.reservationDetails.clubName),1)]),l("p",null,[a[7]||(a[7]=l("strong",null,"Cancha:",-1)),s(" "+n(o.reservationDetails.courtName),1)]),l("p",null,[a[8]||(a[8]=l("strong",null,"Fecha:",-1)),s(" "+n(o.reservationDetails.date),1)]),l("p",null,[a[9]||(a[9]=l("strong",null,"Horario:",-1)),s(" "+n(o.reservationDetails.time)+" hrs.",1)]),l("p",null,[a[10]||(a[10]=l("strong",null,"Duraci\xF3n:",-1)),s(" "+n(o.reservationDetails.duration)+" minutos",1)]),l("p",null,[a[11]||(a[11]=l("strong",null,"Precio:",-1)),s(" $"+n(o.reservationDetails.price.toFixed(2)),1)]),l("p",null,[a[12]||(a[12]=l("strong",null,"Subtotal:",-1)),s(" $"+n(o.subtotal.toFixed(2)),1)]),l("p",null,[a[13]||(a[13]=l("strong",null,"Adicionales:",-1)),s(" $"+n(o.productTotal),1)]),l("ul",ca,[(y(!0),b(F,null,V(o.selectedProducts,t=>(y(),b("li",{key:t.product.id},n(t.product.name)+" x "+n(t.quantity)+" - $"+n((t.product.price*t.quantity).toFixed(2)),1))),128))]),l("p",null,[a[15]||(a[15]=l("strong",null,"Total a pagar:",-1)),s(" $"+n(o.total.toFixed(2))+" ",1),e(J,{name:"o_info",size:"xs",class:"cursor-help"},{default:r(()=>[e(X,{anchor:"top middle",self:"bottom middle",offset:[0,10]},{default:r(()=>a[14]||(a[14]=[s(" Precio total con impuestos y comisiones incluidas ")])),_:1})]),_:1})])]),_:1}),e(f,null,{default:r(()=>[e(j,{modelValue:o.isPublicMatch,"onUpdate:modelValue":a[1]||(a[1]=t=>o.isPublicMatch=t),"checked-icon":"check",color:"green",label:"Partido P\xFAblico"},null,8,["modelValue"]),e(G,{modelValue:o.paymentOption,"onUpdate:modelValue":a[2]||(a[2]=t=>o.paymentOption=t),color:"green",options:o.paymentOptions},null,8,["modelValue","options"])]),_:1}),e(O,{align:"right"},{default:r(()=>[e(P,{label:"Agregar Productos",color:"primary",onClick:o.showProductDialog},null,8,["onClick"]),e(P,{label:o.paymentButtonLabel,color:"green",onClick:o.goToPayment},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),e(K,{modelValue:o.productDialog,"onUpdate:modelValue":a[3]||(a[3]=t=>o.productDialog=t)},{default:r(()=>[e(T,null,{default:r(()=>[e(f,null,{default:r(()=>[(y(!0),b(F,null,V(o.products,t=>(y(),b("div",{key:t.id,class:"q-mb-md"},[e(oa,null,{default:r(()=>[e(I,null,{default:r(()=>[e(aa,null,{default:r(()=>[s(n(t.name)+" - $"+n(t.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),e(I,{side:""},{default:r(()=>[e(W,{modelValue:o.productQuantities[t.id],"onUpdate:modelValue":g=>o.productQuantities[t.id]=g,type:"number",min:"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),e(O,{align:"right"},{default:r(()=>[e(P,{label:"Aceptar",color:"primary",onClick:o.addProductToOrder},null,8,["onClick"]),z(e(P,{label:"Cancelar",color:"grey-dark"},null,512),[[ea]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(c)]),_:1})}var Aa=ua(da,[["render",ga],["__scopeId","data-v-a2a2f456"]]);export{Aa as default};
