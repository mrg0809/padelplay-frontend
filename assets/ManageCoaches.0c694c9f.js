import{F as Z,r as i,B as $,a8 as ee,q as n,G as s,H as r,v as a,I as f,ab as Q,J as C,a9 as O,aa as _,s as q,ac as L,ad as N,y as p,K as h,af as ae,ag as oe,ah as le,bC as re,x as D,aK as te}from"./index.f52eeb23.js";import{Q as ne}from"./QHeader.9b837285.js";import{Q as P,a as F}from"./QItem.5db8a12f.js";import{Q as x}from"./QItemLabel.c940b1f9.js";import{Q as R}from"./QList.564ac546.js";import{Q as se}from"./QPage.e3b227e5.js";import{Q as ce,a as ie}from"./QLayout.cb0005f9.js";import{Q as de}from"./QSelect.fcd8d5c3.js";import{C as ue}from"./ClosePopup.07fee054.js";import{s as me}from"./supabase.577864c8.js";import{n as fe}from"./navigationUtils.2c4b9dee.js";import{u as pe}from"./userStore.6aa07868.js";import{C as ge}from"./ClubNavigationMenu.11760d80.js";import{a as j}from"./api.2af71db3.js";import{_ as _e}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.14b42392.js";import"./QMenu.62944bb3.js";import"./position-engine.3d6fe0c3.js";import"./selection.8b3fabd2.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./pinia.70e1c95e.js";import"./QTabs.82b2cce9.js";import"./QFooter.a31873a0.js";const he={name:"ManageCoaches",components:{ClubNavigationMenu:ge},setup(){const v=Z(),o=pe(),w=i([]),e=i([]),k=i([]),y=i(!1),b=i(null),l=i(null),c=i(null),g=i(null),T=i(null),U=i(""),A=i(""),V=i(1),B=["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado","Domingo"],E=i(Array(7).fill(null).map(()=>({is_open:!1,start_time:"09:00",end_time:"13:00"}))),H=t=>{console.log("ir al coach"),v.push({name:"CoachProfile",params:{id:t}})},J=()=>{v.back()},I=async()=>{try{const{data:t,error:u}=await me.from("coaches").select(`
                id, 
                name, 
                coach_focus, 
                players(gender, photo_url, category)
            `).eq("club_id",o.clubId).eq("is_active",!0);if(u)throw u;w.value=t.map(d=>{var m,S,M;return{id:d.id,name:d.name,coach_focus:d.coach_focus,gender:((m=d.players)==null?void 0:m.gender)||"Desconocido",photo_url:((S=d.players)==null?void 0:S.photo_url)||null,category:((M=d.players)==null?void 0:M.category)||"No especificado"}})}catch(t){console.error("Error obteniendo coaches:",t.message)}},K=async()=>{try{const{data:t,error:u}=await j.get("/coaches/search-coaches");if(u)throw u;e.value=t,k.value=t}catch(t){console.error("Error obteniendo coaches disponibles:",t.message)}},W=(t,u)=>{u(()=>{const d=t.toLowerCase();k.value=e.value.filter(m=>m.name.toLowerCase().indexOf(d)>-1)})},z=async()=>{await K(),y.value=!0,V.value=1},G=()=>{V.value++},X=()=>{V.value--},Y=async()=>{if(!b.value){console.error("Debes seleccionar un jugador.");return}try{const t={user_id:b.value.user_id,club_id:o.clubId,name:b.value.name,price_for_one:l.value,price_for_two:c.value,price_for_three:g.value,price_for_four:T.value,coach_resume:U.value,coach_focus:A.value,availability:E.value.filter(m=>m.is_open).map((m,S)=>({day:B[S],start_time:m.start_time,end_time:m.end_time}))},{data:u,error:d}=await j.post("/coaches/add-coach",t);if(d)throw d;console.log("Coach agregado:",u),I(),y.value=!1}catch(t){console.error("Error agregando coach:",t.message)}};return $(I),{goBack:J,coaches:w,isCoachDialogOpen:y,openCoachDialog:z,availableCoaches:e,filteredAvailableCoaches:k,selectedCoach:b,priceForOne:l,priceForTwo:c,priceForThree:g,priceForFour:T,coachResume:U,coachFocus:A,currentStep:V,nextStep:G,previousStep:X,addCoach:Y,filterCoaches:W,daysOfWeek:B,generalSchedule:E,goToCoachProfile:H,goToDashboard:()=>{fe(v,o)}}}},be={class:"header-content"},Ce={class:"greeting"},ve={class:"header-icons"},ke={class:"q-mb-md"},ye=["src"],Ve={class:"text-bold"};function Se(v,o,w,e,k,y){const b=ee("ClubNavigationMenu");return n(),s(ce,{view:"hHh lpR fFf"},{default:r(()=>[a(ne,{elevated:"",class:"bg-primary text-white"},{default:r(()=>[f("div",be,[f("div",Ce,[f("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:o[0]||(o[0]=(...l)=>e.goToDashboard&&e.goToDashboard(...l))}),o[9]||(o[9]=Q(" Instructores "))]),f("div",ve,[a(C,{flat:"",round:"",icon:"arrow_back",onClick:e.goBack},null,8,["onClick"])])])]),_:1}),a(ie,null,{default:r(()=>[a(se,{class:"q-pa-md"},{default:r(()=>[f("div",ke,[a(O,{class:"transparent-card"},{default:r(()=>[a(_,null,{default:r(()=>o[10]||(o[10]=[f("h5",{class:"text-black"},"Coaches:",-1)])),_:1}),e.coaches.length>0?(n(),s(_,{key:0},{default:r(()=>[a(R,{bordered:"",separator:""},{default:r(()=>[(n(!0),q(N,null,L(e.coaches,l=>(n(),s(P,{key:l.id},{default:r(()=>[a(F,{avatar:""},{default:r(()=>[a(re,null,{default:r(()=>[f("img",{src:l.photo_url||"default-avatar.png"},null,8,ye)]),_:2},1024)]),_:2},1024),a(F,{onClick:c=>e.goToCoachProfile(l.id)},{default:r(()=>[a(x,{class:"text-black"},{default:r(()=>[Q(D(l.name),1)]),_:2},1024),l.coach_focus?(n(),s(x,{key:0,class:"text-black"},{default:r(()=>[Q(D(l.coach_focus),1)]),_:2},1024)):p("",!0)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})):(n(),s(_,{key:1},{default:r(()=>[a(x,{class:"text-center text-black"},{default:r(()=>o[11]||(o[11]=[Q(" A\xFAn no tienes coaches disponibles ")])),_:1})]),_:1}))]),_:1})]),a(C,{glossy:"",round:"",size:"lg",color:"black",icon:"add",class:"fixed-bottom-right q-mb-xl",onClick:e.openCoachDialog},null,8,["onClick"])]),_:1})]),_:1}),a(b),a(le,{modelValue:e.isCoachDialogOpen,"onUpdate:modelValue":o[8]||(o[8]=l=>e.isCoachDialogOpen=l),persistent:"","full-width":""},{default:r(()=>[a(O,{class:"bg-black"},{default:r(()=>[a(_,null,{default:r(()=>o[12]||(o[12]=[f("div",{class:"text-h6"},"Agregar Coach",-1)])),_:1}),e.currentStep===1?(n(),s(_,{key:0},{default:r(()=>[a(de,{modelValue:e.selectedCoach,"onUpdate:modelValue":o[1]||(o[1]=l=>e.selectedCoach=l),options:e.filteredAvailableCoaches,"option-label":"name","option-value":"user_id",label:"Buscar jugador",filled:"","use-input":"",onFilter:e.filterCoaches,class:"custom-select"},null,8,["modelValue","options","onFilter"])]),_:1})):p("",!0),e.currentStep===2?(n(),s(_,{key:1},{default:r(()=>[a(h,{modelValue:e.priceForOne,"onUpdate:modelValue":o[2]||(o[2]=l=>e.priceForOne=l),label:"Entrenamiento individual",filled:"",type:"number"},null,8,["modelValue"]),a(h,{modelValue:e.priceForTwo,"onUpdate:modelValue":o[3]||(o[3]=l=>e.priceForTwo=l),label:"Entrenamiento pareja",filled:"",type:"number"},null,8,["modelValue"]),a(h,{modelValue:e.priceForThree,"onUpdate:modelValue":o[4]||(o[4]=l=>e.priceForThree=l),label:"Entrenamiento 3 jugadores",filled:"",type:"number"},null,8,["modelValue"]),a(h,{modelValue:e.priceForFour,"onUpdate:modelValue":o[5]||(o[5]=l=>e.priceForFour=l),label:"Entrenamiento 4 jugadores",filled:"",type:"number"},null,8,["modelValue"])]),_:1})):p("",!0),e.currentStep===3?(n(),s(_,{key:2},{default:r(()=>[a(h,{modelValue:e.coachResume,"onUpdate:modelValue":o[6]||(o[6]=l=>e.coachResume=l),label:"Resumen del Coach",filled:"",type:"textarea"},null,8,["modelValue"]),a(h,{modelValue:e.coachFocus,"onUpdate:modelValue":o[7]||(o[7]=l=>e.coachFocus=l),label:"Enfoque del Coach",filled:"",type:"textarea"},null,8,["modelValue"])]),_:1})):p("",!0),e.currentStep===4?(n(),s(_,{key:3},{default:r(()=>[a(R,{bordered:""},{default:r(()=>[(n(!0),q(N,null,L(e.generalSchedule,(l,c)=>(n(),s(P,{key:c,class:"q-mb-md"},{default:r(()=>[a(F,null,{default:r(()=>[f("div",Ve,D(e.daysOfWeek[c]),1),a(te,{modelValue:e.generalSchedule[c].is_open,"onUpdate:modelValue":g=>e.generalSchedule[c].is_open=g,label:"\xBFDisponible?",dense:"",color:"black"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e.generalSchedule[c].is_open?(n(),s(F,{key:0},{default:r(()=>[a(h,{modelValue:e.generalSchedule[c].start_time,"onUpdate:modelValue":g=>e.generalSchedule[c].start_time=g,label:"Hora de inicio",dense:"",outlined:"",color:"black",class:"text-black",mask:"time",rules:["time"]},null,8,["modelValue","onUpdate:modelValue"]),a(h,{modelValue:e.generalSchedule[c].end_time,"onUpdate:modelValue":g=>e.generalSchedule[c].end_time=g,label:"Hora de fin",dense:"",outlined:"",color:"black",class:"text-black",mask:"time",rules:["time"]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):p("",!0)]),_:2},1024))),128))]),_:1})]),_:1})):p("",!0),a(ae,{align:"right"},{default:r(()=>[oe(a(C,{flat:"",label:"Cancelar",color:"red"},null,512),[[ue]]),e.currentStep>1?(n(),s(C,{key:0,flat:"",label:"Anterior",color:"blue",onClick:e.previousStep},null,8,["onClick"])):p("",!0),e.currentStep<4?(n(),s(C,{key:1,flat:"",label:"Siguiente",color:"green",onClick:e.nextStep},null,8,["onClick"])):p("",!0),e.currentStep===4?(n(),s(C,{key:2,flat:"",label:"Agregar",color:"green",onClick:e.addCoach},null,8,["onClick"])):p("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Xe=_e(he,[["render",Se],["__scopeId","data-v-2955ad21"]]);export{Xe as default};
