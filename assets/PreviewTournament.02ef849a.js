import{a7 as H,F as R,r as x,B as j,q as l,G as V,H as n,v as a,I as e,ab as P,J as Q,s as d,ae as k,x as i,a9 as p,aa as m,ad as v,ac as h,y as w,K as f,aQ as F}from"./index.909f758f.js";import{Q as z}from"./QHeader.215ac4ec.js";import{Q as I}from"./QSpinnerPuff.6d5d539d.js";import{Q as N}from"./QChip.a6d4ea13.js";import{Q as U}from"./QSelect.749492da.js";import{Q as O}from"./QPage.380a0913.js";import{Q as G,a as L}from"./QLayout.5179015f.js";import{s as B}from"./supabase.c4c6be5d.js";import{a as S}from"./api.92f95132.js";import{u as M}from"./use-quasar.952f8108.js";import{_ as A}from"./plugin-vue_export-helper.21dcd24c.js";import"./QItem.e26ee330.js";import"./QItemLabel.5fd55dfd.js";import"./QMenu.efba1022.js";import"./position-engine.a6a4bf26.js";import"./selection.ca1e3e65.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";function J(_){return{"round-robin":"Round Robin","eliminacion directa":"Eliminaci\xF3n Directa",combinado:"Combinado (Grupos + Playoffs)",liga:"Liga (Todos vs Todos)",retas:"Retas (Rotaci\xF3n de Parejas)"}[_]||_}function K(_){if(!_)return"Equipo no encontrado";if(_.player1&&_.player2){const c=`${_.player1.first_name} ${_.player1.last_name}`,D=`${_.player2.first_name} ${_.player2.last_name}`;return`${c} / ${D}`}return _.name?_.name:`Equipo ${_.id}`}const W={name:"PreviewTournament",setup(){const _=H(),c=R(),D=M(),t=x(null),C=x(!1),T=x(!1),r=x(null),s=x([]);j(async()=>{await o(),await u()});const o=async()=>{var b,q;C.value=!0,r.value=null;try{const y=_.params.tournamentId;if(!y)throw new Error("ID del torneo no encontrado");const g=await S.get(`/tournaments/${y}/preview`);t.value=g.data,console.log("Tournament preview loaded:",t.value)}catch(y){console.error("Error loading tournament preview:",y),r.value=((q=(b=y.response)==null?void 0:b.data)==null?void 0:q.detail)||y.message||"Error al cargar el preview del torneo"}finally{C.value=!1}},u=async()=>{var b,q;try{if((b=t.value)!=null&&b.tournament_id){const y=await B.from("tournaments").select("courts_used, club_id").eq("id",t.value.tournament_id).single();if((q=y.data)!=null&&q.courts_used){const g=await B.from("courts").select("id, name").in("id",y.data.courts_used);g.data&&(s.value=g.data.map(E=>({label:E.name,value:E.id})))}}}catch(y){console.error("Error loading courts:",y)}};return{tournamentData:t,loading:C,saving:T,error:r,courtOptions:s,getSystemName:b=>J(b),getTeamName:b=>K(b),saveMatches:async()=>{var b,q,y;T.value=!0;try{if(!((b=t.value)!=null&&b.matches))throw new Error("No hay partidos para guardar");const g=await S.post(`/tournaments/${t.value.tournament_id}/save-matches`,t.value.matches);D.notify({type:"positive",message:`${g.data.matches_saved} partidos guardados exitosamente. Torneo cerrado.`,timeout:3e3}),setTimeout(()=>{c.push("/club/tournaments")},1500)}catch(g){console.error("Error saving matches:",g),D.notify({type:"negative",message:((y=(q=g.response)==null?void 0:q.data)==null?void 0:y.detail)||"Error al guardar los partidos",timeout:3e3})}finally{T.value=!1}},cancelPreview:()=>{c.back()},goBack:()=>{c.back()}}}},X={class:"header-content"},Y={class:"header-icons"},Z={key:0,class:"text-center q-mt-md"},$={key:1,class:"text-center q-mt-md"},ee={class:"text-negative"},ae={key:2},te={class:"row items-center q-gutter-md"},se={class:"col"},oe={class:"q-my-none"},le={class:"q-mb-none text-subtitle2"},ne={class:"col-auto"},de={key:0,class:"tournament-structure"},re={key:0,class:"groups-container"},ce={class:"q-my-none"},ie={class:"teams-list"},ue={key:0,class:"group-matches"},me={class:"match-details"},_e={class:"match-teams"},pe={class:"team-name"},ve={class:"team-name"},he={class:"match-schedule q-mt-sm"},ye={class:"schedule-inputs row q-gutter-sm"},be={key:1,class:"tournament-structure"},fe={class:"bracket-container"},ge={class:"q-my-none"},Ve={class:"round-matches"},qe={class:"match-details"},ke={class:"match-teams"},we={class:"match-schedule q-mt-sm"},Ue={class:"schedule-inputs row q-gutter-sm"},De={key:2,class:"tournament-structure"},xe={key:0,class:"groups-container q-mb-xl"},Ce={class:"q-my-none"},Te={class:"teams-list"},Qe={key:0,class:"group-matches"},Pe={class:"match-details"},Ne={class:"match-teams"},Ee={class:"team-name"},Fe={class:"team-name"},Be={class:"match-schedule q-mt-sm"},Se={class:"schedule-inputs row q-gutter-sm"},He={key:1,class:"playoffs-container"},Re={class:"q-my-none"},je={class:"round-matches"},ze={class:"match-details"},Ie={class:"match-teams"},Oe={class:"team-name tbd-team"},Ge={class:"team-name tbd-team"},Le={class:"match-schedule q-mt-sm"},Me={class:"schedule-inputs row q-gutter-sm"},Ae={key:3,class:"tournament-structure"},Je={class:"q-mb-none"},Ke={class:"liga-matches"},We={class:"match-details"},Xe={class:"match-teams"},Ye={class:"team-name"},Ze={class:"team-name"},$e={class:"match-schedule q-mt-sm"},ea={class:"schedule-inputs row q-gutter-sm"},aa={key:4,class:"tournament-structure"},ta={class:"q-mb-none"},sa={class:"retas-rounds"},oa={class:"q-my-none"},la={class:"retas-matches"},na={class:"match-details"},da={class:"match-teams-retas"},ra={class:"team-players"},ca={class:"players"},ia={class:"team-players"},ua={class:"players"},ma={class:"match-schedule q-mt-sm"},_a={class:"schedule-inputs row q-gutter-sm"},pa={class:"actions-section q-mt-xl"},va={class:"row q-gutter-md justify-center"};function ha(_,c,D,t,C,T){return l(),V(G,{view:"hHh lpR fFf",class:"body text-white"},{default:n(()=>[a(z,{elevated:"",class:"bg-primary text-white"},{default:n(()=>[e("div",X,[c[0]||(c[0]=e("div",{class:"greeting"},[e("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"}),P(" Cuadro Propuesto del Torneo ")],-1)),e("div",Y,[a(Q,{flat:"",round:"",icon:"arrow_back",onClick:t.goBack},null,8,["onClick"])])])]),_:1}),a(L,null,{default:n(()=>[a(O,{class:"q-pa-md"},{default:n(()=>[t.loading?(l(),d("div",Z,[a(I,{color:"primary",size:"3em"}),c[1]||(c[1]=e("p",null,"Generando cuadro del torneo...",-1))])):t.error?(l(),d("div",$,[a(k,{name:"warning",color:"negative",size:"3em"}),e("p",ee,i(t.error),1),a(Q,{label:"Volver",color:"primary",onClick:t.goBack},null,8,["onClick"])])):t.tournamentData?(l(),d("div",ae,[a(p,{class:"q-mb-md tournament-info-card"},{default:n(()=>[a(m,null,{default:n(()=>{var r,s;return[e("div",te,[e("div",se,[e("h4",oe,i(((r=t.tournamentData.tournament)==null?void 0:r.name)||"Torneo"),1),e("p",le," Sistema: "+i(t.getSystemName(t.tournamentData.system))+" | Total de Partidos: "+i(((s=t.tournamentData.matches)==null?void 0:s.length)||0),1)]),e("div",ne,[a(N,{color:t.tournamentData.system==="eliminacion directa"?"red":t.tournamentData.system==="round-robin"?"blue":t.tournamentData.system==="combinado"?"purple":t.tournamentData.system==="retas"?"orange":"green","text-color":"white",label:t.getSystemName(t.tournamentData.system),icon:"emoji_events"},null,8,["color","label"])])])]}),_:1})]),_:1}),t.tournamentData.system==="round-robin"?(l(),d("div",de,[t.tournamentData.structure.groups?(l(),d("div",re,[(l(!0),d(v,null,h(t.tournamentData.structure.groups,r=>(l(),d("div",{key:r.name,class:"group-section q-mb-lg"},[a(p,{class:"group-card"},{default:n(()=>[a(m,{class:"bg-blue-8 text-white"},{default:n(()=>[e("h6",ce,i(r.name),1),e("div",ie,[(l(!0),d(v,null,h(r.teams,s=>(l(),V(N,{key:s.id,color:"white","text-color":"blue-8",size:"sm",class:"q-ma-xs"},{default:n(()=>[P(i(t.getTeamName(s)),1)]),_:2},1024))),128))])]),_:2},1024),a(m,{class:"matches-section"},{default:n(()=>[c[2]||(c[2]=e("h6",{class:"q-mt-none q-mb-md"},"Partidos del Grupo",-1)),t.tournamentData.structure.group_matches[r.name]?(l(),d("div",ue,[(l(!0),d(v,null,h(t.tournamentData.structure.group_matches[r.name],s=>(l(),V(p,{key:s.id,class:"match-card q-mb-sm",flat:"",bordered:""},{default:n(()=>[a(m,{class:"q-pa-sm"},{default:n(()=>[e("div",me,[e("div",_e,[e("span",pe,i(s.team1.name),1),a(k,{name:"sports",class:"vs-icon"}),e("span",ve,i(s.team2.name),1)]),e("div",he,[e("div",ye,[a(f,{modelValue:s.match_date,"onUpdate:modelValue":o=>s.match_date=o,type:"date",dense:"",outlined:"",label:"Fecha",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{modelValue:s.match_time,"onUpdate:modelValue":o=>s.match_time=o,type:"time",dense:"",outlined:"",label:"Hora",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:s.court_id,"onUpdate:modelValue":o=>s.court_id=o,options:t.courtOptions,"option-value":"value","option-label":"label",dense:"",outlined:"",label:"Cancha",class:"col","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue","options"])])])])]),_:2},1024)]),_:2},1024))),128))])):w("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):w("",!0)])):t.tournamentData.system==="eliminacion directa"?(l(),d("div",be,[e("div",fe,[(l(!0),d(v,null,h(t.tournamentData.structure.bracket,(r,s)=>(l(),d("div",{key:s,class:"bracket-round"},[a(p,{class:"round-card q-mb-lg"},{default:n(()=>[a(m,{class:"bg-red-8 text-white"},{default:n(()=>[e("h6",ge,i(s),1)]),_:2},1024),a(m,null,{default:n(()=>[e("div",Ve,[(l(!0),d(v,null,h(r,o=>(l(),V(p,{key:o.id,class:"match-card q-mb-sm",flat:"",bordered:""},{default:n(()=>[a(m,{class:"q-pa-sm"},{default:n(()=>[e("div",qe,[e("div",ke,[e("span",{class:F(["team-name",{"tbd-team":!o.team1.player1}])},i(o.team1.name),3),a(k,{name:"sports",class:"vs-icon"}),e("span",{class:F(["team-name",{"tbd-team":!o.team2.player1}])},i(o.team2.name),3)]),e("div",we,[e("div",Ue,[a(f,{modelValue:o.match_date,"onUpdate:modelValue":u=>o.match_date=u,type:"date",dense:"",outlined:"",label:"Fecha",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{modelValue:o.match_time,"onUpdate:modelValue":u=>o.match_time=u,type:"time",dense:"",outlined:"",label:"Hora",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:o.court_id,"onUpdate:modelValue":u=>o.court_id=u,options:t.courtOptions,"option-value":"value","option-label":"label",dense:"",outlined:"",label:"Cancha",class:"col","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue","options"])])])])]),_:2},1024)]),_:2},1024))),128))])]),_:2},1024)]),_:2},1024)]))),128))])])):t.tournamentData.system==="combinado"?(l(),d("div",De,[a(p,{class:"q-mb-lg"},{default:n(()=>[a(m,{class:"bg-purple-8 text-white"},{default:n(()=>c[3]||(c[3]=[e("h5",{class:"q-my-none"},"Fase de Grupos",-1)])),_:1})]),_:1}),t.tournamentData.structure.groups?(l(),d("div",xe,[(l(!0),d(v,null,h(t.tournamentData.structure.groups,r=>(l(),d("div",{key:r.name,class:"group-section q-mb-lg"},[a(p,{class:"group-card"},{default:n(()=>[a(m,{class:"bg-blue-6 text-white"},{default:n(()=>[e("h6",Ce,i(r.name),1),e("div",Te,[(l(!0),d(v,null,h(r.teams,s=>(l(),V(N,{key:s.id,color:"white","text-color":"blue-8",size:"sm",class:"q-ma-xs"},{default:n(()=>[P(i(t.getTeamName(s)),1)]),_:2},1024))),128))])]),_:2},1024),a(m,{class:"matches-section"},{default:n(()=>[t.tournamentData.structure.group_matches[r.name]?(l(),d("div",Qe,[(l(!0),d(v,null,h(t.tournamentData.structure.group_matches[r.name],s=>(l(),V(p,{key:s.id,class:"match-card q-mb-sm",flat:"",bordered:""},{default:n(()=>[a(m,{class:"q-pa-sm"},{default:n(()=>[e("div",Pe,[e("div",Ne,[e("span",Ee,i(s.team1.name),1),a(k,{name:"sports",class:"vs-icon"}),e("span",Fe,i(s.team2.name),1)]),e("div",Be,[e("div",Se,[a(f,{modelValue:s.match_date,"onUpdate:modelValue":o=>s.match_date=o,type:"date",dense:"",outlined:"",label:"Fecha",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{modelValue:s.match_time,"onUpdate:modelValue":o=>s.match_time=o,type:"time",dense:"",outlined:"",label:"Hora",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:s.court_id,"onUpdate:modelValue":o=>s.court_id=o,options:t.courtOptions,"option-value":"value","option-label":"label",dense:"",outlined:"",label:"Cancha",class:"col","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue","options"])])])])]),_:2},1024)]),_:2},1024))),128))])):w("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):w("",!0),a(p,{class:"q-mb-lg"},{default:n(()=>[a(m,{class:"bg-purple-8 text-white"},{default:n(()=>c[4]||(c[4]=[e("h5",{class:"q-my-none"},"Fase de Playoffs",-1)])),_:1})]),_:1}),t.tournamentData.structure.playoffs?(l(),d("div",He,[(l(!0),d(v,null,h(t.tournamentData.structure.playoffs,(r,s)=>(l(),d("div",{key:s,class:"bracket-round"},[a(p,{class:"round-card q-mb-lg"},{default:n(()=>[a(m,{class:"bg-red-6 text-white"},{default:n(()=>[e("h6",Re,i(s),1)]),_:2},1024),a(m,null,{default:n(()=>[e("div",je,[(l(!0),d(v,null,h(r,o=>(l(),V(p,{key:o.id,class:"match-card q-mb-sm",flat:"",bordered:""},{default:n(()=>[a(m,{class:"q-pa-sm"},{default:n(()=>[e("div",ze,[e("div",Ie,[e("span",Oe,i(o.team1.name),1),a(k,{name:"sports",class:"vs-icon"}),e("span",Ge,i(o.team2.name),1)]),e("div",Le,[e("div",Me,[a(f,{modelValue:o.match_date,"onUpdate:modelValue":u=>o.match_date=u,type:"date",dense:"",outlined:"",label:"Fecha",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{modelValue:o.match_time,"onUpdate:modelValue":u=>o.match_time=u,type:"time",dense:"",outlined:"",label:"Hora",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:o.court_id,"onUpdate:modelValue":u=>o.court_id=u,options:t.courtOptions,"option-value":"value","option-label":"label",dense:"",outlined:"",label:"Cancha",class:"col","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue","options"])])])])]),_:2},1024)]),_:2},1024))),128))])]),_:2},1024)]),_:2},1024)]))),128))])):w("",!0)])):t.tournamentData.system==="liga"?(l(),d("div",Ae,[a(p,{class:"q-mb-lg"},{default:n(()=>[a(m,{class:"bg-green-8 text-white"},{default:n(()=>[c[5]||(c[5]=e("h5",{class:"q-my-none"},"Liga - Todos contra Todos",-1)),e("p",Je,i(t.tournamentData.structure.total_matches)+" partidos programados",1)]),_:1})]),_:1}),e("div",Ke,[(l(!0),d(v,null,h(t.tournamentData.matches,r=>(l(),V(p,{key:r.id,class:"match-card q-mb-sm",flat:"",bordered:""},{default:n(()=>[a(m,{class:"q-pa-sm"},{default:n(()=>[e("div",We,[e("div",Xe,[e("span",Ye,i(r.team1.name),1),a(k,{name:"sports",class:"vs-icon"}),e("span",Ze,i(r.team2.name),1)]),e("div",$e,[e("div",ea,[a(f,{modelValue:r.match_date,"onUpdate:modelValue":s=>r.match_date=s,type:"date",dense:"",outlined:"",label:"Fecha",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{modelValue:r.match_time,"onUpdate:modelValue":s=>r.match_time=s,type:"time",dense:"",outlined:"",label:"Hora",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:r.court_id,"onUpdate:modelValue":s=>r.court_id=s,options:t.courtOptions,"option-value":"value","option-label":"label",dense:"",outlined:"",label:"Cancha",class:"col","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue","options"])])])])]),_:2},1024)]),_:2},1024))),128))])])):t.tournamentData.system==="retas"?(l(),d("div",aa,[a(p,{class:"q-mb-lg"},{default:n(()=>[a(m,{class:"bg-black text-white"},{default:n(()=>[c[6]||(c[6]=e("h5",{class:"q-my-none"},"Retas - Rotaci\xF3n de Parejas",-1)),e("p",ta,i(t.tournamentData.structure.num_rounds)+" rondas con "+i(t.tournamentData.structure.total_players)+" jugadores",1)]),_:1})]),_:1}),e("div",sa,[(l(!0),d(v,null,h(t.tournamentData.structure.rounds,(r,s)=>(l(),d("div",{key:s,class:"round-section q-mb-lg"},[a(p,{flat:"",bordered:"",class:"round-card"},{default:n(()=>[a(m,{class:"bg-black text-white round-header"},{default:n(()=>[e("h6",oa,i(s),1)]),_:2},1024),a(m,{class:"q-pa-none"},{default:n(()=>[e("div",la,[(l(!0),d(v,null,h(r,o=>(l(),V(p,{key:o.id,class:"match-card q-mb-sm q-ma-sm",flat:"",bordered:""},{default:n(()=>[a(m,{class:"q-pa-sm"},{default:n(()=>[e("div",na,[e("div",da,[e("div",ra,[c[7]||(c[7]=e("div",{class:"team-label"},"Pareja 1:",-1)),e("div",ca,[(l(!0),d(v,null,h(o.team1.players,u=>(l(),d("span",{key:u.id,class:"player-name"},i(u.name),1))),128))])]),a(k,{name:"sports",class:"vs-icon"}),e("div",ia,[c[8]||(c[8]=e("div",{class:"team-label"},"Pareja 2:",-1)),e("div",ua,[(l(!0),d(v,null,h(o.team2.players,u=>(l(),d("span",{key:u.id,class:"player-name"},i(u.name),1))),128))])])]),e("div",ma,[e("div",_a,[a(f,{modelValue:o.date,"onUpdate:modelValue":u=>o.date=u,type:"date",dense:"",outlined:"",label:"Fecha",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{modelValue:o.time,"onUpdate:modelValue":u=>o.time=u,type:"time",dense:"",outlined:"",label:"Hora",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:o.court_id,"onUpdate:modelValue":u=>o.court_id=u,options:t.courtOptions,"option-value":"value","option-label":"label",dense:"",outlined:"",label:"Cancha",class:"col","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue","options"])])])])]),_:2},1024)]),_:2},1024))),128))])]),_:2},1024)]),_:2},1024)]))),128))])])):w("",!0),e("div",pa,[e("div",va,[a(Q,{label:"Guardar Cuadro",color:"green",size:"lg",icon:"save",onClick:t.saveMatches,loading:t.saving,class:"save-btn"},null,8,["onClick","loading"]),a(Q,{label:"Cancelar",color:"red",size:"lg",icon:"cancel",onClick:t.cancelPreview,outline:"",class:"cancel-btn"},null,8,["onClick"])]),c[9]||(c[9]=e("p",{class:"text-center q-mt-sm text-caption"}," Al guardar el cuadro, se cerrar\xE1n las inscripciones y se bloquear\xE1n las canchas para los horarios programados ",-1))])])):w("",!0)]),_:1})]),_:1})]),_:1})}var za=A(W,[["render",ha],["__scopeId","data-v-0ffde8b4"]]);export{za as default};
