import{Q as H}from"./QHeader.289f0645.js";import{x as R,r as m,h as X,a6 as A,o as n,z as _,A as t,d as e,B as s,a7 as p,a8 as g,E as U,aQ as F,D as j,Q as O,a as y,t as r,ab as Q,a9 as d,aa as S,e as G,ac as z}from"./index.687b44e8.js";import{Q as B,a as i}from"./QItem.eb9291fb.js";import{Q as C}from"./QList.1288e946.js";import{Q as D}from"./QItemLabel.bbebea39.js";import{Q as J}from"./QPage.fcc9aae1.js";import{Q as K,a as W}from"./QLayout.30990248.js";import{u as Y}from"./use-quasar.ba375293.js";import{A as Z,a as $}from"./AssociationTopMenu.c2c9d0dc.js";import{N as ee}from"./NotificationBell.9fdba392.js";import{B as oe}from"./BannerPromoScrolling.1700e538.js";import{m as te}from"./association.b92d73c6.js";import{_ as ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./QTabs.979bee57.js";import"./rtl.276c3f1b.js";import"./QFooter.b7b22f15.js";import"./QBtnDropdown.17175f2e.js";import"./QBtnGroup.6b9d07ee.js";import"./QMenu.df8dfc7c.js";import"./position-engine.46674690.js";import"./selection.0f785986.js";import"./haptics.57409bd0.js";import"./QBadge.0c3a126f.js";import"./api.1c42dce4.js";const le={name:"AssociationIngresos",components:{AssociationNavigationMenu:Z,AssociationTopMenu:$,NotificationBell:ee,BannerPromoScrolling:oe},setup(){const L=Y(),a=R(),I=m(!0),o=m(""),M=m(""),V=m("detailed"),v=m(0),b=m(0),x=m([]),w=m(null),l=()=>a.push("/dashboard/association"),k=c=>{const u=Number(c);return Number.isNaN(u)?"$0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(u)},E=c=>{if(!c)return"";const[u,N,h]=c.split("-");return new Date(parseInt(u,10),parseInt(N,10)-1,parseInt(h,10)).toLocaleDateString("es-MX",{day:"numeric",month:"short",year:"numeric"})},P=async()=>{var c,u,N,h;I.value=!0;try{const f={view:V.value};o.value&&(f.date_from=o.value),M.value&&(f.date_to=M.value);const T=await te(f),q=(T==null?void 0:T.data)||{};v.value=(c=q.total)!=null?c:0,b.value=(u=q.count)!=null?u:0,x.value=q.items||[],w.value=V.value==="consolidated"?q:null}catch(f){console.error("Error loading income:",f),L.notify({type:"negative",message:((h=(N=f.response)==null?void 0:N.data)==null?void 0:h.detail)||"Error al cargar ingresos"}),v.value=0,b.value=0,x.value=[],w.value=null}finally{I.value=!1}};return X(P),{goToDashboard:l,loading:I,dateFrom:o,dateTo:M,viewMode:V,total:v,count:b,items:x,consolidated:w,formatMoney:k,formatDateLabel:E,loadIncome:P}}},se={class:"header-content"},ne={class:"greeting"},re={class:"header-icons"},de={class:"row q-col-gutter-sm"},ie={class:"col-12 col-sm-6"},me={class:"col-12 col-sm-6"},ce={class:"row items-center"},ue={class:"col-6"},fe={class:"col-6 text-right"},_e={class:"text-h4 text-primary"},pe={class:"text-caption text-grey"},ge={key:0,class:"text-grey text-caption q-ma-none"};function ye(L,a,I,o,M,V){const v=A("NotificationBell"),b=A("AssociationTopMenu"),x=A("BannerPromoScrolling"),w=A("AssociationNavigationMenu");return n(),_(K,{view:"hHh lpR fFf",class:"text-white"},{default:t(()=>[e(H,{elevated:"",class:"text-white"},{default:t(()=>[s("div",se,[s("div",ne,[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:a[0]||(a[0]=(...l)=>o.goToDashboard&&o.goToDashboard(...l))}),a[5]||(a[5]=s("span",{class:"text-subtitle1"},"Ingresos",-1))]),s("div",re,[e(v),e(b)])]),e(x)]),_:1}),e(W,null,{default:t(()=>[e(J,{class:"q-pa-md"},{default:t(()=>[a[13]||(a[13]=s("div",{class:"text-h5 q-mb-md"},"Ingresos",-1)),a[14]||(a[14]=s("p",{class:"text-caption text-grey q-mb-md"},"Pagos recibidos por torneos y afiliaciones. Filtra por fecha o rango y elige vista detallada o consolidada.",-1)),e(p,{flat:"",bordered:"",class:"bg-grey-9 text-white q-mb-md"},{default:t(()=>[e(g,{class:"q-gutter-sm"},{default:t(()=>[s("div",de,[s("div",ie,[e(U,{modelValue:o.dateFrom,"onUpdate:modelValue":[a[1]||(a[1]=l=>o.dateFrom=l),o.loadIncome],label:"Desde",type:"date",outlined:"",dark:"",dense:"",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",me,[e(U,{modelValue:o.dateTo,"onUpdate:modelValue":[a[2]||(a[2]=l=>o.dateTo=l),o.loadIncome],label:"Hasta",type:"date",outlined:"",dark:"",dense:"",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])]),s("div",ce,[s("div",ue,[e(F,{modelValue:o.viewMode,"onUpdate:modelValue":[a[3]||(a[3]=l=>o.viewMode=l),o.loadIncome],val:"detailed",label:"Detallado",color:"primary"},null,8,["modelValue","onUpdate:modelValue"]),e(F,{modelValue:o.viewMode,"onUpdate:modelValue":[a[4]||(a[4]=l=>o.viewMode=l),o.loadIncome],val:"consolidated",label:"Consolidado",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",fe,[e(j,{flat:"",dense:"",label:"Aplicar",color:"primary",onClick:o.loadIncome},null,8,["onClick"])])])]),_:1})]),_:1}),o.loading?(n(),_(p,{key:0,flat:"",bordered:"",class:"bg-grey-9 text-white"},{default:t(()=>[e(g,{class:"text-center"},{default:t(()=>[e(O,{color:"primary",size:"40px"})]),_:1})]),_:1})):(n(),y(Q,{key:1},[e(p,{flat:"",bordered:"",class:"bg-grey-9 text-white q-mb-md"},{default:t(()=>[e(g,null,{default:t(()=>[a[6]||(a[6]=s("div",{class:"text-h6"},"Total en el periodo",-1)),s("div",_e,r(o.formatMoney(o.total)),1),s("div",pe,r(o.count)+" movimiento(s)",1)]),_:1})]),_:1}),o.viewMode==="consolidated"&&o.consolidated?(n(),y(Q,{key:0},[e(p,{flat:"",bordered:"",class:"bg-grey-9 text-white q-mb-md"},{default:t(()=>[e(g,null,{default:t(()=>[a[9]||(a[9]=s("div",{class:"text-subtitle1 q-mb-sm"},"Por tipo",-1)),e(C,{dense:""},{default:t(()=>[e(B,null,{default:t(()=>[e(i,null,{default:t(()=>[...a[7]||(a[7]=[d("Afiliaciones",-1)])]),_:1}),e(i,{side:""},{default:t(()=>{var l;return[d(r(o.formatMoney(((l=o.consolidated.by_type)==null?void 0:l.affiliation)||0)),1)]}),_:1})]),_:1}),e(B,null,{default:t(()=>[e(i,null,{default:t(()=>[...a[8]||(a[8]=[d("Torneos",-1)])]),_:1}),e(i,{side:""},{default:t(()=>{var l;return[d(r(o.formatMoney(((l=o.consolidated.by_type)==null?void 0:l.tournament)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{flat:"",bordered:"",class:"bg-grey-9 text-white"},{default:t(()=>[e(g,null,{default:t(()=>[a[10]||(a[10]=s("div",{class:"text-subtitle1 q-mb-sm"},"Por fecha",-1)),e(C,{dense:""},{default:t(()=>[(n(!0),y(Q,null,S(o.consolidated.by_date,(l,k)=>(n(),_(B,{key:k},{default:t(()=>[e(i,null,{default:t(()=>[d(r(o.formatDateLabel(k)),1)]),_:2},1024),e(i,{side:""},{default:t(()=>[d(r(o.formatMoney(l)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),Object.keys(o.consolidated.by_date||{}).length?G("",!0):(n(),y("p",ge,"No hay movimientos por fecha en el periodo."))]),_:1})]),_:1})],64)):(n(),y(Q,{key:1},[a[12]||(a[12]=s("div",{class:"text-subtitle1 q-mb-sm"},"Detalle de pagos",-1)),o.items.length?(n(),_(C,{key:0,bordered:"",class:"rounded-borders bg-transparent"},{default:t(()=>[(n(!0),y(Q,null,S(o.items,l=>(n(),_(B,{key:l.id,class:"q-mb-sm bg-grey-9"},{default:t(()=>[e(i,{avatar:""},{default:t(()=>[e(z,{name:l.event_type==="tournament"?"o_emoji_events":"o_person_add",color:"primary",size:"sm"},null,8,["name"])]),_:2},1024),e(i,null,{default:t(()=>[e(D,{class:"text-weight-medium"},{default:t(()=>[d(r(l.description),1)]),_:2},1024),e(D,{caption:""},{default:t(()=>[d(r(o.formatDateLabel((l.order_date||"").slice(0,10)))+" \xB7 "+r(l.event_type==="tournament"?"Torneo":"Afiliaci\xF3n"),1)]),_:2},1024)]),_:2},1024),e(i,{side:""},{default:t(()=>[e(D,{class:"text-weight-bold text-primary"},{default:t(()=>[d(r(o.formatMoney(l.total_amount)),1)]),_:2},1024),e(D,{caption:""},{default:t(()=>[d(r(l.payment_status),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),_(p,{key:1,flat:"",bordered:"",class:"bg-grey-9 text-white"},{default:t(()=>[e(g,{class:"text-center text-grey"},{default:t(()=>[e(z,{name:"o_payments",size:"48px",class:"q-mb-sm"}),a[11]||(a[11]=s("p",null,"No hay ingresos en el periodo seleccionado.",-1))]),_:1})]),_:1}))],64))],64))]),_:1})]),_:1}),e(w)]),_:1})}var He=ae(le,[["render",ye],["__scopeId","data-v-606feaad"]]);export{He as default};
