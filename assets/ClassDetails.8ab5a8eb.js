import{Q as T}from"./QHeader.8e557618.js";import{Q as F}from"./QSpinnerDots.243b178e.js";import{a7 as U,F as A,r as g,j as J,B as H,q as u,G as v,H as t,v as a,I as l,s as y,a9 as _,aa as x,J as h,ae as C,ab as m,x as i,bM as w,ad as D,ac as k,y as R,af as O,ag as G,ah as K,bC as q}from"./index.584acf07.js";import{Q as I,a as b}from"./QItem.b12511a1.js";import{Q as S}from"./QItemLabel.6f29d409.js";import{Q as W}from"./QList.c5a8907d.js";import{Q as X}from"./QPage.764a7077.js";import{Q as Y,a as Z}from"./QLayout.b710bb90.js";import{C as ee}from"./ClosePopup.cbe77d0c.js";import{u as ae}from"./use-quasar.c44f5730.js";import{u as te}from"./userStore.e4b54bb6.js";import{b as se}from"./lessons.499a96aa.js";import{b as le}from"./dateUtils.d59637e9.js";import{a as oe}from"./locationUtils.25dc967c.js";import{s as re}from"./shareUtils.4b03e3ec.js";import{a as E}from"./api.2af71db3.js";import{P as ne}from"./PlayerNavigationMenu.f62eec82.js";import{B as ie}from"./BannerPromoScrolling.2492a512.js";import{N as de}from"./NotificationBell.a467fcae.js";import{P as ue}from"./PlayerTopMenu.c48d9a03.js";import{_ as me}from"./PlayerSearch.f1581d4f.js";import{_ as pe}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.1c5897a4.js";import"./supabase.161424d9.js";import"./QTabs.6a6666b4.js";import"./rtl.276c3f1b.js";import"./QFooter.c5b1de81.js";import"./admin.c99b9bfe.js";import"./QBadge.2e8f5c62.js";import"./QBtnDropdown.56b29c58.js";import"./QMenu.f258a5f1.js";import"./position-engine.c3e1b9af.js";import"./selection.216c03ca.js";import"./players.9eee409b.js";const ce={class:"header-content"},fe={class:"header-icons"},ge={key:0,class:"text-center"},ve={key:1},ye={class:"row items-center",style:{position:"relative",width:"100%","margin-bottom":"20px"}},_e=["src"],xe={class:"q-mt-md text-center"},he={class:"text-h6 q-mt-sm"},be={__name:"ClassDetails",setup(Pe){const P=U(),N=A(),c=ae();te();const o=g(null),f=g(!0),p=g(!1),n=g(null),V=J(()=>!o.value||!n.value?!1:!n.value.is_paid),Q=async()=>{try{const r=await se(P.params.lessonId);if(o.value=r,console.log(o.value),r.payment_orders&&r.payment_orders.length>0){const e=r.payment_orders[0].id||r.payment_order_id;e&&await B(e)}}catch(r){console.error("Error al cargar los detalles del partido:",r.message),c.notify({type:"negative",message:"Error al cargar los detalles del partido."})}finally{f.value=!1}},B=async r=>{var e;try{const s=await E.get(`/payments/split-payment/${r}`);s.data&&(n.value=s.data)}catch(s){console.log("No split payment found for current user:",(e=s.response)==null?void 0:e.status),n.value=null}},z=()=>{p.value=!0},L=async r=>{var e,s;console.log("Jugador seleccionado:",r);try{f.value=!0;const d=await E.post("/lessons/add-player-to-private-lesson",{lesson_id:P.params.lessonId,player_id:r.user_id});d.data&&(c.notify({type:"positive",message:"Jugador agregado exitosamente a la clase."}),await Q(),d.data.needs_payment&&c.notify({type:"info",message:"El jugador agregado deber\xE1 pagar su parte de la clase."})),p.value=!1}catch(d){console.error("Error al agregar jugador:",d);const j=((s=(e=d.response)==null?void 0:e.data)==null?void 0:s.detail)||"Error al agregar el jugador a la clase.";c.notify({type:"negative",message:j})}finally{f.value=!1}},$=()=>{const r="\xDAnete a esta clase.",e=window.location.href;re(r,e,"Echa un vistazo a esta clase de padel.")},M=()=>{n.value&&N.push({name:"StripePayment",query:{splitPaymentId:n.value.id,amount:n.value.amount,paymentOrderId:n.value.payment_order_id,returnUrl:`/player/privatelesson/${P.params.lessonId}`}})};return H(Q),(r,e)=>(u(),v(Y,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[a(T,{elevated:"",class:"text-white"},{default:t(()=>[l("div",ce,[e[3]||(e[3]=l("div",{class:"greeting"},[l("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})],-1)),l("div",fe,[a(de),a(ue)])]),a(ie)]),_:1}),a(Z,null,{default:t(()=>[a(X,{class:"q-pa-md"},{default:t(()=>[f.value?(u(),y("div",ge,[a(F,{color:"primary",size:"xl"})])):(u(),y("div",ve,[a(_,{class:"text-white q-pa-md match-card"},{default:t(()=>[a(x,null,{default:t(()=>[l("div",ye,[a(h,{flat:"",onClick:$,style:{position:"absolute",left:"0"}},{default:t(()=>[a(C,{name:"o_share",size:"md"})]),_:1}),e[4]||(e[4]=l("h3",{class:"text-h5 text-white",style:{flex:"1",margin:"0","text-align":"center"}},"Entrenamiento",-1))]),l("p",null,[m(" Entrenas en el club "+i(o.value.clubs.name||"No disponible")+" ",1),a(h,{size:"sm",flat:"",round:"",color:"orange",icon:"o_location_on",onClick:e[0]||(e[0]=s=>w(oe)(o.value.clubs.latitude,o.value.clubs.longitude))}),m(" el d\xEDa "+i(w(le)(o.value.lesson_date.value))+" a las "+i(o.value.lesson_time.slice(0,5))+" hrs. En la cancha "+i(o.value.courts.name||"No disponible")+". ",1)]),l("p",null,[e[5]||(e[5]=m("Tipo de partido: Clase Privada")),e[6]||(e[6]=l("br",null,null,-1)),m(" Precio: $"+i(o.value.price)+" PP: $"+i(o.value.price/o.value.participants),1),e[7]||(e[7]=l("br",null,null,-1)),m(" Coach: "+i(o.value.coaches.name),1)])]),_:1})]),_:1}),a(_,{class:"match-card text-white q-pa-md"},{default:t(()=>[a(x,{class:"q-mt-md"},{default:t(()=>[e[9]||(e[9]=l("h3",{class:"text-center text-white"},"Participantes",-1)),a(W,{bordered:"",separator:""},{default:t(()=>[(u(!0),y(D,null,k(o.value.playerDetails,s=>(u(),v(I,{key:s.user_id},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[a(q,{size:"48px"},{default:t(()=>[l("img",{src:s.photo_url,alt:"Foto del jugador",style:{"border-radius":"50%"}},null,8,_e)]),_:2},1024)]),_:2},1024),a(b,null,{default:t(()=>[a(S,null,{default:t(()=>[m(i(s.first_name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(u(!0),y(D,null,k(o.value.participants-o.value.playerDetails.length,s=>(u(),v(I,{key:"add-player-"+s,clickable:"",onClick:z},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[a(q,{size:"48px",class:"bg-grey-7"},{default:t(()=>[a(C,{name:"person_add",size:"32px",color:"white"})]),_:1})]),_:1}),a(b,null,{default:t(()=>[a(S,null,{default:t(()=>e[8]||(e[8]=[m("Agregar jugador")])),_:1})]),_:1})]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),V.value?(u(),v(_,{key:0,class:"match-card text-white q-pa-md q-mt-md"},{default:t(()=>[a(x,null,{default:t(()=>{var s,d;return[e[11]||(e[11]=l("h3",{class:"text-center text-white"},"Estado de Pago",-1)),l("div",xe,[e[10]||(e[10]=l("p",{class:"text-body1"},"Tienes un pago pendiente para esta clase",-1)),l("p",he,"Monto: $"+i(((d=(s=n.value)==null?void 0:s.amount)==null?void 0:d.toFixed(2))||"0.00"),1),a(h,{color:"primary",label:"Pagar mi parte",class:"q-mt-md",onClick:M,icon:"payment",size:"lg"})])]}),_:1})]),_:1})):R("",!0)]))]),_:1})]),_:1}),a(K,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s)},{default:t(()=>[a(_,null,{default:t(()=>[a(x,null,{default:t(()=>[e[12]||(e[12]=l("div",{class:"text-h6"},"Agregar Jugador",-1)),a(me,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),onPlayerSelected:L},null,8,["modelValue"])]),_:1}),a(O,{align:"right"},{default:t(()=>[G(a(h,{flat:"",label:"Cancelar",color:"negative"},null,512),[[ee]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ne)]),_:1}))}};var sa=pe(be,[["__scopeId","data-v-18f97b48"]]);export{sa as default};
