import{a8 as w,q as d,G as p,H as r,v as o,I as s,ab as v,J as n,a9 as g,aa as u,s as f,Q as _,ae as h,ah as C,K as c,af as k,ag as Q}from"./index.926cdc30.js";import{Q as V}from"./QHeader.84613758.js";import{Q as x}from"./QTd.0371924e.js";import{Q as q}from"./QTable.3f463107.js";import{Q as N}from"./QSelect.3737d2a3.js";import{Q as D}from"./QPage.761f77aa.js";import{Q as E,a as M}from"./QLayout.4f822e59.js";import{C as B}from"./ClosePopup.41240749.js";import{C as U}from"./ClubNavigationMenu.0b87b389.js";import{g as b,a as y}from"./api.92f95132.js";import{s as I}from"./supabase.f21eeafd.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import"./QList.5a79a3d2.js";import"./use-fullscreen.de5836c0.js";import"./QChip.c64c8d68.js";import"./QItem.2901f214.js";import"./QItemLabel.1b922da2.js";import"./QMenu.b1c63b4e.js";import"./position-engine.934de070.js";import"./selection.db442573.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QTabs.b974ffab.js";import"./QFooter.fc71ab7d.js";const T={data(){return{loading:!1,isProductDialogOpen:!1,products:[],newProduct:{name:"",brand:"",category:"",price:0,modality:"venta"},columns:[{name:"name",label:"Nombre",field:"name",align:"left"},{name:"brand",label:"Marca",field:"brand",align:"left"},{name:"category",label:"Categor\xEDa",field:"category",align:"left"},{name:"price",label:"Precio",field:"price",align:"left"},{name:"modality",label:"Modalidad",field:"modality",align:"left"},{name:"actions",label:"Acciones",field:"actions",align:"center"}]}},components:{ClubNavigationMenu:U},methods:{async fetchProducts(){this.loading=!0;try{const l=b();if(!l||!l.club_id)throw new Error("No se pudo obtener el club_id del usuario.");const{data:e,error:m}=await I.from("club_products").select("*").eq("club_id",l.club_id);if(m)throw m;this.products=e}catch(l){console.error("Error al obtener los productos:",l),this.$q.notify({type:"negative",message:"Error al cargar los productos"})}finally{this.loading=!1}},openProductDialog(){this.isProductDialogOpen=!0},async saveProduct(){try{const l=b();if(!l||!l.club_id)throw new Error("No se pudo obtener el club_id del usuario.");const e={...this.newProduct,club_id:l.club_id};await y.post("/products",e),this.isProductDialogOpen=!1,await this.fetchProducts(),this.$q.notify({type:"positive",message:"Producto agregado exitosamente."})}catch(l){console.error("Error al guardar el producto:",l),this.$q.notify({type:"negative",message:"Error al guardar el producto. Intenta nuevamente."})}},async deleteProduct(l){try{await y.delete(`/products/${l}`),await this.fetchProducts(),this.$q.notify({type:"positive",message:"Producto eliminado exitosamente."})}catch(e){console.error("Error al eliminar el producto:",e),this.$q.notify({type:"negative",message:"Error al eliminar el producto. Intenta nuevamente."})}},goBack(){this.$router.back()}},mounted(){this.fetchProducts()}},z={class:"header-content"},A={class:"header-icons"},F={key:0,class:"text-center q-pa-md"},G={key:1,class:"text-center q-pa-md"};function H(l,e,m,L,t,i){const P=w("ClubNavigationMenu");return d(),p(E,{view:"hHh lpR fFf",class:"body text-black"},{default:r(()=>[o(V,{elevated:"",class:"bg-primary text-white"},{default:r(()=>[s("div",z,[e[6]||(e[6]=s("div",{class:"greeting"},[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"}),v(" Gesti\xF3n de Productos ")],-1)),s("div",A,[o(n,{flat:"",round:"",icon:"close",onClick:i.goBack},null,8,["onClick"])])])]),_:1}),o(M,null,{default:r(()=>[o(D,{class:"q-pa-md"},{default:r(()=>[o(g,{class:"transparent-card q-mb-md"},{default:r(()=>[o(u,null,{default:r(()=>e[7]||(e[7]=[s("div",{class:"text-h6"},"Lista de Productos",-1)])),_:1}),o(u,null,{default:r(()=>[t.loading?(d(),f("div",F,[o(_,{color:"primary",size:"xl"}),e[8]||(e[8]=s("p",{class:"q-mt-sm"},"Cargando productos...",-1))])):t.products.length===0?(d(),f("div",G,[o(h,{name:"o_shopping_cart",size:"2em"}),e[9]||(e[9]=s("p",{class:"q-mt-sm"},"No hay productos registrados.",-1))])):(d(),p(q,{key:2,rows:t.products,columns:t.columns,"row-key":"id",flat:"",bordered:"",class:"transparent-table"},{"body-cell-actions":r(a=>[o(x,{props:a},{default:r(()=>[o(n,{flat:"",round:"",color:"negative",icon:"delete",onClick:S=>i.deleteProduct(a.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]))]),_:1})]),_:1}),o(n,{glossy:"",round:"",size:"lg",color:"black",icon:"add",class:"fixed-bottom-right q-mb-xl",onClick:i.openProductDialog},null,8,["onClick"]),o(C,{modelValue:t.isProductDialogOpen,"onUpdate:modelValue":e[5]||(e[5]=a=>t.isProductDialogOpen=a)},{default:r(()=>[o(g,{class:"bg-black text-white",style:{"min-width":"400px"}},{default:r(()=>[o(u,null,{default:r(()=>e[10]||(e[10]=[s("div",{class:"text-h6"},"Agregar Producto",-1)])),_:1}),o(u,null,{default:r(()=>[o(c,{modelValue:t.newProduct.name,"onUpdate:modelValue":e[0]||(e[0]=a=>t.newProduct.name=a),label:"Nombre",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.brand,"onUpdate:modelValue":e[1]||(e[1]=a=>t.newProduct.brand=a),label:"Marca",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.category,"onUpdate:modelValue":e[2]||(e[2]=a=>t.newProduct.category=a),label:"Familia/Categor\xEDa",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.price,"onUpdate:modelValue":e[3]||(e[3]=a=>t.newProduct.price=a),label:"Precio",type:"number",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(N,{modelValue:t.newProduct.modality,"onUpdate:modelValue":e[4]||(e[4]=a=>t.newProduct.modality=a),options:[{label:"Venta",value:"sale"},{label:"Renta",value:"rental"}],label:"Modalidad",outlined:"",dense:"",color:"white","emit-value":"","map-options":""},null,8,["modelValue"])]),_:1}),o(k,{align:"right"},{default:r(()=>[Q(o(n,{flat:"",label:"Cancelar",color:"primary"},null,512),[[B]]),o(n,{flat:"",label:"Guardar",color:"secondary",onClick:i.saveProduct},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(P)]),_:1})}var fe=O(T,[["render",H],["__scopeId","data-v-a5c9311e"]]);export{fe as default};
