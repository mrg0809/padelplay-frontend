import{Q as m,a as c}from"./QToolbar.cb6ff08d.js";import{Q as p}from"./QHeader.8d5bfa86.js";import{Q as f}from"./QSelect.d41f4184.js";import{Q as _}from"./QTable.4dbbd353.js";import{q as h,G as g,H as t,v as r,ab as b,I as i,x as d,J as u}from"./index.58e85a5d.js";import{Q as U}from"./QPage.a530dec3.js";import{Q as v,a as y}from"./QLayout.09e0bdd8.js";import{s as Q}from"./supabase.29bebebf.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.8c885d9a.js";import"./QItem.e5e2bb84.js";import"./QItemLabel.bea571b7.js";import"./QMenu.59955c92.js";import"./position-engine.e8fed520.js";import"./selection.8f8b987b.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.b81aac75.js";import"./QMarkupTable.f63fcc0e.js";import"./use-fullscreen.7457a6bf.js";const w={name:"ManageUsers",data(){return{users:[],filteredUsers:[],selectedFilter:"all",filters:[{label:"Todos",value:"all"},{label:"Clubes",value:"club"},{label:"Asociaciones",value:"association"}],columns:[{name:"email",label:"Correo",align:"left",field:"email"},{name:"name",label:"Nombre",align:"left",field:"name"}]}},computed:{totalClubs(){return this.users.filter(e=>e.user_type==="club").length},totalAssociations(){return this.users.filter(e=>e.user_type==="association").length}},methods:{async fetchUsers(){try{const{data:e,error:s}=await Q.rpc("get_users_with_profiles");if(s){console.error("Error al obtener usuarios:",s.message);return}this.users=e.map(l=>({id:l.id,email:l.email,name:l.full_name,user_type:l.user_type})),console.log("Usuarios cargados:",this.users),this.filterUsers()}catch(e){console.error("Error inesperado:",e.message)}},filterUsers(){console.log("Filtro seleccionado:",this.selectedFilter),console.log("Usuarios antes de filtrar:",this.users),this.selectedFilter.value==="all"?this.filteredUsers=[...this.users]:this.filteredUsers=this.users.filter(e=>(console.log("Comparando:",e.user_type,"con",this.selectedFilter.value),e.user_type===this.selectedFilter.value)),console.log("Usuarios filtrados:",this.filteredUsers)},addUser(e){this.$router.push(`/admin/add-user?type=${e}`)}},watch:{selectedFilter:"filterUsers"},mounted(){this.fetchUsers()}},x={class:"q-mb-md"},F={class:"q-mt-md text-white"},A={class:"q-mb-md text-right"};function T(e,s,l,k,o,a){return h(),g(v,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[r(p,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[r(m,null,{default:t(()=>[r(c,null,{default:t(()=>s[3]||(s[3]=[b("Administrar Usuarios")])),_:1})]),_:1})]),_:1}),r(y,null,{default:t(()=>[r(U,{class:"q-pa-md"},{default:t(()=>[i("div",x,[r(f,{modelValue:o.selectedFilter,"onUpdate:modelValue":s[0]||(s[0]=n=>o.selectedFilter=n),options:o.filters,label:"Filtrar por tipo de usuario",outlined:"",dense:"",color:"primary",onChange:a.filterUsers},null,8,["modelValue","options","onChange"])]),r(_,{flat:"",rows:o.filteredUsers,columns:o.columns,"row-key":"id",dense:"",class:"text-white bg-dark","hide-bottom":""},null,8,["rows","columns"]),i("div",F,[i("p",null,"Total Clubes: "+d(a.totalClubs),1),i("p",null,"Total Asociaciones: "+d(a.totalAssociations),1)]),i("div",A,[r(u,{label:"Agregar Club",color:"primary",icon:"add",class:"q-mr-md",onClick:s[1]||(s[1]=n=>a.addUser("club"))}),r(u,{label:"Agregar Asociaci\xF3n",color:"primary",icon:"add",onClick:s[2]||(s[2]=n=>a.addUser("association"))})])]),_:1})]),_:1})]),_:1})}var X=C(w,[["render",T],["__scopeId","data-v-388c2e0e"]]);export{X as default};
