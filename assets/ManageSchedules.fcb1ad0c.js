import{a8 as k,q as u,G as p,H as a,v as t,I as g,ab as S,J as f,a9 as v,aa as b,s as V,ac as Q,ad as U,y as h,af as w,x,aK as D,K as C}from"./index.1566f29d.js";import{Q as H}from"./QHeader.54921acb.js";import{Q as q}from"./QSelect.688fe2ed.js";import{Q as B,a as y}from"./QItem.e116c373.js";import{Q as M}from"./QList.ebf37292.js";import{Q as N}from"./QPage.fbc29baa.js";import{Q as E,a as T}from"./QLayout.fe0a2002.js";import{u as A}from"./userStore.54a18707.js";import{n as I}from"./navigationUtils.2c4b9dee.js";import{C as L}from"./ClubNavigationMenu.01f0e531.js";import{a as _}from"./api.2af71db3.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.c4d6d4b9.js";import"./QItemLabel.d288c8d5.js";import"./QMenu.72259432.js";import"./position-engine.ad0a1325.js";import"./selection.72ed1d7a.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./pinia.19a50246.js";import"./QTabs.4f592614.js";import"./QFooter.4d1d6c3f.js";const P={data(){return{selectedCourt:null,courts:[],generalSchedule:Array(7).fill(null).map(()=>({is_open:!1,opening_time:"06:00",closing_time:"23:00"})),daysOfWeek:["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado","Domingo"],confirmDialogVisible:!1,blockCourtDialogVisible:!1,blockCourtData:{date:null,start_time:null,end_time:null,reason:""},holidayData:{date:null,reason:""}}},components:{ClubNavigationMenu:L},setup(){return{userStore:A()}},methods:{async fetchCourts(){try{const l=await _.get("/courts/");this.courts=l.data.map(o=>({id:o.id,name:o.name}))}catch(l){console.error("Error al obtener las canchas:",l)}},async onCourtChange(){if(this.generalSchedule=Array(7).fill(null).map(()=>({is_open:!1,opening_time:null,closing_time:null})),!!this.selectedCourt)try{const o=(await _.get("/clubs/schedules",{params:{court_id:this.selectedCourt}})).data.data.filter(s=>s.court_id===this.selectedCourt.id);o.length>0&&o.forEach(s=>{const d=s.day_of_week;this.generalSchedule[d]={is_open:s.opening_time!==null&&s.closing_time!==null,opening_time:s.opening_time||"06:00",closing_time:s.closing_time||"23:00"}})}catch(l){console.error("Error al obtener los horarios:",l)}},async saveOrUpdateSchedules(){var l,o,s,d;if(!this.selectedCourt){this.$q.notify({type:"negative",message:"Por favor, selecciona una cancha"});return}try{const e=this.generalSchedule.map((i,c)=>({day_of_week:c,opening_time:i.is_open?i.opening_time:null,closing_time:i.is_open?i.closing_time:null,court_id:this.selectedCourt}));((o=(l=(await _.get("/clubs/schedules",{params:{court_id:this.selectedCourt}})).data)==null?void 0:l.data)==null?void 0:o.length)>0?(await _.put("/clubs/schedules",{court_id:this.selectedCourt,schedules:e}),this.$q.notify({type:"positive",message:"Horarios actualizados exitosamente"})):(await _.post("/clubs/schedules",{schedules:e}),this.$q.notify({type:"positive",message:"Horarios creados exitosamente"}))}catch(e){console.error("Error al guardar los horarios:",((d=(s=e.response)==null?void 0:s.data)==null?void 0:d.detail)||e.message),this.$q.notify({type:"negative",message:"Error al guardar los horarios"})}},goBack(){this.$router.back()},goToDashboard(){I(this.$router,this.userStore)}},mounted(){this.fetchCourts()}},F={class:"header-content"},G={class:"greeting"},J={class:"header-icons"},K={class:"text-bold"};function W(l,o,s,d,e,n){const i=k("ClubNavigationMenu");return u(),p(E,{view:"hHh lpR fFf",class:"body text-black"},{default:a(()=>[t(H,{elevated:"",class:"bg-primary text-white"},{default:a(()=>[g("div",F,[g("div",G,[g("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:o[0]||(o[0]=(...c)=>n.goToDashboard&&n.goToDashboard(...c))}),o[2]||(o[2]=S(" Horarios "))]),g("div",J,[t(f,{flat:"",round:"",icon:"close",onClick:n.goBack},null,8,["onClick"])])])]),_:1}),t(T,null,{default:a(()=>[t(N,{class:"q-pa-md"},{default:a(()=>[t(v,{class:"courts-card text-black"},{default:a(()=>[t(b,null,{default:a(()=>[t(q,{modelValue:e.selectedCourt,"onUpdate:modelValue":[o[1]||(o[1]=c=>e.selectedCourt=c),n.onCourtChange],options:e.courts,"option-label":"name","option-value":"id",label:"Selecciona una cancha",outlined:"",dense:"",class:"custom-select"},null,8,["modelValue","options","onUpdate:modelValue"])]),_:1}),e.selectedCourt?(u(),p(b,{key:0},{default:a(()=>[t(M,{bordered:""},{default:a(()=>[(u(!0),V(U,null,Q(e.generalSchedule,(c,r)=>(u(),p(B,{key:r,class:"q-mb-md"},{default:a(()=>[t(y,null,{default:a(()=>[g("div",K,x(e.daysOfWeek[r]),1),t(D,{modelValue:e.generalSchedule[r].is_open,"onUpdate:modelValue":m=>e.generalSchedule[r].is_open=m,label:"\xBFAbierto?",dense:"",color:"black"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e.generalSchedule[r].is_open?(u(),p(y,{key:0},{default:a(()=>[t(C,{modelValue:e.generalSchedule[r].opening_time,"onUpdate:modelValue":m=>e.generalSchedule[r].opening_time=m,label:"Hora de Apertura",dense:"",outlined:"",color:"black",class:"text-black"},null,8,["modelValue","onUpdate:modelValue"]),t(C,{modelValue:e.generalSchedule[r].closing_time,"onUpdate:modelValue":m=>e.generalSchedule[r].closing_time=m,label:"Hora de Cierre",dense:"",outlined:"",color:"black",class:"text-black"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):h("",!0)]),_:2},1024))),128))]),_:1})]),_:1})):h("",!0),e.selectedCourt?(u(),p(w,{key:1,align:"right"},{default:a(()=>[t(f,{label:"Guardar Cambios",color:"primary",onClick:n.saveOrUpdateSchedules},null,8,["onClick"])]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1}),t(i)]),_:1})}var _e=O(P,[["render",W],["__scopeId","data-v-8c41de60"]]);export{_e as default};
