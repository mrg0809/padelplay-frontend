import{Q as E}from"./QHeader.bad00686.js";import{Q as U}from"./QSpinnerDots.39d2155b.js";import{a9 as q,F as A,r as p,B as Y,q as t,G as m,H as i,v as u,I as a,bI as M,s as n,ab as w,ac as P,ag as H,x as l,ad as R,y as V,bE as x,J as b,bD as N}from"./index.188957e1.js";import{Q as L}from"./QPage.d6b4f804.js";import{Q as O,a as G}from"./QLayout.841981cf.js";import{u as X}from"./use-quasar.51ce0ad1.js";import{u as K}from"./userStore.551ce0f9.js";import{u as W}from"./useDashboardNavigation.d2d7a880.js";import{u as Z}from"./summaryStore.cb29faab.js";import{a as I}from"./api.2af71db3.js";import{B as ee}from"./BannerPromoScrolling.6ad8f16b.js";import{_ as ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.db3bcbf1.js";import"./admin.c99b9bfe.js";const te={class:"header-content"},oe={class:"greeting"},se={key:0,class:"text-center"},le={key:1,class:"text-center"},re={key:2},ie={class:"text-center"},ne={key:0},ce={key:1},de={key:2},ue={class:"court-container"},me={class:"court"},pe={class:"player team1-player1"},_e={key:0},ve=["src"],he={key:1},fe={class:"text-caption"},ye={class:"player team1-player2"},ge={key:0},ke=["src"],xe={key:1},be={class:"text-caption"},De={class:"player team2-player1"},Ce={key:0},we=["src"],Pe={key:1},Qe={class:"text-caption"},Se={class:"player team2-player2"},je={key:0},Je=["src"],Me={key:1},Ne={class:"text-caption"},Ie={__name:"JoinMatch",setup(Te){const _=q(),D=A(),{goToDashboard:Q}=W(),y=X(),T=K(),$=Z(),s=p(null),c=p([]),d=p([]),S=p(!0),C=p(null),j=p(!1),h=p(0),J=o=>{N.locale("es-mx");const e=N(o).format("dddd, D [de] MMMM [del] YYYY"),[r,f]=e.split(" de "),v=r.charAt(0).toUpperCase()+r.slice(1),k=f.charAt(0).toUpperCase()+f.slice(1);return v+" de "+k},F=async()=>{try{const o=await I.get(`/matches/match/${_.params.matchId}`);s.value=o.data,c.value=o.data.team1_players||[],d.value=o.data.team2_players||[],o.data.reservation&&o.data.reservation.total_price&&(h.value=(o.data.reservation.total_price/4).toFixed(2))}catch(o){console.error("Error al cargar los detalles del partido:",o),C.value="No se pudo cargar la informaci\xF3n del partido. Por favor, verifica el enlace."}finally{S.value=!1}},g=async(o,e)=>{if(!T.isAuthenticated){y.notify({type:"info",message:"Por favor inicia sesi\xF3n para unirte al juego"}),localStorage.setItem("redirectAfterLogin",_.fullPath),D.push("/");return}if((o===1?c.value:d.value)[e]){y.notify({type:"warning",message:"Este espacio ya est\xE1 ocupado"});return}j.value||h.value===0?await z(o,e):B(o,e)},z=async(o,e)=>{var r,f;try{const v={match_id:_.params.matchId,slot_index:e,team_to_join:o},k=await I.post("/matches/join",v);k.data&&k.data.message&&(y.notify({type:"positive",message:"\xA1Te has unido al partido exitosamente!"}),D.push(`/player/match/${_.params.matchId}`))}catch(v){console.error("Error al unirse al partido:",v),y.notify({type:"negative",message:((f=(r=v.response)==null?void 0:r.data)==null?void 0:f.detail)||"Error al unirse al partido"})}},B=(o,e)=>{const r={summaryTitle:"Confirmar Uni\xF3n a Juego",itemDetails:[{label:"Club",value:s.value.club_name||"No especificado"},{label:"Fecha",value:J(s.value.match_date)},{label:"Hora",value:`${s.value.match_time.slice(0,5)} hrs.`},{label:"Categor\xEDa",value:s.value.category||"N/A"},{label:"Precio (Tu parte)",value:`$${h.value}`}],baseData:{clubId:s.value.club_id,price:parseFloat(h.value),participants:1,type:"open_match_join",id:_.params.matchId},allowPaymentSplit:!1,showPublicToggle:!1,commissionRate:4,extraData:{matchId:_.params.matchId,teamToJoin:o,slotIndex:e,matchCategory:s.value.category,matchDate:s.value.match_date,matchTime:s.value.match_time,clubName:s.value.club_name}};$.setSummaryDetails(r),D.push({name:"OrderSummary"})};return Y(()=>{F()}),(o,e)=>(t(),m(O,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:i(()=>[u(E,{elevated:"",class:"text-white"},{default:i(()=>[a("div",te,[a("div",oe,[a("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...r)=>M(Q)&&M(Q)(...r))})])]),u(ee)]),_:1}),u(G,null,{default:i(()=>[u(L,{class:"q-pa-md"},{default:i(()=>[S.value?(t(),n("div",se,[u(U,{color:"primary",size:"xl"})])):C.value?(t(),n("div",le,[u(w,{class:"bg-dark text-white q-pa-md"},{default:i(()=>[u(P,null,{default:i(()=>[u(H,{name:"error",size:"lg",color:"negative"}),a("h5",null,l(C.value),1)]),_:1})]),_:1})])):(t(),n("div",re,[u(w,{class:"text-white q-pa-md match-card"},{default:i(()=>[u(P,null,{default:i(()=>[e[6]||(e[6]=a("h3",{class:"text-h5 text-white text-center"},"\xA1Te invitaron a un juego!",-1)),a("p",ie," Juegas en el club "+l(s.value.club_name||"No disponible")+" el dia "+l(J(s.value.match_date))+" a las "+l(s.value.match_time.slice(0,5))+" hrs. En la cancha "+l(s.value.court_name||"No disponible")+". ",1),s.value.category?(t(),n("p",ne,[R("Categor\xEDa: "+l(s.value.category),1),e[5]||(e[5]=a("br",null,null,-1))])):V("",!0),j.value?(t(),n("p",ce,"Estado del pago: Ya pagado")):(t(),n("p",de,"Precio por jugador: $"+l(h.value)+" MXN",1))]),_:1})]),_:1}),u(w,{class:"match-card text-white q-pa-md q-mt-md"},{default:i(()=>[u(P,null,{default:i(()=>[e[11]||(e[11]=a("h3",{class:"text-center text-white"},"Jugadores",-1)),a("div",ue,[a("div",me,[a("div",pe,[c.value[0]?(t(),n("div",_e,[c.value[0].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:c.value[0].photo_url,alt:"Foto del jugador"},null,8,ve)]),_:1})):(t(),n("span",he,l(c.value[0].first_name||"Jugador 1"),1)),a("div",fe,l(c.value[0].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[1]||(e[1]=r=>g(1,0)),title:"Unirse a este espacio"}))]),a("div",ye,[c.value[1]?(t(),n("div",ge,[c.value[1].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:c.value[1].photo_url,alt:"Foto del jugador"},null,8,ke)]),_:1})):(t(),n("span",xe,l(c.value[1].first_name||"Jugador 2"),1)),a("div",be,l(c.value[1].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[2]||(e[2]=r=>g(1,1)),title:"Unirse a este espacio"}))]),a("div",De,[d.value[0]?(t(),n("div",Ce,[d.value[0].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:d.value[0].photo_url,alt:"Foto del jugador"},null,8,we)]),_:1})):(t(),n("span",Pe,l(d.value[0].first_name||"Jugador 1"),1)),a("div",Qe,l(d.value[0].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[3]||(e[3]=r=>g(2,0)),title:"Unirse a este espacio"}))]),a("div",Se,[d.value[1]?(t(),n("div",je,[d.value[1].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:d.value[1].photo_url,alt:"Foto del jugador"},null,8,Je)]),_:1})):(t(),n("span",Me,l(d.value[1].first_name||"Jugador 2"),1)),a("div",Ne,l(d.value[1].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[4]||(e[4]=r=>g(2,1)),title:"Unirse a este espacio"}))]),e[7]||(e[7]=a("div",{class:"line1"},null,-1)),e[8]||(e[8]=a("div",{class:"net"},null,-1)),e[9]||(e[9]=a("div",{class:"line2"},null,-1)),e[10]||(e[10]=a("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1})]))]),_:1})]),_:1})]),_:1}))}};var Ge=ae(Ie,[["__scopeId","data-v-4f68ee35"]]);export{Ge as default};
