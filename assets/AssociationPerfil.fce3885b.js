import{Q as O}from"./QHeader.8ed599dc.js";import{x as D,y as z,r as N,a0 as R,f as j,h as F,a6 as _,o as g,z as b,A as i,d as t,B as n,a7 as C,a8 as f,Q as G,aT as H,E as y,bE as W,e as M,D as w}from"./index.44d6004f.js";import{Q as E}from"./QSelect.22e7e4d3.js";import{Q as Y}from"./QForm.29e7d3c5.js";import{Q as J}from"./QPage.069cc100.js";import{Q as K,a as Z}from"./QLayout.bdadfe99.js";import{u as X}from"./use-quasar.00fa2d0c.js";import{A as $,a as aa}from"./AssociationTopMenu.55ec1150.js";import{N as oa}from"./NotificationBell.03dce8ef.js";import{B as ea}from"./BannerPromoScrolling.0ad337b6.js";import{g as ta,k as la}from"./association.a03ae41f.js";import{s as U}from"./supabase.3e81c9a1.js";import{_ as sa}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.d99417f0.js";import"./QItem.cafd0d6f.js";import"./QItemLabel.30a3dfed.js";import"./QMenu.aa52843c.js";import"./position-engine.d7eef48c.js";import"./selection.ab0d7921.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QTabs.02ad9b81.js";import"./QFooter.dec25843.js";import"./QList.8f6ea51c.js";import"./QBtnDropdown.9d90b70a.js";import"./QBtnGroup.0f4e86aa.js";import"./haptics.bd260566.js";import"./QBadge.182a08f3.js";import"./api.dcb17b1f.js";const ia=[{value:"Mexico",label:"M\xE9xico"},{value:"Estados Unidos",label:"Estados Unidos"},{value:"Canada",label:"Canad\xE1"},{value:"Ecuador",label:"Ecuador"}],P={Mexico:["Aguascalientes","Baja California","Baja California Sur","Campeche","Chiapas","Chihuahua","Ciudad de M\xE9xico","Coahuila","Colima","Durango","Guanajuato","Guerrero","Hidalgo","Jalisco","M\xE9xico","Michoac\xE1n","Morelos","Nayarit","Nuevo Le\xF3n","Oaxaca","Puebla","Quer\xE9taro","Quintana Roo","San Luis Potos\xED","Sinaloa","Sonora","Tabasco","Tamaulipas","Tlaxcala","Veracruz","Yucat\xE1n","Zacatecas"],"Estados Unidos":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming","District of Columbia"],Canada:["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Northwest Territories","Nova Scotia","Nunavut","Ontario","Prince Edward Island","Quebec","Saskatchewan","Yukon"],Ecuador:["Azuay","Bol\xEDvar","Ca\xF1ar","Carchi","Chimborazo","Cotopaxi","El Oro","Esmeraldas","Gal\xE1pagos","Guayas","Imbabura","Loja","Los R\xEDos","Manab\xED","Morona Santiago","Napo","Orellana","Pastaza","Pichincha","Santa Elena","Santo Domingo de los Ts\xE1chilas","Sucumb\xEDos","Tungurahua","Zamora Chinchipe"]},ra=d=>{if(!d||!Array.isArray(d))return[];const o=[];return d.forEach(a=>{P[a]&&o.push(...P[a].map(m=>({value:m,label:m})))}),Array.from(new Set(o.map(a=>a.value))).map(a=>({value:a,label:o.find(m=>m.value===a).label}))};const na={name:"AssociationPerfil",components:{AssociationNavigationMenu:$,AssociationTopMenu:aa,NotificationBell:oa,BannerPromoScrolling:ea},setup(){const d=X(),o=D(),v=z(),a=N(null),m=N(!0),p=N(!1),l=R({name:"",logo_url:"",countries:[],states:[],address:"",contact_email:"",website:"",about:""}),k=ia,h=j(()=>ra(l.countries)),x=()=>o.push("/dashboard/association"),e=()=>o.back(),Q=()=>{var u;(u=a.value)==null||u.click()},B=async u=>{var s;const r=(s=u.target.files)==null?void 0:s[0];if(!!r){if(!r.type.startsWith("image/")){d.notify({type:"negative",message:"Solo se permiten im\xE1genes"});return}if(r.size>5*1024*1024){d.notify({type:"negative",message:"La imagen debe ser menor a 5MB"});return}p.value=!0;try{const c=r.name.split(".").pop(),S="club-logos",A=`association-logos/${Date.now()}.${c}`,{data:ba,error:V}=await U.storage.from(S).upload(A,r,{upsert:!0});if(V)throw V;const{data:{publicUrl:I}}=U.storage.from(S).getPublicUrl(A);l.logo_url=I,d.notify({type:"positive",message:"Logo subido"})}catch(c){d.notify({type:"negative",message:"Error al subir logo: "+(c.message||"Error desconocido")})}finally{p.value=!1}}},T=()=>{const u=h.value.map(r=>r.value);l.states=l.states.filter(r=>u.includes(r))},q=async()=>{var u,r;m.value=!0;try{const s=await ta();s.data?(l.name=s.data.name||"",l.logo_url=s.data.logo_url||"",l.countries=Array.isArray(s.data.countries)?s.data.countries:[],l.states=Array.isArray(s.data.states)?s.data.states:[],l.address=s.data.address||"",l.contact_email=s.data.contact_email||"",l.website=s.data.website||"",l.about=s.data.about||s.data.description||""):v.fullName&&(l.name=v.fullName)}catch(s){console.error("Error loading profile:",s);const c=((r=(u=s.response)==null?void 0:u.data)==null?void 0:r.detail)||s.message||"";d.notify({type:"negative",message:"Error al cargar el perfil: "+c})}finally{m.value=!1}},L=async()=>{var u,r,s;if(!((u=l.name)!=null&&u.trim())){d.notify({type:"negative",message:"El nombre es requerido"});return}p.value=!0;try{await la({name:l.name,logo_url:l.logo_url||null,countries:l.countries.length>0?l.countries:[],states:l.states.length>0?l.states:[],address:l.address||null,contact_email:l.contact_email||null,website:l.website||null,about:l.about||null}),d.notify({type:"positive",message:"Perfil guardado"})}catch(c){d.notify({type:"negative",message:((s=(r=c.response)==null?void 0:r.data)==null?void 0:s.detail)||"Error al guardar"})}finally{p.value=!1}};return F(q),{fileInput:a,loading:m,saving:p,form:l,countryOptions:k,stateOptions:h,goToDashboard:x,goBack:e,triggerFileUpload:Q,handleLogoUpload:B,onCountriesChange:T,saveProfile:L}}},da={class:"header-content"},ua={class:"greeting"},ma={class:"header-icons"},ca={class:"row items-center q-gutter-sm"},fa=["src"],pa={class:"row q-gutter-sm"};function ga(d,o,v,a,m,p){const l=_("NotificationBell"),k=_("AssociationTopMenu"),h=_("BannerPromoScrolling"),x=_("AssociationNavigationMenu");return g(),b(K,{view:"hHh lpR fFf",class:"text-white"},{default:i(()=>[t(O,{elevated:"",class:"text-white"},{default:i(()=>[n("div",da,[n("div",ua,[n("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:o[0]||(o[0]=(...e)=>a.goToDashboard&&a.goToDashboard(...e))}),o[10]||(o[10]=n("span",{class:"text-subtitle1"},"Perfil",-1))]),n("div",ma,[t(l),t(k)])]),t(h)]),_:1}),t(Z,null,{default:i(()=>[t(J,{class:"q-pa-md"},{default:i(()=>[a.loading?(g(),b(C,{key:0,flat:"",bordered:"",class:"bg-transparent text-white"},{default:i(()=>[t(f,{class:"text-center"},{default:i(()=>[t(G,{color:"primary",size:"40px"})]),_:1})]),_:1})):(g(),b(Y,{key:1,onSubmit:H(a.saveProfile,["prevent"]),class:"q-gutter-md"},{default:i(()=>[t(C,{flat:"",bordered:"",class:"q-mb-md bg-grey-9 text-white"},{default:i(()=>[t(f,null,{default:i(()=>[...o[11]||(o[11]=[n("div",{class:"text-h6"},"Informaci\xF3n b\xE1sica",-1)])]),_:1}),t(f,{class:"q-gutter-md"},{default:i(()=>[t(y,{modelValue:a.form.name,"onUpdate:modelValue":o[1]||(o[1]=e=>a.form.name=e),label:"Nombre de la asociaci\xF3n",outlined:"",dark:"",dense:"",rules:[e=>!!e||"Requerido"]},null,8,["modelValue","rules"]),n("div",null,[o[12]||(o[12]=n("label",{class:"text-caption text-grey q-mb-xs block"},"Logo",-1)),n("div",ca,[a.form.logo_url?(g(),b(W,{key:0,size:"80px"},{default:i(()=>[n("img",{src:a.form.logo_url},null,8,fa)]),_:1})):M("",!0),t(w,{flat:"",dense:"",icon:"o_photo_camera",label:"Subir logo",onClick:a.triggerFileUpload,color:"primary"},null,8,["onClick"]),n("input",{ref:"fileInput",type:"file",accept:"image/*",style:{display:"none"},onChange:o[2]||(o[2]=(...e)=>a.handleLogoUpload&&a.handleLogoUpload(...e))},null,544),a.form.logo_url?(g(),b(w,{key:1,flat:"",dense:"",icon:"delete",color:"negative",onClick:o[3]||(o[3]=e=>a.form.logo_url="")})):M("",!0)])]),t(y,{modelValue:a.form.about,"onUpdate:modelValue":o[4]||(o[4]=e=>a.form.about=e),label:"Descripci\xF3n / Sobre la asociaci\xF3n",type:"textarea",outlined:"",dark:"",dense:"",rows:"4",hint:"Informaci\xF3n que ver\xE1n los jugadores sobre tu asociaci\xF3n"},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{flat:"",bordered:"",class:"q-mb-md bg-grey-9 text-white"},{default:i(()=>[t(f,null,{default:i(()=>[...o[13]||(o[13]=[n("div",{class:"text-h6"},"Ubicaci\xF3n",-1)])]),_:1}),t(f,{class:"q-gutter-md"},{default:i(()=>[t(E,{modelValue:a.form.countries,"onUpdate:modelValue":[o[5]||(o[5]=e=>a.form.countries=e),a.onCountriesChange],options:a.countryOptions,label:"Pa\xEDses",outlined:"",dark:"",dense:"",multiple:"","emit-value":"","map-options":"","use-chips":""},null,8,["modelValue","options","onUpdate:modelValue"]),t(E,{modelValue:a.form.states,"onUpdate:modelValue":o[6]||(o[6]=e=>a.form.states=e),options:a.stateOptions,label:"Estados",outlined:"",dark:"",dense:"",multiple:"","emit-value":"","map-options":"","use-chips":"",disable:!a.form.countries||a.form.countries.length===0,hint:"Selecciona primero los pa\xEDses"},null,8,["modelValue","options","disable"]),t(y,{modelValue:a.form.address,"onUpdate:modelValue":o[7]||(o[7]=e=>a.form.address=e),label:"Direcci\xF3n",outlined:"",dark:"",dense:"",type:"textarea",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{flat:"",bordered:"",class:"q-mb-md bg-grey-9 text-white"},{default:i(()=>[t(f,null,{default:i(()=>[...o[14]||(o[14]=[n("div",{class:"text-h6"},"Contacto",-1)])]),_:1}),t(f,{class:"q-gutter-md"},{default:i(()=>[t(y,{modelValue:a.form.contact_email,"onUpdate:modelValue":o[8]||(o[8]=e=>a.form.contact_email=e),label:"Email de contacto",type:"email",outlined:"",dark:"",dense:"",rules:[e=>!e||/.+@.+\..+/.test(e)||"Email inv\xE1lido"]},null,8,["modelValue","rules"]),t(y,{modelValue:a.form.website,"onUpdate:modelValue":o[9]||(o[9]=e=>a.form.website=e),label:"P\xE1gina web",outlined:"",dark:"",dense:"",hint:"Ej: https://www.miasociacion.com",rules:[e=>!e||/^https?:\/\/.+/.test(e)||"URL inv\xE1lida (debe empezar con http:// o https://)"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),n("div",pa,[t(w,{type:"submit",label:"Guardar perfil",color:"primary","text-color":"black",loading:a.saving,class:"col"},null,8,["loading"]),t(w,{flat:"",label:"Cancelar",onClick:a.goBack,class:"col"},null,8,["onClick"])])]),_:1},8,["onSubmit"]))]),_:1})]),_:1}),t(x)]),_:1})}var Ha=sa(na,[["render",ga],["__scopeId","data-v-312ec016"]]);export{Ha as default};
