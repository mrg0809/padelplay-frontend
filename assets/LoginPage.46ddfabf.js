import{r,F as C,q as i,G as v,H as g,v as s,I as c,J as t,s as f,y as u,K as _,x as I}from"./index.71d630fb.js";import{Q as L}from"./QForm.fb7585d9.js";import{Q as x}from"./QPage.ce9abbf4.js";import{Q as T,a as S}from"./QLayout.c08f0fa0.js";import{a as A}from"./api.f1a1189d.js";import{u as P}from"./userStore.0094877c.js";import{o as k}from"./auth.7e9c5332.js";import{_ as Q}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.014ff78d.js";import"./supabase.60a2aacd.js";const V={name:"LoginPage",setup(){const p=r(""),a=r(""),n=r(null),o=r(!1),d=r(!1),b=r(!1),e=C(),y=P();return{email:p,password:a,error:n,googleLoading:o,appleLoading:d,showTraditionalLogin:b,login:async()=>{n.value=null;try{const l=await A.post("/auth/login",{email:p.value,password:a.value}),{access_token:m}=l.data;localStorage.setItem("token",m);const w=m.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),h=JSON.parse(atob(w));y.setUserDataFromToken(m),h.user_type==="superuser"?e.push("/dashboard/superuser"):h.user_type==="admin"?e.push("/dashboard/admin"):h.user_type==="club"?e.push("/dashboard/club"):e.push("/dashboard/player")}catch(l){l.response&&l.response.data&&l.response.data.detail?n.value=l.response.data.detail:n.value="Ocurri\xF3 un error inesperado. Intenta de nuevo m\xE1s tarde.",console.error("Error al iniciar sesi\xF3n:",l)}},signInWithGoogle:async()=>{o.value=!0,n.value=null;try{await k.signInWithGoogle()}catch(l){n.value="Error al iniciar sesi\xF3n con Google",console.error("Google OAuth error:",l)}finally{o.value=!1}},signInWithApple:async()=>{d.value=!0,n.value=null;try{await k.signInWithApple()}catch(l){n.value="Apple OAuth no est\xE1 disponible a\xFAn. Pronto estar\xE1 habilitado.",console.error("Apple OAuth error:",l)}finally{d.value=!1}},goToSignup:()=>{e.push("/signup")},goToForgotPassword:()=>{e.push("/forgot-password")}}}},G={class:"login-container"},W={class:"oauth-buttons"},F={key:0,class:"traditional-login-toggle"},O={key:1,class:"divider"},U={key:0,class:"error-message"},B={class:"login-links"};function N(p,a,n,o,d,b){return i(),v(T,{view:"lHh Lpr lFf"},{default:g(()=>[s(S,null,{default:g(()=>[s(x,{class:"login-page"},{default:g(()=>[c("div",G,[a[4]||(a[4]=c("img",{src:"/src/assets/logo.jpeg",alt:"Logo",class:"login-logo"},null,-1)),c("div",W,[s(t,{onClick:o.signInWithGoogle,loading:o.googleLoading,class:"google-btn",icon:"img:/src/assets/google-icon.svg",label:"Continuar con Google",color:"white","text-color":"black","no-caps":"",style:{"margin-bottom":"12px"}},null,8,["onClick","loading"]),s(t,{onClick:o.signInWithApple,loading:o.appleLoading,class:"apple-btn",icon:"img:/src/assets/apple-icon.svg",label:"Continuar con Apple",color:"dark","text-color":"white","no-caps":"",style:{"margin-bottom":"20px"}},null,8,["onClick","loading"])]),o.showTraditionalLogin?u("",!0):(i(),f("div",F,[s(t,{flat:"",label:"Ingresar con email y contrase\xF1a",color:"white",class:"toggle-link",onClick:a[0]||(a[0]=e=>o.showTraditionalLogin=!0),"no-caps":""})])),o.showTraditionalLogin?(i(),f("div",O,a[3]||(a[3]=[c("span",{class:"divider-text"},"o",-1)]))):u("",!0),o.showTraditionalLogin?(i(),v(L,{key:2,onSubmit:o.login,class:"login-form"},{default:g(()=>[s(_,{outlined:"",dark:"",modelValue:o.email,"onUpdate:modelValue":a[1]||(a[1]=e=>o.email=e),label:"Correo electr\xF3nico",type:"email",class:"q-mb-md input-dark"},null,8,["modelValue"]),s(_,{outlined:"",dark:"",modelValue:o.password,"onUpdate:modelValue":a[2]||(a[2]=e=>o.password=e),label:"Contrase\xF1a",type:"password",class:"q-mb-md input-dark"},null,8,["modelValue"]),s(t,{label:"Iniciar sesi\xF3n",color:"white","text-color":"black",type:"submit",class:"login-btn"}),o.error?(i(),f("div",U,I(o.error),1)):u("",!0)]),_:1},8,["onSubmit"])):u("",!0),c("div",B,[s(t,{flat:"",label:"Crear una cuenta",color:"white",class:"login-link",onClick:o.goToSignup},null,8,["onClick"]),s(t,{flat:"",label:"Olvid\xE9 mi contrase\xF1a",color:"white",class:"login-link",onClick:o.goToForgotPassword},null,8,["onClick"])])])]),_:1})]),_:1})]),_:1})}var eo=Q(V,[["render",N],["__scopeId","data-v-03059aba"]]);export{eo as default};
