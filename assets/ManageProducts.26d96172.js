import{aa as w,q as d,G as p,H as l,v as o,I as s,ad as h,J as n,ab as g,ac as u,s as f,Q as v,ag as _,aj as C,K as c,ah as k,ai as Q}from"./index.813f732c.js";import{Q as V}from"./QHeader.16359345.js";import{Q as x}from"./QTd.9db919c1.js";import{Q as q}from"./QTable.7edcd734.js";import{Q as D}from"./QSelect.9dde8fac.js";import{Q as N}from"./QPage.f2a762bd.js";import{Q as E,a as M}from"./QLayout.3fe3ded4.js";import{C as T}from"./ClosePopup.b5bcb2ae.js";import{u as U}from"./userStore.528cc103.js";import{n as B}from"./navigationUtils.2c4b9dee.js";import{C as S}from"./ClubNavigationMenu.e1c6e6e0.js";import{g as b,a as y}from"./api.e96a150b.js";import{s as I}from"./supabase.e5048c08.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import"./QList.e999ac61.js";import"./QMarkupTable.aa6b72e3.js";import"./use-fullscreen.eb43f0e3.js";import"./QChip.bed768cd.js";import"./QItem.01a0916f.js";import"./QItemLabel.b765193d.js";import"./QMenu.029043d4.js";import"./position-engine.f10226bc.js";import"./selection.7c5ca85a.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./pinia.24da212c.js";import"./QTabs.d300a253.js";import"./QFooter.44b747ac.js";import"./index.c98ef0da.js";const z={data(){return{loading:!1,isProductDialogOpen:!1,products:[],newProduct:{name:"",brand:"",category:"",price:0,modality:"venta"},columns:[{name:"name",label:"Nombre",field:"name",align:"left"},{name:"brand",label:"Marca",field:"brand",align:"left"},{name:"category",label:"Categor\xEDa",field:"category",align:"left"},{name:"price",label:"Precio",field:"price",align:"left"},{name:"modality",label:"Modalidad",field:"modality",align:"left"},{name:"actions",label:"Acciones",field:"actions",align:"center"}]}},components:{ClubNavigationMenu:S},setup(){return{userStore:U()}},methods:{async fetchProducts(){this.loading=!0;try{const r=b();if(!r||!r.club_id)throw new Error("No se pudo obtener el club_id del usuario.");const{data:e,error:m}=await I.from("club_products").select("*").eq("club_id",r.club_id);if(m)throw m;this.products=e}catch(r){console.error("Error al obtener los productos:",r),this.$q.notify({type:"negative",message:"Error al cargar los productos"})}finally{this.loading=!1}},openProductDialog(){this.isProductDialogOpen=!0},async saveProduct(){try{const r=b();if(!r||!r.club_id)throw new Error("No se pudo obtener el club_id del usuario.");const e={...this.newProduct,club_id:r.club_id};await y.post("/products",e),this.isProductDialogOpen=!1,await this.fetchProducts(),this.$q.notify({type:"positive",message:"Producto agregado exitosamente."})}catch(r){console.error("Error al guardar el producto:",r),this.$q.notify({type:"negative",message:"Error al guardar el producto. Intenta nuevamente."})}},async deleteProduct(r){try{await y.delete(`/products/${r}`),await this.fetchProducts(),this.$q.notify({type:"positive",message:"Producto eliminado exitosamente."})}catch(e){console.error("Error al eliminar el producto:",e),this.$q.notify({type:"negative",message:"Error al eliminar el producto. Intenta nuevamente."})}},goBack(){this.$router.back()},goToDashboard(){B(this.$router,this.userStore)}},mounted(){this.fetchProducts()}},A={class:"header-content"},F={class:"greeting"},G={class:"header-icons"},H={key:0,class:"text-center q-pa-md"},L={key:1,class:"text-center q-pa-md"};function R(r,e,m,j,t,i){const P=w("ClubNavigationMenu");return d(),p(E,{view:"hHh lpR fFf",class:"body text-black"},{default:l(()=>[o(V,{elevated:"",class:"bg-primary text-white"},{default:l(()=>[s("div",A,[s("div",F,[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...a)=>i.goToDashboard&&i.goToDashboard(...a))}),e[7]||(e[7]=h(" Gesti\xF3n de Productos "))]),s("div",G,[o(n,{flat:"",round:"",icon:"close",onClick:i.goBack},null,8,["onClick"])])])]),_:1}),o(M,null,{default:l(()=>[o(N,{class:"q-pa-md"},{default:l(()=>[o(g,{class:"transparent-card q-mb-md"},{default:l(()=>[o(u,null,{default:l(()=>e[8]||(e[8]=[s("div",{class:"text-h6"},"Lista de Productos",-1)])),_:1}),o(u,null,{default:l(()=>[t.loading?(d(),f("div",H,[o(v,{color:"primary",size:"xl"}),e[9]||(e[9]=s("p",{class:"q-mt-sm"},"Cargando productos...",-1))])):t.products.length===0?(d(),f("div",L,[o(_,{name:"o_shopping_cart",size:"2em"}),e[10]||(e[10]=s("p",{class:"q-mt-sm"},"No hay productos registrados.",-1))])):(d(),p(q,{key:2,rows:t.products,columns:t.columns,"row-key":"id",flat:"",bordered:"",class:"transparent-table"},{"body-cell-actions":l(a=>[o(x,{props:a},{default:l(()=>[o(n,{flat:"",round:"",color:"negative",icon:"delete",onClick:J=>i.deleteProduct(a.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]))]),_:1})]),_:1}),o(n,{glossy:"",round:"",size:"lg",color:"black",icon:"add",class:"fixed-bottom-right q-mb-xl",onClick:i.openProductDialog},null,8,["onClick"]),o(C,{modelValue:t.isProductDialogOpen,"onUpdate:modelValue":e[6]||(e[6]=a=>t.isProductDialogOpen=a)},{default:l(()=>[o(g,{class:"bg-black text-white",style:{"min-width":"400px"}},{default:l(()=>[o(u,null,{default:l(()=>e[11]||(e[11]=[s("div",{class:"text-h6"},"Agregar Producto",-1)])),_:1}),o(u,null,{default:l(()=>[o(c,{modelValue:t.newProduct.name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.newProduct.name=a),label:"Nombre",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.brand,"onUpdate:modelValue":e[2]||(e[2]=a=>t.newProduct.brand=a),label:"Marca",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.category,"onUpdate:modelValue":e[3]||(e[3]=a=>t.newProduct.category=a),label:"Familia/Categor\xEDa",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(c,{modelValue:t.newProduct.price,"onUpdate:modelValue":e[4]||(e[4]=a=>t.newProduct.price=a),label:"Precio",type:"number",outlined:"",dense:"",color:"white"},null,8,["modelValue"]),o(D,{modelValue:t.newProduct.modality,"onUpdate:modelValue":e[5]||(e[5]=a=>t.newProduct.modality=a),options:[{label:"Venta",value:"sale"},{label:"Renta",value:"rental"}],label:"Modalidad",outlined:"",dense:"",color:"white","emit-value":"","map-options":""},null,8,["modelValue"])]),_:1}),o(k,{align:"right"},{default:l(()=>[Q(o(n,{flat:"",label:"Cancelar",color:"primary"},null,512),[[T]]),o(n,{flat:"",label:"Guardar",color:"secondary",onClick:i.saveProduct},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(P)]),_:1})}var Ce=O(z,[["render",R],["__scopeId","data-v-43a56a8c"]]);export{Ce as default};
