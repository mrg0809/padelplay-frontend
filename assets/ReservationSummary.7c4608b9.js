import{Q as R}from"./QHeader.c54c4dab.js";import{a7 as H,F as U,r as u,j as D,B as h,a8 as N,q as f,G as E,H as r,v as t,I as l,a9 as V,aa as g,ab as s,x as n,s as b,ac as F,ad as O,ae as J,aK as G,aL as K,af as I,J as P,ag as j,ah as z,K as W}from"./index.743d29a7.js";import{Q as X}from"./QTooltip.eec396fd.js";import{Q as Y}from"./QPage.399b9a9b.js";import{Q as Z,a as $}from"./QLayout.166d0f49.js";import{Q as aa}from"./QItemLabel.7f11a839.js";import{Q as ea,a as w}from"./QItem.bb9945a3.js";import{C as ta}from"./ClosePopup.951eef86.js";import{u as oa}from"./use-quasar.cb0f3cc7.js";import{g as la}from"./products.35a44c50.js";import{a as ra}from"./api.2af71db3.js";import{P as na}from"./PlayerNavigationMenu.8bca405a.js";import{D as ia}from"./DesktopNavigation.f275b32b.js";import{_ as sa}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.bd78d608.js";import"./selection.93b2e93c.js";import"./supabase.846d8680.js";import"./QTabs.243f63db.js";import"./rtl.276c3f1b.js";import"./QFooter.962d26d2.js";const ua={components:{PlayerNavigationMenu:na,DesktopNavigation:ia},setup(){const d=H(),a=U(),x=oa(),e=u({clubId:d.query.clubId||"",clubName:d.query.clubName||"Club no especificado",courtId:d.query.courtId||"",courtName:d.query.courtName||"Cancha no especificada",date:d.query.date||"Fecha no especificada",time:d.query.time||"Hora no especificada",duration:d.query.duration||0,price:parseFloat(d.query.price)||0}),_=u(4),Q=u(e.value.price+_.value*e.value.price/100),c=u(),p=u({}),o=u([]),v=u(!1),k=u(!1),y=u("partial"),T=u([{label:"Pagar mi parte",value:"partial"},{label:"Pagar el total",value:"total"}]),B=D(()=>`Continuar al pago de $${y.value==="total"?m.value.toFixed(2):(m.value/4).toFixed(2)}`),q=D(()=>o.value&&Array.isArray(o.value)?o.value.reduce((i,C)=>i+C.product.price*C.quantity,0):0),m=D(()=>Q.value+q.value),S=()=>{v.value=!0},M=()=>{o.value=c.value.filter(i=>p.value[i.id]>0).map(i=>({product:i,quantity:p.value[i.id]})),v.value=!1},L=async()=>{try{const i=y.value==="total"?m.value:m.value/4,A=(await ra.post("payments/payment_order_and_split_payment",{total_price:m.value,pay_total:y.value==="total"})).data.payment_order_id;a.push({name:"StripePayment",query:{reservationDetails:JSON.stringify({...e.value,payment_order_id:A}),total:m.value,paymentOption:y.value,selectedProducts:JSON.stringify(o.value),isPublicMatch:k.value,amountToPay:i}})}catch(i){console.error("Error al obtener payment_order:",i),x.notify({type:"negative",message:"Error al generar orden de pago. Por favor intente de nuevo."})}};return h(async()=>{c.value=await la(e.value.clubId),c.value.forEach(i=>p.value[i.id]=0)}),{reservationDetails:e,commission:_,subtotal:Q,products:c,productQuantities:p,selectedProducts:o,productDialog:v,isPublicMatch:k,paymentOption:y,paymentOptions:T,total:m,showProductDialog:S,addProductToOrder:M,goToPayment:L,productTotal:q,paymentButtonLabel:B}}},da={class:"q-ml-lg"};function ma(d,a,x,e,_,Q){const c=N("DesktopNavigation"),p=N("PlayerNavigationMenu");return f(),E(Z,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:r(()=>[t(R,{elevated:"",class:"text-white"},{default:r(()=>a[3]||(a[3]=[l("div",{class:"header-content"},[l("div",{class:"greeting"},[l("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})]),l("div",{class:"header-icons"})],-1)])),_:1}),t(c),t($,null,{default:r(()=>[t(Y,{class:"q-pa-md"},{default:r(()=>[t(V,{class:"text-white"},{default:r(()=>[t(g,null,{default:r(()=>a[4]||(a[4]=[l("h3",{class:"text-white"},"Reserva:",-1)])),_:1}),t(g,null,{default:r(()=>[l("p",null,[a[5]||(a[5]=l("strong",null,"Club:",-1)),s(" "+n(e.reservationDetails.clubName),1)]),l("p",null,[a[6]||(a[6]=l("strong",null,"Cancha:",-1)),s(" "+n(e.reservationDetails.courtName),1)]),l("p",null,[a[7]||(a[7]=l("strong",null,"Fecha:",-1)),s(" "+n(e.reservationDetails.date),1)]),l("p",null,[a[8]||(a[8]=l("strong",null,"Horario:",-1)),s(" "+n(e.reservationDetails.time)+" hrs.",1)]),l("p",null,[a[9]||(a[9]=l("strong",null,"Duraci\xF3n:",-1)),s(" "+n(e.reservationDetails.duration)+" minutos",1)]),l("p",null,[a[10]||(a[10]=l("strong",null,"Precio:",-1)),s(" $"+n(e.reservationDetails.price.toFixed(2)),1)]),l("p",null,[a[11]||(a[11]=l("strong",null,"Subtotal:",-1)),s(" $"+n(e.subtotal.toFixed(2)),1)]),l("p",null,[a[12]||(a[12]=l("strong",null,"Adicionales:",-1)),s(" $"+n(e.productTotal),1)]),l("ul",da,[(f(!0),b(O,null,F(e.selectedProducts,o=>(f(),b("li",{key:o.product.id},n(o.product.name)+" x "+n(o.quantity)+" - $"+n((o.product.price*o.quantity).toFixed(2)),1))),128))]),l("p",null,[a[14]||(a[14]=l("strong",null,"Total a pagar:",-1)),s(" $"+n(e.total.toFixed(2))+" ",1),t(J,{name:"o_info",size:"xs",class:"cursor-help"},{default:r(()=>[t(X,{anchor:"top middle",self:"bottom middle",offset:[0,10]},{default:r(()=>a[13]||(a[13]=[s(" Precio total con impuestos y comisiones incluidas ")])),_:1})]),_:1})])]),_:1}),t(g,null,{default:r(()=>[t(G,{modelValue:e.isPublicMatch,"onUpdate:modelValue":a[0]||(a[0]=o=>e.isPublicMatch=o),"checked-icon":"check",color:"green",label:"Partido P\xFAblico"},null,8,["modelValue"]),t(K,{modelValue:e.paymentOption,"onUpdate:modelValue":a[1]||(a[1]=o=>e.paymentOption=o),color:"green",options:e.paymentOptions},null,8,["modelValue","options"])]),_:1}),t(I,{align:"right"},{default:r(()=>[t(P,{label:"Agregar Productos",color:"primary",onClick:e.showProductDialog},null,8,["onClick"]),t(P,{label:e.paymentButtonLabel,color:"green",onClick:e.goToPayment},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),t(z,{modelValue:e.productDialog,"onUpdate:modelValue":a[2]||(a[2]=o=>e.productDialog=o)},{default:r(()=>[t(V,null,{default:r(()=>[t(g,null,{default:r(()=>[(f(!0),b(O,null,F(e.products,o=>(f(),b("div",{key:o.id,class:"q-mb-md"},[t(ea,null,{default:r(()=>[t(w,null,{default:r(()=>[t(aa,null,{default:r(()=>[s(n(o.name)+" - $"+n(o.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(w,{side:""},{default:r(()=>[t(W,{modelValue:e.productQuantities[o.id],"onUpdate:modelValue":v=>e.productQuantities[o.id]=v,type:"number",min:"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),t(I,{align:"right"},{default:r(()=>[t(P,{label:"Aceptar",color:"primary",onClick:e.addProductToOrder},null,8,["onClick"]),j(t(P,{label:"Cancelar",color:"grey-dark"},null,512),[[ta]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(p)]),_:1})}var wa=sa(ua,[["render",ma],["__scopeId","data-v-5c64f69c"]]);export{wa as default};
