import{k as z,au as U,aw as F,r as j,j as I,b4 as X,X as V,p as C,C as H,ai as G,E as O,q as h,G as S,H as s,v as r,I as p,J as M,ab as J,ac as W,s as $,ag as D,bS as Y,ae as K,af as Z,ad as q,x as R,aW as ee,y as te}from"./index.188957e1.js";import{Q as ie}from"./QHeader.bad00686.js";import{Q as oe}from"./QSpinnerDots.39d2155b.js";import{Q as ae,a as T}from"./QItem.11f55c39.js";import{Q as B}from"./QItemLabel.c3c7305b.js";import{T as re}from"./TouchPan.51fea658.js";import{u as se}from"./use-render-cache.3aae9b27.js";import{Q as ne}from"./QList.7c68295a.js";import{Q as le}from"./QPage.d6b4f804.js";import{Q as ce,a as de}from"./QLayout.841981cf.js";import{a as k}from"./api.2af71db3.js";import{u as fe}from"./userStore.551ce0f9.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./touch.9135741d.js";import"./selection.b10b4da7.js";import"./pinia.db3bcbf1.js";const N=[["left","center","start","width"],["right","center","end","width"],["top","start","center","height"],["bottom","end","center","height"]];var me=z({name:"QSlideItem",props:{...U,leftColor:String,rightColor:String,topColor:String,bottomColor:String,onSlide:Function},emits:["action","top","right","bottom","left"],setup(t,{slots:e,emit:g}){const{proxy:Q}=O(),{$q:y}=Q,u=F(t,y),{getCache:n}=se(),m=j(null);let _=null,o={},x={},w={};const v=I(()=>y.lang.rtl===!0?{left:"right",right:"left"}:{left:"left",right:"right"}),A=I(()=>"q-slide-item q-item-type overflow-hidden"+(u.value===!0?" q-slide-item--dark q-dark":""));function L(){m.value.style.transform="translate(0,0)"}function E(i,f,l){t.onSlide!==void 0&&g("slide",{side:i,ratio:f,isReset:l})}function P(i){const f=m.value;if(i.isFirst)o={dir:null,size:{left:0,right:0,top:0,bottom:0},scale:0},f.classList.add("no-transition"),N.forEach(a=>{if(e[a[0]]!==void 0){const b=w[a[0]];b.style.transform="scale(1)",o.size[a[0]]=b.getBoundingClientRect()[a[3]]}}),o.axis=i.direction==="up"||i.direction==="down"?"Y":"X";else if(i.isFinal){f.classList.remove("no-transition"),o.scale===1?(f.style.transform=`translate${o.axis}(${o.dir*100}%)`,_!==null&&clearTimeout(_),_=setTimeout(()=>{_=null,g(o.showing,{reset:L}),g("action",{side:o.showing,reset:L})},230)):(f.style.transform="translate(0,0)",E(o.showing,0,!0));return}else i.direction=o.axis==="X"?i.offset.x<0?"left":"right":i.offset.y<0?"up":"down";if(e.left===void 0&&i.direction===v.value.right||e.right===void 0&&i.direction===v.value.left||e.top===void 0&&i.direction==="down"||e.bottom===void 0&&i.direction==="up"){f.style.transform="translate(0,0)";return}let l,d,c;o.axis==="X"?(d=i.direction==="left"?-1:1,l=d===1?v.value.left:v.value.right,c=i.distance.x):(d=i.direction==="up"?-2:2,l=d===2?"top":"bottom",c=i.distance.y),!(o.dir!==null&&Math.abs(d)!==Math.abs(o.dir))&&(o.dir!==d&&(["left","right","top","bottom"].forEach(a=>{x[a]&&(x[a].style.visibility=l===a?"visible":"hidden")}),o.showing=l,o.dir=d),o.scale=Math.max(0,Math.min(1,(c-40)/o.size[l])),f.style.transform=`translate${o.axis}(${c*d/Math.abs(d)}px)`,w[l].style.transform=`scale(${o.scale})`,E(l,o.scale,!1))}return X(()=>{x={},w={}}),V(()=>{_!==null&&clearTimeout(_)}),Object.assign(Q,{reset:L}),()=>{const i=[],f={left:e[v.value.right]!==void 0,right:e[v.value.left]!==void 0,up:e.bottom!==void 0,down:e.top!==void 0},l=Object.keys(f).filter(c=>f[c]===!0);N.forEach(c=>{const a=c[0];e[a]!==void 0&&i.push(C("div",{key:a,ref:b=>{x[a]=b},class:`q-slide-item__${a} absolute-full row no-wrap items-${c[1]} justify-${c[2]}`+(t[a+"Color"]!==void 0?` bg-${t[a+"Color"]}`:"")},[C("div",{ref:b=>{w[a]=b}},e[a]())]))});const d=C("div",{key:`${l.length===0?"only-":""} content`,ref:m,class:"q-slide-item__content"},H(e.default));return l.length===0?i.push(d):i.push(G(d,n("dir#"+l.join(""),()=>{const c={prevent:!0,stop:!0,mouse:!0};return l.forEach(a=>{c[a]=!0}),[[re,P,void 0,c]]}))),C("div",{class:A.value},i)}}});const he={data(){return{notifications:[],loading:!1}},setup(){return{userStore:fe()}},async mounted(){await this.fetchNotifications()},methods:{async fetchNotifications(){this.loading=!0;try{const e=(await k.get("/notifications/")).data;e&&Array.isArray(e.data)&&e.data.length>0?this.notifications=e.data:this.notifications=[]}catch(t){console.error("Error fetching notifications:",t),t.message&&t.message.includes("Mixed Content")&&console.error("Mixed Content Error detected in notifications. API Base URL:",k.defaults.baseURL),console.log("Current API configuration:",{baseURL:k.defaults.baseURL,hostname:window.location.hostname,protocol:window.location.protocol}),this.notifications=[],this.$q.notify({type:"negative",message:"Error al cargar las notificaciones. Por favor intenta m\xE1s tarde.",timeout:3e3})}finally{this.loading=!1}},async markAsRead(t,e){try{await k.put(`/notifications/${t}/read`),e?this.$router.push(e):this.fetchNotifications()}catch(g){console.error("Error marking notification as read:",g)}},async deleteNotification(t){try{await k.delete(`/notifications/${t}`),this.fetchNotifications()}catch(e){console.error("Error deleting notification:",e)}},onSlideLeft(t){this.deleteNotification(t)},formatDate(t){if(!t)return"Fecha desconocida";const e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(t).toLocaleDateString("es-MX",e)},goBack(){this.$router.back()},goToDashboard(){const t=this.userStore.userType;t==="player"?this.$router.push("/dashboard/player"):t==="club"?this.$router.push("/dashboard/club"):t==="admin"?this.$router.push("/dashboard/admin"):this.$router.back()}}},pe={class:"header-content"},ge={class:"greeting"},ye={class:"header-icons"},_e={key:0,class:"text-center q-pa-xl"},ve={key:1,class:"text-center q-my-md"};function be(t,e,g,Q,y,u){return h(),S(ce,{view:"hHh lpR fFf",class:"text-white"},{default:s(()=>[r(ie,{elevated:"",class:"bg-primary text-white"},{default:s(()=>[p("div",pe,[p("div",ge,[p("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...n)=>u.goToDashboard&&u.goToDashboard(...n))})]),p("div",ye,[r(M,{flat:"",round:"",icon:"close",onClick:u.goBack},null,8,["onClick"])])])]),_:1}),r(de,null,{default:s(()=>[r(le,{class:"q-pa-md"},{default:s(()=>[r(J,{flat:"",bordered:"",class:"text-black"},{default:s(()=>[r(W,null,{default:s(()=>e[1]||(e[1]=[p("div",{class:"text-h6 text-center text-primary"},"Notificaciones",-1)])),_:1}),y.loading?(h(),$("div",_e,[r(oe,{size:"50px",color:"primary"}),e[2]||(e[2]=p("div",{class:"q-mt-md text-grey-7"},"Cargando notificaciones...",-1))])):y.notifications.length===0?(h(),$("div",ve,[r(D,{name:"o_notifications_off",size:"64px",color:"black"}),e[3]||(e[3]=p("p",null,"No tienes notificaciones pendientes.",-1))])):(h(),S(ne,{key:2},{default:s(()=>[r(Y,{name:"notification-list",tag:"div",appear:""},{default:s(()=>[(h(!0),$(Z,null,K(y.notifications,n=>(h(),S(me,{key:n.id,onLeft:m=>u.onSlideLeft(n.id),"left-color":"grey-8",class:"notification-wrapper"},{left:s(()=>[r(D,{name:"delete"})]),default:s(()=>[r(ae,{clickable:"",class:"notification-item"},{default:s(()=>[r(T,{avatar:"",onClick:m=>u.markAsRead(n.id,n.route)},{default:s(()=>[r(D,{name:"o_notifications",size:"36px",color:"white"})]),_:2},1032,["onClick"]),r(T,{onClick:m=>u.markAsRead(n.id,n.route)},{default:s(()=>[r(B,{class:"text-bold"},{default:s(()=>[q(R(n.title),1)]),_:2},1024),r(B,{caption:""},{default:s(()=>[q(R(n.message),1)]),_:2},1024),r(B,{caption:"",class:"text-grey text-sm"},{default:s(()=>[q(R(u.formatDate(n.created_at)),1)]),_:2},1024)]),_:2},1032,["onClick"]),r(T,{side:""},{default:s(()=>[n.is_read?te("",!0):(h(),S(M,{key:0,flat:"",round:"",icon:"done",color:"primary",size:"sm",class:"q-mr-sm",onClick:ee(m=>u.markAsRead(n.id,n.route),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1032,["onLeft"]))),128))]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}var Ne=ue(he,[["render",be],["__scopeId","data-v-19cfa868"]]);export{Ne as default};
