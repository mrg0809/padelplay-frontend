import{Q as z}from"./QHeader.1a8268f2.js";import{Q as B}from"./QSpinnerDots.3816a871.js";import{a7 as U,F as q,r as p,B as E,q as t,G as m,H as r,v as u,I as a,s as i,a9 as D,aa as P,ae as A,x as l,ab as Y,y as H,bC as k,J as b,bB as J}from"./index.f4b048d5.js";import{Q as R}from"./QPage.32cdcdb3.js";import{Q as V,a as L}from"./QLayout.15cb15b1.js";import{u as O}from"./use-quasar.d3060e46.js";import{u as G}from"./userStore.67ddfc96.js";import{u as X}from"./summaryStore.8259a0b0.js";import{a as M}from"./api.2af71db3.js";import{B as K}from"./BannerPromoScrolling.786196b6.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.d89995c8.js";import"./admin.c99b9bfe.js";const Z={key:0,class:"text-center"},ee={key:1,class:"text-center"},ae={key:2},te={class:"text-center"},se={key:0},oe={key:1},le={key:2},re={class:"court-container"},ie={class:"court"},ne={class:"player team1-player1"},ce={key:0},de=["src"],ue={key:1},me={class:"text-caption"},pe={class:"player team1-player2"},_e={key:0},ve=["src"],he={key:1},ye={class:"text-caption"},fe={class:"player team2-player1"},ge={key:0},xe=["src"],ke={key:1},be={class:"text-caption"},Ce={class:"player team2-player2"},we={key:0},De=["src"],Pe={key:1},Qe={class:"text-caption"},Se={__name:"JoinMatch",setup(je){const _=U(),C=q(),f=O(),N=G(),$=X(),o=p(null),n=p([]),c=p([]),Q=p(!0),w=p(null),S=p(!1),h=p(0),j=s=>{J.locale("es-mx");const e=J(s).format("dddd, D [de] MMMM [del] YYYY"),[d,y]=e.split(" de "),v=d.charAt(0).toUpperCase()+d.slice(1),x=y.charAt(0).toUpperCase()+y.slice(1);return v+" de "+x},F=async()=>{try{const s=await M.get(`/matches/match/${_.params.matchId}`);o.value=s.data,n.value=s.data.team1_players||[],c.value=s.data.team2_players||[],s.data.reservation&&s.data.reservation.total_price&&(h.value=(s.data.reservation.total_price/4).toFixed(2))}catch(s){console.error("Error al cargar los detalles del partido:",s),w.value="No se pudo cargar la informaci\xF3n del partido. Por favor, verifica el enlace."}finally{Q.value=!1}},g=async(s,e)=>{if(!N.isAuthenticated){f.notify({type:"info",message:"Por favor inicia sesi\xF3n para unirte al juego"}),localStorage.setItem("redirectAfterLogin",_.fullPath),C.push("/");return}if((s===1?n.value:c.value)[e]){f.notify({type:"warning",message:"Este espacio ya est\xE1 ocupado"});return}S.value||h.value===0?await I(s,e):T(s,e)},I=async(s,e)=>{var d,y;try{const v={match_id:_.params.matchId,slot_index:e,team_to_join:s},x=await M.post("/matches/join",v);x.data&&x.data.message&&(f.notify({type:"positive",message:"\xA1Te has unido al partido exitosamente!"}),C.push(`/player/match/${_.params.matchId}`))}catch(v){console.error("Error al unirse al partido:",v),f.notify({type:"negative",message:((y=(d=v.response)==null?void 0:d.data)==null?void 0:y.detail)||"Error al unirse al partido"})}},T=(s,e)=>{const d={summaryTitle:"Confirmar Uni\xF3n a Juego",itemDetails:[{label:"Club",value:o.value.club_name||"No especificado"},{label:"Fecha",value:j(o.value.match_date)},{label:"Hora",value:`${o.value.match_time.slice(0,5)} hrs.`},{label:"Categor\xEDa",value:o.value.category||"N/A"},{label:"Precio (Tu parte)",value:`$${h.value}`}],baseData:{clubId:o.value.club_id,price:parseFloat(h.value),participants:1,type:"open_match_join",id:_.params.matchId},allowPaymentSplit:!1,showPublicToggle:!1,commissionRate:4,extraData:{matchId:_.params.matchId,teamToJoin:s,slotIndex:e,matchCategory:o.value.category,matchDate:o.value.match_date,matchTime:o.value.match_time,clubName:o.value.club_name}};$.setSummaryDetails(d),C.push({name:"OrderSummary"})};return E(()=>{F()}),(s,e)=>(t(),m(V,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:r(()=>[u(z,{elevated:"",class:"text-white"},{default:r(()=>[e[4]||(e[4]=a("div",{class:"header-content"},[a("div",{class:"greeting"},[a("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})])],-1)),u(K)]),_:1}),u(L,null,{default:r(()=>[u(R,{class:"q-pa-md"},{default:r(()=>[Q.value?(t(),i("div",Z,[u(B,{color:"primary",size:"xl"})])):w.value?(t(),i("div",ee,[u(D,{class:"bg-dark text-white q-pa-md"},{default:r(()=>[u(P,null,{default:r(()=>[u(A,{name:"error",size:"lg",color:"negative"}),a("h5",null,l(w.value),1)]),_:1})]),_:1})])):(t(),i("div",ae,[u(D,{class:"text-white q-pa-md match-card"},{default:r(()=>[u(P,null,{default:r(()=>[e[6]||(e[6]=a("h3",{class:"text-h5 text-white text-center"},"\xA1Te invitaron a un juego!",-1)),a("p",te," Juegas en el club "+l(o.value.club_name||"No disponible")+" el dia "+l(j(o.value.match_date))+" a las "+l(o.value.match_time.slice(0,5))+" hrs. En la cancha "+l(o.value.court_name||"No disponible")+". ",1),o.value.category?(t(),i("p",se,[Y("Categor\xEDa: "+l(o.value.category),1),e[5]||(e[5]=a("br",null,null,-1))])):H("",!0),S.value?(t(),i("p",oe,"Estado del pago: Ya pagado")):(t(),i("p",le,"Precio por jugador: $"+l(h.value)+" MXN",1))]),_:1})]),_:1}),u(D,{class:"match-card text-white q-pa-md q-mt-md"},{default:r(()=>[u(P,null,{default:r(()=>[e[11]||(e[11]=a("h3",{class:"text-center text-white"},"Jugadores",-1)),a("div",re,[a("div",ie,[a("div",ne,[n.value[0]?(t(),i("div",ce,[n.value[0].photo_url?(t(),m(k,{key:0,size:"40px"},{default:r(()=>[a("img",{src:n.value[0].photo_url,alt:"Foto del jugador"},null,8,de)]),_:1})):(t(),i("span",ue,l(n.value[0].first_name||"Jugador 1"),1)),a("div",me,l(n.value[0].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[0]||(e[0]=d=>g(1,0)),title:"Unirse a este espacio"}))]),a("div",pe,[n.value[1]?(t(),i("div",_e,[n.value[1].photo_url?(t(),m(k,{key:0,size:"40px"},{default:r(()=>[a("img",{src:n.value[1].photo_url,alt:"Foto del jugador"},null,8,ve)]),_:1})):(t(),i("span",he,l(n.value[1].first_name||"Jugador 2"),1)),a("div",ye,l(n.value[1].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[1]||(e[1]=d=>g(1,1)),title:"Unirse a este espacio"}))]),a("div",fe,[c.value[0]?(t(),i("div",ge,[c.value[0].photo_url?(t(),m(k,{key:0,size:"40px"},{default:r(()=>[a("img",{src:c.value[0].photo_url,alt:"Foto del jugador"},null,8,xe)]),_:1})):(t(),i("span",ke,l(c.value[0].first_name||"Jugador 1"),1)),a("div",be,l(c.value[0].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[2]||(e[2]=d=>g(2,0)),title:"Unirse a este espacio"}))]),a("div",Ce,[c.value[1]?(t(),i("div",we,[c.value[1].photo_url?(t(),m(k,{key:0,size:"40px"},{default:r(()=>[a("img",{src:c.value[1].photo_url,alt:"Foto del jugador"},null,8,De)]),_:1})):(t(),i("span",Pe,l(c.value[1].first_name||"Jugador 2"),1)),a("div",Qe,l(c.value[1].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[3]||(e[3]=d=>g(2,1)),title:"Unirse a este espacio"}))]),e[7]||(e[7]=a("div",{class:"line1"},null,-1)),e[8]||(e[8]=a("div",{class:"net"},null,-1)),e[9]||(e[9]=a("div",{class:"line2"},null,-1)),e[10]||(e[10]=a("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1})]))]),_:1})]),_:1})]),_:1}))}};var Ye=W(Se,[["__scopeId","data-v-9f7d556c"]]);export{Ye as default};
