import{r as i,F as C,q as c,G as k,H as d,v as e,I as t,J as r,s as v,y as u,K as b,x as T}from"./index.55545e1a.js";import{Q as I}from"./QForm.6aabb9ba.js";import{Q as L}from"./QPage.88802132.js";import{Q as P,a as x}from"./QLayout.78776d87.js";import{a as A}from"./api.92f95132.js";import{u as S}from"./userStore.f3589e21.js";import{o as y}from"./auth.9c4784f0.js";import{_ as Q}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.4a8025a3.js";import"./supabase.0d8934eb.js";const V={name:"LoginPage",setup(){const p=i(""),a=i(""),n=i(null),o=i(!1),g=i(!1),f=i(!1),l=C(),_=S();return{email:p,password:a,error:n,googleLoading:o,appleLoading:g,showTraditionalLogin:f,login:async()=>{n.value=null;try{const s=await A.post("/auth/login",{email:p.value,password:a.value}),{access_token:m}=s.data;localStorage.setItem("token",m);const w=m.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),h=JSON.parse(atob(w));_.setUserDataFromToken(m),h.user_type==="superuser"?l.push("/dashboard/superuser"):h.user_type==="admin"?l.push("/dashboard/admin"):h.user_type==="club"?l.push("/dashboard/club"):l.push("/dashboard/player")}catch(s){s.response&&s.response.data&&s.response.data.detail?n.value=s.response.data.detail:n.value="Ocurri\xF3 un error inesperado. Intenta de nuevo m\xE1s tarde.",console.error("Error al iniciar sesi\xF3n:",s)}},signInWithGoogle:async()=>{o.value=!0,n.value=null;try{await y.signInWithGoogle()}catch(s){n.value="Error al iniciar sesi\xF3n con Google",console.error("Google OAuth error:",s)}finally{o.value=!1}},signInWithApple:async()=>{g.value=!0,n.value=null;try{await y.signInWithApple()}catch(s){n.value="Apple OAuth no est\xE1 disponible a\xFAn. Pronto estar\xE1 habilitado.",console.error("Apple OAuth error:",s)}finally{g.value=!1}},goToSignup:()=>{l.push("/signup")},goToForgotPassword:()=>{l.push("/forgot-password")},goToTerms:()=>{l.push("/terms")},goToPrivacy:()=>{l.push("/privacy")}}}},G={class:"login-container"},W={class:"oauth-buttons"},F={key:0,class:"traditional-login-toggle"},O={key:1,class:"divider"},U={key:0,class:"error-message"},B={class:"login-links"},N={class:"legal-links"};function q(p,a,n,o,g,f){return c(),k(P,{view:"lHh Lpr lFf"},{default:d(()=>[e(x,null,{default:d(()=>[e(L,{class:"login-page"},{default:d(()=>[t("div",G,[a[4]||(a[4]=t("img",{src:"/logo.jpeg",alt:"Logo",class:"login-logo"},null,-1)),t("div",W,[e(r,{onClick:o.signInWithGoogle,loading:o.googleLoading,class:"google-btn",icon:"img:/google-icon.svg",label:"Continuar con Google",color:"white","text-color":"black","no-caps":"",style:{"margin-bottom":"12px"}},null,8,["onClick","loading"]),e(r,{onClick:o.signInWithApple,loading:o.appleLoading,class:"apple-btn",icon:"img:/apple-icon.svg",label:"Continuar con Apple",color:"dark","text-color":"white","no-caps":"",style:{"margin-bottom":"20px"}},null,8,["onClick","loading"])]),o.showTraditionalLogin?u("",!0):(c(),v("div",F,[e(r,{flat:"",label:"Ingresar con email y contrase\xF1a",color:"white",class:"toggle-link",onClick:a[0]||(a[0]=l=>o.showTraditionalLogin=!0),"no-caps":""})])),o.showTraditionalLogin?(c(),v("div",O,a[3]||(a[3]=[t("span",{class:"divider-text"},"o",-1)]))):u("",!0),o.showTraditionalLogin?(c(),k(I,{key:2,onSubmit:o.login,class:"login-form"},{default:d(()=>[e(b,{outlined:"",dark:"",modelValue:o.email,"onUpdate:modelValue":a[1]||(a[1]=l=>o.email=l),label:"Correo electr\xF3nico",type:"email",class:"q-mb-md input-dark"},null,8,["modelValue"]),e(b,{outlined:"",dark:"",modelValue:o.password,"onUpdate:modelValue":a[2]||(a[2]=l=>o.password=l),label:"Contrase\xF1a",type:"password",class:"q-mb-md input-dark"},null,8,["modelValue"]),e(r,{label:"Iniciar sesi\xF3n",color:"white","text-color":"black",type:"submit",class:"login-btn"}),o.error?(c(),v("div",U,T(o.error),1)):u("",!0)]),_:1},8,["onSubmit"])):u("",!0),t("div",B,[e(r,{flat:"",label:"Crear una cuenta",color:"white",class:"login-link",onClick:o.goToSignup},null,8,["onClick"]),e(r,{flat:"",label:"Olvid\xE9 mi contrase\xF1a",color:"white",class:"login-link",onClick:o.goToForgotPassword},null,8,["onClick"]),t("div",N,[e(r,{flat:"",label:"T\xE9rminos y Condiciones",color:"white",class:"legal-link",onClick:o.goToTerms},null,8,["onClick"]),e(r,{flat:"",label:"Aviso de Privacidad",color:"white",class:"legal-link",onClick:o.goToPrivacy},null,8,["onClick"])])])])]),_:1})]),_:1})]),_:1})}var no=Q(V,[["render",q],["__scopeId","data-v-a5798d8a"]]);export{no as default};
