import{Q as L}from"./QHeader.8ed599dc.js";import{a5 as A,x as E,r as d,f as D,h as H,a6 as M,o as g,z as R,A as r,d as t,B as o,a7 as N,a8 as C,a9 as i,t as n,a as v,aa as k,ab as T,ac as U,ad as F,D as y,ae as z,af as J,E as j}from"./index.44d6004f.js";import{Q as G}from"./QTooltip.c172b4a3.js";import{Q as K}from"./QPage.069cc100.js";import{Q as W,a as X}from"./QLayout.bdadfe99.js";import{Q as Y}from"./QItemLabel.30a3dfed.js";import{Q as Z,a as w}from"./QItem.cafd0d6f.js";import{C as $}from"./ClosePopup.8579e57c.js";import{u as aa}from"./use-quasar.00fa2d0c.js";import{g as ea}from"./products.286d5692.js";import{n as oa}from"./navigationUtils.2c4b9dee.js";import{a as ta}from"./api.dcb17b1f.js";import{P as la}from"./PlayerNavigationMenu.2ea5455a.js";import{_ as ra}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.d7eef48c.js";import"./selection.ab0d7921.js";import"./supabase.3e81c9a1.js";import"./QTabs.02ad9b81.js";import"./rtl.276c3f1b.js";import"./QFooter.dec25843.js";const na={components:{PlayerNavigationMenu:la},setup(){const u=A(),a=E(),x=aa(),e=d({clubId:u.query.clubId||"",clubName:u.query.clubName||"Club no especificado",coachName:u.query.coachName||"No especificado",courtId:u.query.courtId||"",courtName:u.query.courtName||"Cancha no especificada",date:u.query.date||"Fecha no especificada",people:u.query.people||0,time:u.query.time||"Hora no especificada",price:parseFloat(u.query.price)||0}),b=d(4),_=d(e.value.price+b.value*e.value.price/100),c=d(),l=d({}),m=d([]),P=d(!1),f=d("partial"),I=d([{label:"Pagar mi parte",value:"partial"},{label:"Pagar el total",value:"total"}]),S=D(()=>`Continuar al pago de $${f.value==="total"?p.value.toFixed(2):(p.value/4).toFixed(2)}`),q=D(()=>m.value&&Array.isArray(m.value)?m.value.reduce((s,Q)=>s+Q.product.price*Q.quantity,0):0),p=D(()=>_.value+q.value),V=()=>{P.value=!0},B=()=>{m.value=c.value.filter(s=>l.value[s.id]>0).map(s=>({product:s,quantity:l.value[s.id]})),P.value=!1},O=async()=>{try{const s=f.value==="total"?p.value:p.value/4,h=(await ta.post("payments/payment_order_and_split_payment",{total_price:p.value,pay_total:f.value==="total"})).data.payment_order_id;a.push({name:"StripePayment",query:{reservationDetails:JSON.stringify({...e.value,payment_order_id:h}),total:p.value,paymentOption:f.value,selectedProducts:JSON.stringify(m.value),amountToPay:s}})}catch(s){console.error("Error al obtener payment_order:",s),x.notify({type:"negative",message:"Error al generar orden de pago. Por favor intente de nuevo."})}};return H(async()=>{c.value=await ea(e.value.clubId),c.value.forEach(s=>l.value[s.id]=0)}),{reservationDetails:e,commission:b,subtotal:_,products:c,productQuantities:l,selectedProducts:m,productDialog:P,paymentOption:f,paymentOptions:I,total:p,showProductDialog:V,addProductToOrder:B,goToPayment:O,productTotal:q,paymentButtonLabel:S,goToDashboard:()=>{oa(a,userStore)}}}},sa={class:"header-content"},ia={class:"greeting"},ua={class:"q-ml-lg"};function da(u,a,x,e,b,_){const c=M("PlayerNavigationMenu");return g(),R(W,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:r(()=>[t(L,{elevated:"",class:"text-white"},{default:r(()=>[o("div",sa,[o("div",ia,[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:a[0]||(a[0]=(...l)=>e.goToDashboard&&e.goToDashboard(...l))})]),a[2]||(a[2]=o("div",{class:"header-icons"},null,-1))])]),_:1}),t(X,null,{default:r(()=>[t(K,{class:"q-pa-md"},{default:r(()=>[t(N,{class:"text-white"},{default:r(()=>[t(C,null,{default:r(()=>[...a[3]||(a[3]=[o("h3",{class:"text-white"},"Entrenamiento:",-1)])]),_:1}),t(C,null,{default:r(()=>[o("p",null,[a[4]||(a[4]=o("strong",null,"Club:",-1)),i(" "+n(e.reservationDetails.clubName),1)]),o("p",null,[a[5]||(a[5]=o("strong",null,"Coach:",-1)),i(" "+n(e.reservationDetails.coachName),1)]),o("p",null,[a[6]||(a[6]=o("strong",null,"Fecha:",-1)),i(" "+n(e.reservationDetails.date),1)]),o("p",null,[a[7]||(a[7]=o("strong",null,"Horario:",-1)),i(" "+n(e.reservationDetails.time)+" hrs.",1)]),a[14]||(a[14]=o("p",null,[o("strong",null,"Duraci\xF3n:"),i(" 60 minutos")],-1)),o("p",null,[a[8]||(a[8]=o("strong",null,"Participantes:",-1)),i(" "+n(e.reservationDetails.people),1)]),o("p",null,[a[9]||(a[9]=o("strong",null,"Precio:",-1)),i(" $"+n(e.reservationDetails.price.toFixed(2)),1)]),o("p",null,[a[10]||(a[10]=o("strong",null,"Subtotal:",-1)),i(" $"+n(e.subtotal.toFixed(2)),1)]),o("p",null,[a[11]||(a[11]=o("strong",null,"Adicionales:",-1)),i(" $"+n(e.productTotal),1)]),o("ul",ua,[(g(!0),v(T,null,k(e.selectedProducts,l=>(g(),v("li",{key:l.product.id},n(l.product.name)+" x "+n(l.quantity)+" - $"+n((l.product.price*l.quantity).toFixed(2)),1))),128))]),o("p",null,[a[13]||(a[13]=o("strong",null,"Total a pagar:",-1)),i(" $"+n(e.total.toFixed(2))+" ",1),t(U,{name:"o_info",size:"xs",class:"cursor-help"},{default:r(()=>[t(G,{anchor:"top middle",self:"bottom middle",offset:[0,10]},{default:r(()=>[...a[12]||(a[12]=[i(" Precio total con impuestos y comisiones incluidas ",-1)])]),_:1})]),_:1})])]),_:1}),t(F,{align:"right"},{default:r(()=>[t(y,{label:"Agregar Productos",color:"primary",onClick:e.showProductDialog},null,8,["onClick"]),t(y,{label:e.paymentButtonLabel,color:"green",onClick:e.goToPayment},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),t(J,{modelValue:e.productDialog,"onUpdate:modelValue":a[1]||(a[1]=l=>e.productDialog=l)},{default:r(()=>[t(N,null,{default:r(()=>[t(C,null,{default:r(()=>[(g(!0),v(T,null,k(e.products,l=>(g(),v("div",{key:l.id,class:"q-mb-md"},[t(Z,null,{default:r(()=>[t(w,null,{default:r(()=>[t(Y,null,{default:r(()=>[i(n(l.name)+" - $"+n(l.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(w,{side:""},{default:r(()=>[t(j,{modelValue:e.productQuantities[l.id],"onUpdate:modelValue":m=>e.productQuantities[l.id]=m,type:"number",min:"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),t(F,{align:"right"},{default:r(()=>[t(y,{label:"Aceptar",color:"primary",onClick:e.addProductToOrder},null,8,["onClick"]),z(t(y,{label:"Cancelar",color:"grey-dark"},null,512),[[$]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(c)]),_:1})}var Sa=ra(na,[["render",da],["__scopeId","data-v-6ccf1d60"]]);export{Sa as default};
