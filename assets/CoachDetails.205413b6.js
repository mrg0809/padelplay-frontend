import{Q as R}from"./QHeader.455f548f.js";import{a7 as F,F as z,r as S,j as L,B as j,a8 as x,q as p,G as w,H as f,v as c,I as o,a9 as J,aa as G,s as b,bC as V,x as y,J as k,ad as N,ac as q,y as P,ab as W,ae as K}from"./index.16289384.js";import{Q as U}from"./QSpinnerCube.48d50d5d.js";import{Q as X}from"./QPage.14746aa2.js";import{Q as Y,a as Z}from"./QLayout.7605203b.js";import{a as $}from"./coaches.d88de6fd.js";import{u as ee}from"./summaryStore.21cc632f.js";import{a as ae}from"./api.92f95132.js";import{N as te}from"./NotificationBell.adc6fb91.js";import{B as oe}from"./BannerPromoScrolling.4b0a7be1.js";import{P as le}from"./PlayerNavigationMenu.d9ff5082.js";import{_ as se}from"./plugin-vue_export-helper.21dcd24c.js";import"./supabase.698fbf4d.js";import"./pinia.776b36f7.js";import"./QBadge.fb3591e4.js";import"./admin.dfdc6f99.js";import"./QTabs.7e37d315.js";import"./rtl.276c3f1b.js";import"./QFooter.2de1729e.js";const re=g=>{const n={};for(const h of g){const e=h.day,u=h.start_time,v=h.end_time;if(n[e]=[],u&&v){const[l,C]=u.split(":").map(Number),[_,t]=v.split(":").map(Number);let s=l,r=C;for(;s<_||s===_&&r<t;){const d=`${String(s).padStart(2,"0")}:${String(r).padStart(2,"0")}`;n[e].push(d),r+=60,r>=60&&(s++,r-=60)}}}return n},ne=g=>{const n=[],h=new Date,e=["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"];for(let u=0;u<15;u++){const v=new Date(h);v.setDate(h.getDate()+u);const l=e[v.getDay()];g[l]&&n.push({day:l,date:v,formattedDate:`${v.getDate()}`,month:v.toLocaleString("default",{month:"short"})})}return n};const ie={components:{NotificationBell:te,BannerPromoScrolling:oe,PlayerNavigationMenu:le},setup(){const g=F(),n=z(),h=ee(),e=g.params.coachId,u=g.query.clubId,v=g.query.clubName,l=S(null),C=S({}),_=S(null),t=S([]),s=S(null),r=S(null),d=S(null),Q=L(()=>{if(!l.value)return[];const a=[];return l.value.price_for_one!=null&&a.push({people:1,price:l.value.price_for_one,label:"1"}),l.value.price_for_two!=null&&a.push({people:2,price:l.value.price_for_two,label:"2"}),l.value.price_for_three!=null&&a.push({people:3,price:l.value.price_for_three,label:"3"}),l.value.price_for_four!=null&&a.push({people:4,price:l.value.price_for_four,label:"4"}),a}),B=async()=>{l.value=null,r.value=null,_.value=null,d.value=null,s.value=null;try{const a=await $(e,u);l.value=a,a!=null&&a.availability?(C.value=re(a.availability),t.value=ne(C.value,14)):t.value=[]}catch(a){console.error("Error al cargar detalles del coach:",a)}},I=a=>{var T;const m=t.value.find(i=>i.date.getTime()===a.getTime());m&&m.date.getTime()!==((T=r.value)==null?void 0:T.date.getTime())&&(r.value=m,_.value=null,d.value=null,s.value=null,H())},O=a=>{_.value=a,d.value=null},M=a=>{d.value=a},H=async()=>{var a;if(!r.value||!u||!e){s.value=[];return}s.value=null;try{const m=await ae.get("/lessons/available-times",{params:{club_id:u,date:r.value.date.toISOString().split("T")[0],coach_id:e}});if((a=m.data)!=null&&a.available_times){const T=new Set;Object.values(m.data.available_times).forEach(i=>{Array.isArray(i)&&i.forEach(D=>T.add(D))}),s.value=Array.from(T).sort()}else s.value=[]}catch(m){console.error("Error fetching available times:",m),s.value=[]}},A=()=>{const a=l.value,m=r.value,T=_.value,i=d.value,D=u,E={summaryTitle:"Resumen de Entrenamiento",itemDetails:[{label:"Club",value:v||"No especificado"},{label:"Coach",value:(a==null?void 0:a.name)||"No especificado"},{label:"Fecha",value:(m==null?void 0:m.date.toISOString().split("T")[0])||"No especificada"},{label:"Horario",value:`${T} hrs.`||"No especificada"},{label:"Duraci\xF3n",value:"60 minutos"},{label:"Participantes",value:(i==null?void 0:i.people)||0}],baseData:{clubId:D,price:(i==null?void 0:i.price)||0,participants:(i==null?void 0:i.people)||1,type:"class",id:a==null?void 0:a.id},allowPaymentSplit:!0,showPublicToggle:!1,commissionRate:4,extraData:{coachFocus:a==null?void 0:a.coach_focus}};h.setSummaryDetails(E),n.push({name:"OrderSummary"})};return j(B),{coach:l,selectedTime:_,selectTime:O,availableDates:t,selectedDate:r,selectDay:I,availableTimes:s,priceOptions:Q,selectedPriceOption:d,selectPriceOption:M,proceedToSummary:A}}},ce={class:"header-content"},ue={class:"header-icons"},de={key:0,class:"q-pa-md q-gutter-md"},me={class:"text-center q-mb-md"},pe=["src"],ve={class:"q-mt-lg days-container"},_e={class:"days-scroll"},fe={class:"month-label"},he={key:0,class:"q-mt-md"},ge={class:"time-slots"},be={key:1,class:"q-mt-md"},ye={class:"price-options-container"},Te={class:"column text-left"},Se={class:"row items-center"},Ce={class:"text-h6"},ke={class:"text-caption text-white"},we={key:2,class:"q-mt-lg text-center"},De={key:1,class:"q-pa-md text-center"};function xe(g,n,h,e,u,v){const l=x("NotificationBell"),C=x("BannerPromoScrolling"),_=x("PlayerNavigationMenu");return p(),w(Y,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:f(()=>[c(R,{elevated:"",class:"text-white"},{default:f(()=>[o("div",ce,[n[0]||(n[0]=o("div",{class:"greeting"},[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})],-1)),o("div",ue,[c(l)])]),c(C)]),_:1}),c(Z,{class:"home"},{default:f(()=>[c(X,{class:"q-pa-md"},{default:f(()=>[c(J,null,{default:f(()=>[c(G,null,{default:f(()=>[e.coach?(p(),b("div",de,[o("div",me,[c(V,{size:"200px"},{default:f(()=>{var t;return[o("img",{src:((t=e.coach.players)==null?void 0:t.photo_url)||"default-avatar.png"},null,8,pe)]}),_:1})]),o("h3",null,y(e.coach.name),1),o("p",null,"Especialidad: "+y(e.coach.coach_focus),1),o("p",null,"Resumen: "+y(e.coach.coach_resume),1),o("div",ve,[c(k,{flat:"",round:"",icon:"arrow_back",size:"xs"}),o("div",_e,[(p(!0),b(N,null,q(e.availableDates,(t,s)=>{var r,d;return p(),w(k,{key:s,name:s,outline:((r=e.selectedDate)==null?void 0:r.date.getTime())!==t.date.getTime(),color:((d=e.selectedDate)==null?void 0:d.date.getTime())===t.date.getTime()?"green":"white",class:"day-button",onClick:Q=>e.selectDay(t.date)},{default:f(()=>[o("div",null,y(t.formattedDate),1),o("div",fe,y(t.month),1)]),_:2},1032,["name","outline","color","onClick"])}),128))]),c(k,{flat:"",round:"",icon:"arrow_forward",size:"xs"})]),e.availableTimes&&e.selectedDate?(p(),b("div",he,[n[1]||(n[1]=o("h4",null,"Horarios Disponibles:",-1)),o("div",ge,[(p(!0),b(N,null,q(e.availableTimes,t=>(p(),w(k,{key:t,onClick:s=>e.selectTime(t),color:e.selectedTime===t?"green":"white",outline:e.selectedTime!==t,class:"time-option-btn"},{default:f(()=>[W(y(t),1)]),_:2},1032,["onClick","color","outline"]))),128))])])):P("",!0),e.selectedTime&&e.priceOptions&&e.priceOptions.length>0?(p(),b("div",be,[n[2]||(n[2]=o("h4",null,"Selecciona el n\xFAmero de personas:",-1)),o("div",ye,[(p(!0),b(N,null,q(e.priceOptions,t=>{var s,r;return p(),w(k,{key:t.people,onClick:d=>e.selectPriceOption(t),color:((s=e.selectedPriceOption)==null?void 0:s.people)===t.people?"green":"secondary",outline:((r=e.selectedPriceOption)==null?void 0:r.people)!==t.people,class:"price-option-btn",padding:"sm"},{default:f(()=>[o("div",Te,[o("div",Se,[o("span",Ce,y(t.label),1),c(K,{name:"group",class:"q-mr-xs"})]),o("span",ke,"$"+y(t.price.toFixed(2)),1)])]),_:2},1032,["onClick","color","outline"])}),128))])])):P("",!0),e.selectedPriceOption?(p(),b("div",we,[c(k,{color:"green",label:"Continuar Reserva",onClick:e.proceedToSummary,class:"full-width",size:"md"},null,8,["onClick"])])):P("",!0)])):(p(),b("div",De,[c(U,{color:"orange",size:"5.5em"}),n[3]||(n[3]=o("p",{class:"q-mt-md"},"Cargando detalles del coach...",-1))]))]),_:1})]),_:1})]),_:1}),c(_)]),_:1})]),_:1})}var We=se(ie,[["render",xe],["__scopeId","data-v-613329ac"]]);export{We as default};
