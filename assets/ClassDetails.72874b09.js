import{Q as A}from"./QHeader.08eb5fd8.js";import{Q as U}from"./QSpinnerDots.de4cab18.js";import{a5 as F,x as J,y as R,r as g,f as H,h as O,o as u,z as v,A as t,d as a,B as o,bK as _,a as y,a7 as x,a8 as h,D as b,ac as D,a9 as m,t as i,ab as k,aa as S,e as G,ad as K,ae as W,af as X,bG as q}from"./index.673cf58d.js";import{Q as E,a as P}from"./QItem.129857ec.js";import{Q as I}from"./QItemLabel.20b62e60.js";import{Q as Y}from"./QList.0e5fa6ef.js";import{Q as Z}from"./QPage.1da70bf2.js";import{Q as ee,a as ae}from"./QLayout.6bdb52fd.js";import{C as te}from"./ClosePopup.3d5d03c6.js";import{u as se}from"./use-quasar.8083eaf6.js";import{u as oe}from"./useDashboardNavigation.2532b28d.js";import{b as le}from"./lessons.181478ec.js";import{c as re}from"./dateUtils.5c115d8d.js";import{a as ne}from"./locationUtils.57e63eb2.js";import{s as ie}from"./shareUtils.e398f2a8.js";import{a as N}from"./api.5f33f013.js";import{P as de}from"./PlayerNavigationMenu.a7f813ce.js";import{B as ue}from"./BannerPromoScrolling.adcb119c.js";import{N as me}from"./NotificationBell.219cf34c.js";import{P as pe}from"./PlayerTopMenu.225cb5eb.js";import{_ as ce}from"./PlayerSearch.3fb45721.js";import{_ as fe}from"./plugin-vue_export-helper.21dcd24c.js";import"./supabase.6e6ca5a2.js";import"./QTabs.decd7594.js";import"./rtl.276c3f1b.js";import"./QFooter.925a22ea.js";import"./admin.929dac80.js";import"./QBadge.dc3230c9.js";import"./QBtnDropdown.81d386d3.js";import"./QBtnGroup.bf413420.js";import"./QMenu.3db3e33e.js";import"./position-engine.e7dd3b6a.js";import"./selection.3a608fc8.js";import"./haptics.b006d2ba.js";import"./players.daa757ea.js";const ge={class:"header-content"},ve={class:"greeting"},_e={class:"header-icons"},ye={key:0,class:"text-center"},xe={key:1},he={class:"row items-center",style:{position:"relative",width:"100%","margin-bottom":"20px"}},be=["src"],Pe={class:"q-mt-md text-center"},Qe={class:"text-h6 q-mt-sm"},Ce={__name:"ClassDetails",setup(we){const Q=F(),V=J(),{goToDashboard:C}=oe(),c=se();R();const l=g(null),f=g(!0),p=g(!1),n=g(null),z=H(()=>!l.value||!n.value?!1:!n.value.is_paid),w=async()=>{try{const r=await le(Q.params.lessonId);if(l.value=r,console.log(l.value),r.payment_orders&&r.payment_orders.length>0){const e=r.payment_orders[0].id||r.payment_order_id;e&&await B(e)}}catch(r){console.error("Error al cargar los detalles del partido:",r.message),c.notify({type:"negative",message:"Error al cargar los detalles del partido."})}finally{f.value=!1}},B=async r=>{var e;try{const s=await N.get(`/payments/split-payment/${r}`);s.data&&(n.value=s.data)}catch(s){console.log("No split payment found for current user:",(e=s.response)==null?void 0:e.status),n.value=null}},L=()=>{p.value=!0},$=async r=>{var e,s;console.log("Jugador seleccionado:",r);try{f.value=!0;const d=await N.post("/lessons/add-player-to-private-lesson",{lesson_id:Q.params.lessonId,player_id:r.user_id});d.data&&(c.notify({type:"positive",message:"Jugador agregado exitosamente a la clase."}),await w(),d.data.needs_payment&&c.notify({type:"info",message:"El jugador agregado deber\xE1 pagar su parte de la clase."})),p.value=!1}catch(d){console.error("Error al agregar jugador:",d);const j=((s=(e=d.response)==null?void 0:e.data)==null?void 0:s.detail)||"Error al agregar el jugador a la clase.";c.notify({type:"negative",message:j})}finally{f.value=!1}},T=()=>{const r="\xDAnete a esta clase.",e=window.location.href;ie(r,e,"Echa un vistazo a esta clase de padel.")},M=()=>{n.value&&V.push({name:"StripePayment",query:{splitPaymentId:n.value.id,amount:n.value.amount,paymentOrderId:n.value.payment_order_id,returnUrl:`/player/privatelesson/${Q.params.lessonId}`}})};return O(w),(r,e)=>(u(),v(ee,{view:"hHh lpR fFf",class:"text-white"},{default:t(()=>[a(A,{elevated:"",class:"text-white"},{default:t(()=>[o("div",ge,[o("div",ve,[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...s)=>_(C)&&_(C)(...s))})]),o("div",_e,[a(me),a(pe)])]),a(ue)]),_:1}),a(ae,null,{default:t(()=>[a(Z,{class:"q-pa-md"},{default:t(()=>[f.value?(u(),y("div",ye,[a(U,{color:"primary",size:"xl"})])):(u(),y("div",xe,[a(x,{class:"text-white q-pa-md match-card"},{default:t(()=>[a(h,null,{default:t(()=>[o("div",he,[a(b,{flat:"",onClick:T,style:{position:"absolute",left:"0"}},{default:t(()=>[a(D,{name:"o_share",size:"md"})]),_:1}),e[4]||(e[4]=o("h3",{class:"text-h5 text-white",style:{flex:"1",margin:"0","text-align":"center"}},"Entrenamiento",-1))]),o("p",null,[m(" Entrenas en el club "+i(l.value.clubs.name||"No disponible")+" ",1),a(b,{size:"sm",flat:"",round:"",color:"orange",icon:"o_location_on",onClick:e[1]||(e[1]=s=>_(ne)(l.value.clubs.latitude,l.value.clubs.longitude))}),m(" el d\xEDa "+i(_(re)(l.value.lesson_date.value))+" a las "+i(l.value.lesson_time.slice(0,5))+" hrs. En la cancha "+i(l.value.courts.name||"No disponible")+". ",1)]),o("p",null,[e[5]||(e[5]=m("Tipo de partido: Clase Privada",-1)),e[6]||(e[6]=o("br",null,null,-1)),m(" Precio: $"+i(l.value.price)+" PP: $"+i(l.value.price/l.value.participants),1),e[7]||(e[7]=o("br",null,null,-1)),m(" Coach: "+i(l.value.coaches.name),1)])]),_:1})]),_:1}),a(x,{class:"match-card text-white q-pa-md"},{default:t(()=>[a(h,{class:"q-mt-md"},{default:t(()=>[e[9]||(e[9]=o("h3",{class:"text-center text-white"},"Participantes",-1)),a(Y,{bordered:"",separator:""},{default:t(()=>[(u(!0),y(k,null,S(l.value.playerDetails,s=>(u(),v(E,{key:s.user_id},{default:t(()=>[a(P,{avatar:""},{default:t(()=>[a(q,{size:"48px"},{default:t(()=>[o("img",{src:s.photo_url,alt:"Foto del jugador",style:{"border-radius":"50%"}},null,8,be)]),_:2},1024)]),_:2},1024),a(P,null,{default:t(()=>[a(I,null,{default:t(()=>[m(i(s.first_name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(u(!0),y(k,null,S(l.value.participants-l.value.playerDetails.length,s=>(u(),v(E,{key:"add-player-"+s,clickable:"",onClick:L},{default:t(()=>[a(P,{avatar:""},{default:t(()=>[a(q,{size:"48px",class:"bg-grey-7"},{default:t(()=>[a(D,{name:"person_add",size:"32px",color:"white"})]),_:1})]),_:1}),a(P,null,{default:t(()=>[a(I,null,{default:t(()=>[...e[8]||(e[8]=[m("Agregar jugador",-1)])]),_:1})]),_:1})]),_:1}))),128))]),_:1})]),_:1})]),_:1}),z.value?(u(),v(x,{key:0,class:"match-card text-white q-pa-md q-mt-md"},{default:t(()=>[a(h,null,{default:t(()=>{var s,d;return[e[11]||(e[11]=o("h3",{class:"text-center text-white"},"Estado de Pago",-1)),o("div",Pe,[e[10]||(e[10]=o("p",{class:"text-body1"},"Tienes un pago pendiente para esta clase",-1)),o("p",Qe,"Monto: $"+i(((d=(s=n.value)==null?void 0:s.amount)==null?void 0:d.toFixed(2))||"0.00"),1),a(b,{color:"primary",label:"Pagar mi parte",class:"q-mt-md",onClick:M,icon:"payment",size:"lg"})])]}),_:1})]),_:1})):G("",!0)]))]),_:1})]),_:1}),a(X,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s)},{default:t(()=>[a(x,null,{default:t(()=>[a(h,null,{default:t(()=>[e[12]||(e[12]=o("div",{class:"text-h6"},"Agregar Jugador",-1)),a(ce,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),onPlayerSelected:$},null,8,["modelValue"])]),_:1}),a(K,{align:"right"},{default:t(()=>[W(a(b,{flat:"",label:"Cancelar",color:"negative"},null,512),[[te]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(de)]),_:1}))}};var na=fe(Ce,[["__scopeId","data-v-68fcb145"]]);export{na as default};
