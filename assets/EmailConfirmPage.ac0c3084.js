import{r as u,F as P,B as x,q as c,G as C,H as m,v as a,I as t,s as f,Q,y as d,ag as h,J as w,x as L}from"./index.9a35c593.js";import{Q as S}from"./QPage.b11f49d7.js";import{Q as b,a as B}from"./QLayout.356bc385.js";import{s as k}from"./supabase.f526ede5.js";import{_ as N}from"./plugin-vue_export-helper.21dcd24c.js";const R={class:"confirm-container"},U={key:0,class:"loading-container"},I={key:1,class:"success-container"},T={key:2,class:"error-container"},V={class:"error-text"},$={__name:"EmailConfirmPage",setup(q){const n=u(!0),i=u(!1),l=u(null),y=P();x(async()=>{try{console.log("Email confirmation page loaded"),console.log("Current URL:",window.location.href);const s=new URLSearchParams(window.location.search),e=new URLSearchParams(window.location.hash.substring(1));console.log("URL Parameters:");for(const[r,o]of s.entries())console.log(`  ${r}: ${o}`);console.log("Hash Parameters:");for(const[r,o]of e.entries())console.log(`  ${r}: ${o}`);const p=s.get("error")||e.get("error"),_=s.get("error_description")||e.get("error_description");if(p)throw console.error("Email confirmation error:",p,_),new Error(_||"Error al confirmar el correo electr\xF3nico.");const v=e.get("access_token"),E=e.get("refresh_token");if(e.get("type")==="signup"&&v){console.log("Email confirmation detected, setting session...");const{data:r,error:o}=await k.auth.setSession({access_token:v,refresh_token:E});if(o)throw console.error("Error setting session:",o),new Error("No se pudo confirmar tu correo. Por favor, intenta de nuevo.");console.log("Session set successfully:",r),i.value=!0,n.value=!1}else{const{data:{session:r},error:o}=await k.auth.getSession();if(o)throw console.error("Error getting session:",o),new Error("No se pudo verificar tu correo.");if(r&&r.user)console.log("User already has an active session"),i.value=!0,n.value=!1;else throw new Error("No se encontr\xF3 un token de confirmaci\xF3n v\xE1lido. Por favor, verifica el enlace en tu correo.")}}catch(s){console.error("Email confirmation error:",s),l.value=s.message||"Ocurri\xF3 un error al confirmar tu correo electr\xF3nico.",n.value=!1}});const g=()=>{y.push("/")};return(s,e)=>(c(),C(b,{view:"lHh Lpr lFf"},{default:m(()=>[a(B,null,{default:m(()=>[a(S,{class:"email-confirm-page"},{default:m(()=>[t("div",R,[e[3]||(e[3]=t("img",{src:"/logo.jpeg",alt:"Logo",class:"confirm-logo"},null,-1)),n.value?(c(),f("div",U,[a(Q,{size:"lg",color:"white"}),e[0]||(e[0]=t("p",{class:"loading-text"},"Confirmando tu correo electr\xF3nico...",-1))])):d("",!0),i.value?(c(),f("div",I,[a(h,{name:"check_circle",size:"lg",color:"green"}),e[1]||(e[1]=t("p",{class:"success-text"},"\xA1Tu correo ha sido confirmado exitosamente!",-1)),e[2]||(e[2]=t("p",{class:"info-text"},"Ya puedes iniciar sesi\xF3n con tu cuenta.",-1)),a(w,{label:"Ir al inicio de sesi\xF3n",color:"white","text-color":"black",onClick:g,class:"q-mt-md"})])):d("",!0),l.value?(c(),f("div",T,[a(h,{name:"error",size:"lg",color:"red"}),t("p",V,L(l.value),1),a(w,{label:"Volver al inicio",color:"white","text-color":"black",onClick:g,class:"q-mt-md"})])):d("",!0)])]),_:1})]),_:1})]),_:1}))}};var J=N($,[["__scopeId","data-v-960311f4"]]);export{J as default};
