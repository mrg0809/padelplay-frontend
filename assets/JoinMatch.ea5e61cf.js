import{Q as E}from"./QHeader.54948f97.js";import{Q as U}from"./QSpinnerDots.a2bfd80d.js";import{a5 as A,x as q,y as Y,r as p,h as R,o as t,z as m,A as i,d as u,B as a,bG as N,a as n,a7 as w,a8 as P,ac as V,t as l,a9 as H,e as L,bE as x,D as b,bB as J}from"./index.284c5517.js";import{Q as O}from"./QPage.dfd00166.js";import{Q as G,a as X}from"./QLayout.c9dda368.js";import{u as K}from"./use-quasar.58056b10.js";import{u as W}from"./useDashboardNavigation.ef01ab4a.js";import{u as Z}from"./summaryStore.d9ce7f09.js";import{a as T}from"./api.9de4aea7.js";import{B as ee}from"./BannerPromoScrolling.c22fe0eb.js";import{_ as ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./admin.b5ca9f0e.js";const te={class:"header-content"},se={class:"greeting"},oe={key:0,class:"text-center"},le={key:1,class:"text-center"},re={key:2},ie={class:"text-center"},ne={key:0},ce={key:1},de={key:2},ue={class:"court-container"},me={class:"court"},pe={class:"player team1-player1"},_e={key:0},ve=["src"],he={key:1},ye={class:"text-caption"},fe={class:"player team1-player2"},ge={key:0},ke=["src"],xe={key:1},be={class:"text-caption"},De={class:"player team2-player1"},Ce={key:0},we=["src"],Pe={key:1},Qe={class:"text-caption"},Se={class:"player team2-player2"},je={key:0},Me=["src"],Ne={key:1},Je={class:"text-caption"},Te={__name:"JoinMatch",setup($e){const _=A(),D=q(),{goToDashboard:Q}=W(),f=K(),$=Y(),z=Z(),o=p(null),c=p([]),d=p([]),S=p(!0),C=p(null),j=p(!1),h=p(0),M=s=>{J.locale("es-mx");const e=J(s).format("dddd, D [de] MMMM [del] YYYY"),[r,y]=e.split(" de "),v=r.charAt(0).toUpperCase()+r.slice(1),k=y.charAt(0).toUpperCase()+y.slice(1);return v+" de "+k},B=async()=>{try{const s=await T.get(`/matches/match/${_.params.matchId}`);o.value=s.data,c.value=s.data.team1_players||[],d.value=s.data.team2_players||[],s.data.reservation&&s.data.reservation.total_price&&(h.value=(s.data.reservation.total_price/4).toFixed(2))}catch(s){console.error("Error al cargar los detalles del partido:",s),C.value="No se pudo cargar la informaci\xF3n del partido. Por favor, verifica el enlace."}finally{S.value=!1}},g=async(s,e)=>{if(!$.isAuthenticated){f.notify({type:"info",message:"Por favor inicia sesi\xF3n para unirte al juego"}),localStorage.setItem("redirectAfterLogin",_.fullPath),D.push("/");return}if((s===1?c.value:d.value)[e]){f.notify({type:"warning",message:"Este espacio ya est\xE1 ocupado"});return}j.value||h.value===0?await F(s,e):I(s,e)},F=async(s,e)=>{var r,y;try{const v={match_id:_.params.matchId,slot_index:e,team_to_join:s},k=await T.post("/matches/join",v);k.data&&k.data.message&&(f.notify({type:"positive",message:"\xA1Te has unido al partido exitosamente!"}),D.push(`/player/match/${_.params.matchId}`))}catch(v){console.error("Error al unirse al partido:",v),f.notify({type:"negative",message:((y=(r=v.response)==null?void 0:r.data)==null?void 0:y.detail)||"Error al unirse al partido"})}},I=(s,e)=>{const r={summaryTitle:"Confirmar Uni\xF3n a Juego",itemDetails:[{label:"Club",value:o.value.club_name||"No especificado"},{label:"Fecha",value:M(o.value.match_date)},{label:"Hora",value:`${o.value.match_time.slice(0,5)} hrs.`},{label:"Categor\xEDa",value:o.value.category||"N/A"},{label:"Precio (Tu parte)",value:`$${h.value}`}],baseData:{clubId:o.value.club_id,price:parseFloat(h.value),participants:1,type:"open_match_join",id:_.params.matchId},allowPaymentSplit:!1,showPublicToggle:!1,commissionRate:4,extraData:{matchId:_.params.matchId,teamToJoin:s,slotIndex:e,matchCategory:o.value.category,matchDate:o.value.match_date,matchTime:o.value.match_time,clubName:o.value.club_name}};z.setSummaryDetails(r),D.push({name:"OrderSummary"})};return R(()=>{B()}),(s,e)=>(t(),m(G,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:i(()=>[u(E,{elevated:"",class:"text-white"},{default:i(()=>[a("div",te,[a("div",se,[a("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...r)=>N(Q)&&N(Q)(...r))})])]),u(ee)]),_:1}),u(X,null,{default:i(()=>[u(O,{class:"q-pa-md"},{default:i(()=>[S.value?(t(),n("div",oe,[u(U,{color:"primary",size:"xl"})])):C.value?(t(),n("div",le,[u(w,{class:"bg-dark text-white q-pa-md"},{default:i(()=>[u(P,null,{default:i(()=>[u(V,{name:"error",size:"lg",color:"negative"}),a("h5",null,l(C.value),1)]),_:1})]),_:1})])):(t(),n("div",re,[u(w,{class:"text-white q-pa-md match-card"},{default:i(()=>[u(P,null,{default:i(()=>[e[6]||(e[6]=a("h3",{class:"text-h5 text-white text-center"},"\xA1Te invitaron a un juego!",-1)),a("p",ie," Juegas en el club "+l(o.value.club_name||"No disponible")+" el dia "+l(M(o.value.match_date))+" a las "+l(o.value.match_time.slice(0,5))+" hrs. En la cancha "+l(o.value.court_name||"No disponible")+". ",1),o.value.category?(t(),n("p",ne,[H("Categor\xEDa: "+l(o.value.category),1),e[5]||(e[5]=a("br",null,null,-1))])):L("",!0),j.value?(t(),n("p",ce,"Estado del pago: Ya pagado")):(t(),n("p",de,"Precio por jugador: $"+l(h.value)+" MXN",1))]),_:1})]),_:1}),u(w,{class:"match-card text-white q-pa-md q-mt-md"},{default:i(()=>[u(P,null,{default:i(()=>[e[11]||(e[11]=a("h3",{class:"text-center text-white"},"Jugadores",-1)),a("div",ue,[a("div",me,[a("div",pe,[c.value[0]?(t(),n("div",_e,[c.value[0].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:c.value[0].photo_url,alt:"Foto del jugador"},null,8,ve)]),_:1})):(t(),n("span",he,l(c.value[0].first_name||"Jugador 1"),1)),a("div",ye,l(c.value[0].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[1]||(e[1]=r=>g(1,0)),title:"Unirse a este espacio"}))]),a("div",fe,[c.value[1]?(t(),n("div",ge,[c.value[1].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:c.value[1].photo_url,alt:"Foto del jugador"},null,8,ke)]),_:1})):(t(),n("span",xe,l(c.value[1].first_name||"Jugador 2"),1)),a("div",be,l(c.value[1].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[2]||(e[2]=r=>g(1,1)),title:"Unirse a este espacio"}))]),a("div",De,[d.value[0]?(t(),n("div",Ce,[d.value[0].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:d.value[0].photo_url,alt:"Foto del jugador"},null,8,we)]),_:1})):(t(),n("span",Pe,l(d.value[0].first_name||"Jugador 1"),1)),a("div",Qe,l(d.value[0].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[3]||(e[3]=r=>g(2,0)),title:"Unirse a este espacio"}))]),a("div",Se,[d.value[1]?(t(),n("div",je,[d.value[1].photo_url?(t(),m(x,{key:0,size:"40px"},{default:i(()=>[a("img",{src:d.value[1].photo_url,alt:"Foto del jugador"},null,8,Me)]),_:1})):(t(),n("span",Ne,l(d.value[1].first_name||"Jugador 2"),1)),a("div",Je,l(d.value[1].first_name),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:e[4]||(e[4]=r=>g(2,1)),title:"Unirse a este espacio"}))]),e[7]||(e[7]=a("div",{class:"line1"},null,-1)),e[8]||(e[8]=a("div",{class:"net"},null,-1)),e[9]||(e[9]=a("div",{class:"line2"},null,-1)),e[10]||(e[10]=a("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1})]))]),_:1})]),_:1})]),_:1}))}};var Le=ae(Te,[["__scopeId","data-v-4f68ee35"]]);export{Le as default};
