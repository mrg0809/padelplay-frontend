import{aa as y,q as p,G as _,H as t,v as a,ag as b,ad as c,J as g,I as s,ab as u,ac as m,K as v,x as i,y as w}from"./index.813f732c.js";import{Q as D}from"./QToolbarTitle.3671d127.js";import{Q}from"./QToolbar.d41d2a7c.js";import{Q as x}from"./QHeader.16359345.js";import{Q as T}from"./QSelect.9dde8fac.js";import{Q as C}from"./QBadge.3b86f4fc.js";import{Q as f}from"./QTd.9db919c1.js";import{Q as A}from"./QTable.7edcd734.js";import{Q as V}from"./QBanner.3441c54f.js";import{Q as q}from"./QPage.f2a762bd.js";import{Q as k,a as I}from"./QLayout.3fe3ded4.js";import{a as N,b as F}from"./admin.48eb7fea.js";import{A as M}from"./AdminNavigationMenu.5f945123.js";import{_ as S}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.bed768cd.js";import"./QItem.01a0916f.js";import"./QItemLabel.b765193d.js";import"./QMenu.029043d4.js";import"./position-engine.f10226bc.js";import"./selection.7c5ca85a.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.e999ac61.js";import"./QMarkupTable.aa6b72e3.js";import"./use-fullscreen.eb43f0e3.js";import"./api.e96a150b.js";import"./index.c98ef0da.js";import"./QTabs.d300a253.js";import"./QFooter.44b747ac.js";const U={name:"AdminTransactions",components:{AdminNavigationMenu:M},data(){return{transactionData:{transactions:[],total_count:0},clubOptions:[],filters:{startDate:"",endDate:"",clubId:null},loading:!1,error:null,pagination:{rowsPerPage:15},columns:[{name:"order_date",required:!0,label:"Fecha",align:"left",field:"order_date",sortable:!0},{name:"transaction_id",label:"ID Transacci\xF3n",align:"left",field:"transaction_id"},{name:"user_name",label:"Usuario",align:"left",field:"user_name"},{name:"club_name",label:"Club",align:"left",field:"club_name"},{name:"total_amount",label:"Monto",align:"right",field:"total_amount",sortable:!0},{name:"payment_method",label:"M\xE9todo",align:"center",field:"payment_method"},{name:"payment_status",label:"Estado",align:"center",field:"payment_status"}]}},computed:{totalAmount(){return this.transactionData.transactions.reduce((e,l)=>e+(parseFloat(l.total_amount)||0),0)},averageAmount(){return this.transactionData.transactions.length>0?this.totalAmount/this.transactionData.transactions.length:0}},async mounted(){await this.loadClubs(),await this.loadTransactions()},methods:{async loadClubs(){try{const e=await N();this.clubOptions=[{label:"Todos los clubes",value:null},...e.clubs.map(l=>({label:l.name,value:l.id}))]}catch(e){console.error("Error loading clubs:",e)}},async loadTransactions(){this.loading=!0,this.error=null;try{const e={startDate:this.filters.startDate||void 0,endDate:this.filters.endDate||void 0,clubId:this.filters.clubId||void 0};this.transactionData=await F(e)}catch(e){this.error="Error al cargar las transacciones: "+e.message,console.error("Error loading transactions:",e)}finally{this.loading=!1}},clearFilters(){this.filters={startDate:"",endDate:"",clubId:null},this.loadTransactions()},onRequest(e){},formatCurrency(e){return e?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e):"$0.00"},formatDate(e){return e?new Date(e).toLocaleDateString("es-MX"):"N/A"},formatStatus(e){return{succeeded:"Exitoso",pending:"Pendiente",failed:"Fallido",cancelled:"Cancelado"}[e]||e},getStatusColor(e){return{succeeded:"positive",pending:"warning",failed:"negative",cancelled:"grey"}[e]||"grey"}}},B={class:"q-pa-md"},P={class:"row q-gutter-md items-end"},E={class:"col-md-3 col-sm-6"},R={class:"col-md-3 col-sm-6"},L={class:"col-md-4 col-sm-12"},H={class:"col-auto"},O={class:"row q-gutter-md q-mb-lg"},X={class:"col-md-4"},z={class:"text-h4 text-primary"},G={class:"col-md-4"},J={class:"text-h4 text-positive"},K={class:"col-md-4"},j={class:"text-h4 text-secondary"},W={class:"text-weight-bold"};function Y(e,l,Z,$,r,n){const h=y("AdminNavigationMenu");return p(),_(k,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[a(x,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[a(Q,null,{default:t(()=>[a(D,null,{default:t(()=>[a(b,{name:"account_balance_wallet",class:"q-mr-sm"}),l[3]||(l[3]=c(" Transacciones "))]),_:1}),a(g,{flat:"",icon:"refresh",onClick:n.loadTransactions,loading:r.loading,label:"Actualizar"},null,8,["onClick","loading"])]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(q,{padding:"",class:"bg-dark"},{default:t(()=>[s("div",B,[l[7]||(l[7]=s("div",{class:"row q-mb-lg"},[s("div",{class:"col"},[s("p",{class:"text-grey-4"}," Consulta todas las transacciones de la plataforma ")])],-1)),a(u,{class:"filter-card q-mb-md"},{default:t(()=>[a(m,null,{default:t(()=>[s("div",P,[s("div",E,[a(v,{modelValue:r.filters.startDate,"onUpdate:modelValue":[l[0]||(l[0]=o=>r.filters.startDate=o),n.loadTransactions],type:"date",label:"Fecha inicio",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",R,[a(v,{modelValue:r.filters.endDate,"onUpdate:modelValue":[l[1]||(l[1]=o=>r.filters.endDate=o),n.loadTransactions],type:"date",label:"Fecha fin",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",L,[a(T,{modelValue:r.filters.clubId,"onUpdate:modelValue":[l[2]||(l[2]=o=>r.filters.clubId=o),n.loadTransactions],options:r.clubOptions,"option-value":"value","option-label":"label",label:"Filtrar por club",filled:"",dark:"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",H,[a(g,{flat:"",icon:"clear",color:"grey-7",onClick:n.clearFilters,label:"Limpiar"},null,8,["onClick"])])])]),_:1})]),_:1}),s("div",O,[s("div",X,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[4]||(l[4]=s("div",{class:"text-h6 text-white"},"Total Transacciones",-1)),s("div",z,i(r.transactionData.total_count),1)]),_:1})]),_:1})]),s("div",G,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[5]||(l[5]=s("div",{class:"text-h6 text-white"},"Monto Total",-1)),s("div",J,i(n.formatCurrency(n.totalAmount)),1)]),_:1})]),_:1})]),s("div",K,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[6]||(l[6]=s("div",{class:"text-h6 text-white"},"Promedio",-1)),s("div",j,i(n.formatCurrency(n.averageAmount)),1)]),_:1})]),_:1})])]),a(u,{class:"table-card"},{default:t(()=>[a(m,{class:"q-pa-none"},{default:t(()=>[a(A,{rows:r.transactionData.transactions,columns:r.columns,"row-key":"id",flat:"",dark:"",loading:r.loading,pagination:r.pagination,onRequest:n.onRequest},{"body-cell-payment_status":t(o=>[a(f,{props:o},{default:t(()=>[a(C,{color:n.getStatusColor(o.value),label:n.formatStatus(o.value)},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-total_amount":t(o=>[a(f,{props:o},{default:t(()=>[s("span",W,i(n.formatCurrency(o.value)),1)]),_:2},1032,["props"])]),"body-cell-order_date":t(o=>[a(f,{props:o},{default:t(()=>[c(i(n.formatDate(o.value)),1)]),_:2},1032,["props"])]),"body-cell-club_name":t(o=>[a(f,{props:o},{default:t(()=>{var d;return[c(i(((d=o.row.clubs)==null?void 0:d.name)||"N/A"),1)]}),_:2},1032,["props"])]),"body-cell-user_name":t(o=>[a(f,{props:o},{default:t(()=>{var d;return[c(i(((d=o.row.profiles)==null?void 0:d.full_name)||"N/A"),1)]}),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","pagination","onRequest"])]),_:1})]),_:1}),r.error?(p(),_(V,{key:0,class:"bg-negative text-white q-mt-md"},{avatar:t(()=>[a(b,{name:"error"})]),default:t(()=>[c(" "+i(r.error),1)]),_:1})):w("",!0)])]),_:1})]),_:1}),a(h)]),_:1})}var qa=S(U,[["render",Y],["__scopeId","data-v-33df11b0"]]);export{qa as default};
