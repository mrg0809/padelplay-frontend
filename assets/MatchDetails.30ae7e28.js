import{Q as oe}from"./QHeader.907a1956.js";import{Q as re}from"./QSpinnerDots.4f4bbac4.js";import{a7 as le,F as se,r as m,B as ie,bB as H,a8 as k,q as o,G as c,H as i,v as r,I as t,y as C,s as n,a9 as B,aa as j,J as f,ae as S,ab as x,x as d,bC as P,ad as E,ac as I,K as z,Q as ne,af as de,ag as ce,ah as me}from"./index.98c82dee.js";import{Q as ue}from"./QPage.ce31240f.js";import{Q as pe,a as ye}from"./QLayout.d8f1103d.js";import{Q as A}from"./QItemLabel.4f226cee.js";import{Q as ge,a as Y}from"./QItem.ea82eb28.js";import{Q as fe}from"./QList.c1e6c9aa.js";import{C as ve}from"./ClosePopup.8432c4f2.js";import{a as U}from"./api.2af71db3.js";import{u as _e}from"./use-quasar.4bd5d9ce.js";import{u as he}from"./userStore.970be199.js";import{P as ke}from"./PlayerNavigationMenu.f0f41841.js";import{B as xe}from"./BannerPromoScrolling.f7c61c52.js";import{N as be}from"./NotificationBell.c29e48ec.js";import{P as Ce}from"./PlayerTopMenu.ee7159e7.js";import{D as we}from"./DesktopNavigation.dea8eac5.js";import{C as Pe}from"./ClubTopMenu.fa0b3e41.js";import{C as De}from"./ClubNavigationMenu.31568563.js";import{s as Me}from"./players.40eeefa1.js";import{f as Qe}from"./community.7e4968a5.js";import{_ as Ve}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.6266255e.js";import"./QTabs.3a1f3d35.js";import"./rtl.276c3f1b.js";import"./QFooter.a4119c68.js";import"./admin.c99b9bfe.js";import"./QBadge.854dd17f.js";import"./QBtnDropdown.53b53916.js";import"./QMenu.3d5ce795.js";import"./position-engine.79c72190.js";import"./selection.8cc9a7a2.js";import"./QTooltip.27b692bb.js";import"./supabase.5d178e3a.js";const Ne={components:{BannerPromoScrolling:xe,NotificationBell:be,PlayerNavigationMenu:ke,PlayerTopMenu:Ce,DesktopNavigation:we,ClubTopMenu:Pe,ClubNavigationMenu:De},setup(){const y=le(),a=se(),u=_e(),e=he(),v=m(null),_=m([]),D=m([]),M=m(!0),b=m(""),Q=m(null),V=m(null),w=m(!1),h=m(!1),s=m([]),p=m([]),g=m([]),J=m([{name:"Set 1",team1score:0,team2score:0},{name:"Set 2",team1score:0,team2score:0},{name:"Set 3",team1score:0,team2score:0}]),F=async()=>{try{const l=await U.get(`/matches/match/${y.params.matchId}`);v.value=l.data,_.value=l.data.team1_players||[],D.value=l.data.team2_players||[]}catch(l){console.error("Error al cargar los detalles del partido:",l.message),u.notify({type:"negative",message:"Error al cargar los detalles del partido."})}finally{M.value=!1}},G={primera:"1\xBA",segunda:"2\xBA",tercera:"3\xBA",cuarta:"4\xBA",quinta:"5\xBA",sexta:"6\xBA"};function K(l){return G[l==null?void 0:l.toLowerCase()]||l}const O=l=>{if(!l){console.warn("Cannot navigate to player profile: playerId is undefined"),u.notify({type:"warning",message:"No se puede acceder al perfil de este jugador"});return}T.value?a.push(`/player/${l}?from=club`):a.push(`/player/${l}`)},W=async(l,N)=>{Q.value=l,V.value=N,b.value="",s.value=[],w.value=!0,await X()},X=async()=>{try{h.value=!0;const l=await Qe(e.userId);p.value=l.slice(0,4),g.value=p.value}catch(l){console.error("Error loading suggested players:",l),p.value=[],g.value=[]}finally{h.value=!1}},Z=async()=>{if(b.value.trim()===""){g.value=p.value;return}try{h.value=!0;const l=await Me(b.value);s.value=l,g.value=l}catch(l){console.error("Error searching players:",l),s.value=[],g.value=[]}finally{h.value=!1}},$=async l=>{var N,R;try{const q={email_or_phone:l.user_id,match_id:y.params.matchId,team:Q.value,position:V.value,club_name:v.value.club_name||"No especificado",player_name:l.first_name||"Jugador desconocido",match_date:v.value.match_date||"Fecha desconocida",match_time:v.value.match_time||"Hora desconocida"},L=await U.post("/matches/add-player",q);L.data.status==="success"?(u.notify({type:"positive",message:"Jugador agregado exitosamente."}),F()):L.data.status==="invited"&&u.notify({type:"info",message:"Jugador invitado a unirse a PadelPlay."}),w.value=!1}catch(q){console.error("Error al agregar jugador:",q.message),u.notify({type:"negative",message:((R=(N=q.response)==null?void 0:N.data)==null?void 0:R.detail)||"Error al agregar jugador."})}},ee=async()=>{try{await U.put(`/matches/match/${y.params.matchId}`,{score:J.value}),u.notify({type:"positive",message:"Resultado guardado exitosamente."})}catch(l){console.error("Error al guardar el resultado:",l.message),u.notify({type:"negative",message:"Error al guardar el resultado."})}},ae=async()=>{if(navigator.share)try{await navigator.share({title:"Te invitamos a este gran juego",url:window.location.href}),console.log("Encuentro compartido exitosamente")}catch(l){console.error("Error al compartir el partido:",l.message)}else alert("La funcionalidad de compartir no es compatible con este dispositivo.")},te=()=>{a.back()},T=m(!1);return ie(()=>{y.query.from==="club"&&(T.value=!0),F()}),{matchDetails:v,team1:_,team2:D,loading:M,scoreTable:J,addPlayerDialog:w,searchInput:b,searchingPlayers:h,displayedPlayers:g,openAddPlayerDialog:W,searchPlayers:Z,selectPlayer:$,saveScore:ee,shareMatch:ae,goBack:te,formatCategory:K,viewPlayerProfile:O,isClubView:T}},methods:{openChat(){this.$router.push(`/matches/${this.$route.params.matchId}/chat`)},formatDate(y){H.locale("es-mx");const a=H(y).format("dddd, D [de] MMMM [del] YYYY"),[u,e]=a.split(" de "),v=u.charAt(0).toUpperCase()+u.slice(1),_=e.charAt(0).toUpperCase()+e.slice(1);return v+" de "+_},goToMaps(){const y=this.matchDetails.latitude,a=this.matchDetails.longitude;if(y&&a){const u=`https://www.google.com/maps?q=${y},${a}`;window.open(u,"_blank")}else this.$q.notify({message:"Ubicaci\xF3n no disponible",color:"negative",position:"top"})}}},qe={class:"header-content"},Be={class:"header-icons"},je={key:0,class:"text-center"},Se={key:1},Ee={class:"row items-center",style:{position:"relative",width:"100%","margin-bottom":"20px"}},Ie={class:"row",style:{position:"absolute",right:"0"}},Te={class:"court-container"},ze={class:"court"},Ae={class:"player team1-player1"},Ue=["src"],Je={key:1},Fe={class:"text-caption"},Re={class:"player team1-player2"},Le=["src"],He={key:1},Ye={class:"text-caption"},Ge={class:"player team2-player1"},Ke=["src"],Oe={key:1},We={class:"text-caption"},Xe={class:"player team2-player2"},Ze=["src"],$e={key:1},ea={class:"text-caption"},aa={class:"score-grid"},ta={key:0,class:"text-center q-pa-md"},oa=["src"],ra={key:2,class:"text-center text-grey-5 q-pa-md"};function la(y,a,u,e,v,_){const D=k("NotificationBell"),M=k("PlayerTopMenu"),b=k("ClubTopMenu"),Q=k("BannerPromoScrolling"),V=k("DesktopNavigation"),w=k("ClubNavigationMenu"),h=k("PlayerNavigationMenu");return o(),c(pe,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:i(()=>[r(oe,{elevated:"",class:"text-white"},{default:i(()=>[t("div",qe,[a[10]||(a[10]=t("div",{class:"greeting"},[t("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})],-1)),t("div",Be,[r(D),e.isClubView?C("",!0):(o(),c(M,{key:0})),e.isClubView?(o(),c(b,{key:1})):C("",!0)])]),r(Q)]),_:1}),e.isClubView?C("",!0):(o(),c(V,{key:0})),e.isClubView?(o(),c(w,{key:1})):C("",!0),r(ye,null,{default:i(()=>[r(ue,{class:"q-pa-md"},{default:i(()=>[e.loading?(o(),n("div",je,[r(re,{color:"primary",size:"xl"})])):(o(),n("div",Se,[r(B,{class:"text-white q-pa-md match-card"},{default:i(()=>[r(j,null,{default:i(()=>[t("div",Ee,[r(f,{flat:"",onClick:e.shareMatch,style:{position:"absolute",left:"0"}},{default:i(()=>[r(S,{name:"o_share",size:"md"})]),_:1},8,["onClick"]),a[11]||(a[11]=t("h3",{class:"text-h5 text-white",style:{flex:"1",margin:"0","text-align":"center"}},"Reserva",-1)),t("div",Ie,[r(f,{flat:"",onClick:_.openChat},{default:i(()=>[r(S,{name:"o_chat",size:"md"})]),_:1},8,["onClick"])])]),t("p",null,[x(" Juegas en el club "+d(e.matchDetails.club_name||"No disponible")+" ",1),r(f,{size:"sm",flat:"",round:"",color:"orange",icon:"o_location_on",onClick:_.goToMaps},null,8,["onClick"]),x(" el dia "+d(_.formatDate(e.matchDetails.match_date))+" a las "+d(e.matchDetails.match_time.slice(0,5))+" hrs. En la cancha "+d(e.matchDetails.court_name||"No disponible")+". ",1)]),a[12]||(a[12]=t("p",null,[x("Categoria jugadores: Abierto"),t("br"),x(" Tipo de partido: Cerrado"),t("br")],-1))]),_:1})]),_:1}),r(B,{class:"match-card text-white q-pa-md"},{default:i(()=>[r(j,{class:"q-mt-md"},{default:i(()=>[a[19]||(a[19]=t("h3",{class:"text-center text-white"},"Jugadores",-1)),t("div",Te,[t("div",ze,[t("div",Ae,[e.team1[0]?(o(),n("div",{key:0,onClick:a[0]||(a[0]=s=>e.viewPlayerProfile(e.team1[0].user_id)),class:"clickable-player"},[e.team1[0].photo_url?(o(),c(P,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team1[0].photo_url,alt:"Foto del jugador"},null,8,Ue)]),_:1})):(o(),n("span",Je,d(e.team1[0].first_name||"Jugador 1 Equipo 1"),1)),t("div",Fe,d(e.team1[0].first_name)+" - "+d(e.formatCategory(e.team1[0].category)),1)])):(o(),c(f,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[1]||(a[1]=s=>e.openAddPlayerDialog(1,0))}))]),t("div",Re,[e.team1[1]?(o(),n("div",{key:0,onClick:a[2]||(a[2]=s=>e.viewPlayerProfile(e.team1[1].user_id)),class:"clickable-player"},[e.team1[1].photo_url?(o(),c(P,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team1[1].photo_url,alt:"Foto del jugador"},null,8,Le)]),_:1})):(o(),n("span",He,d(e.team1[1].first_name||"Jugador 2 Equipo 1"),1)),t("div",Ye,d(e.team1[1].first_name)+" - "+d(e.formatCategory(e.team1[1].category)),1)])):(o(),c(f,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[3]||(a[3]=s=>e.openAddPlayerDialog(1,1))}))]),t("div",Ge,[e.team2[0]?(o(),n("div",{key:0,onClick:a[4]||(a[4]=s=>e.viewPlayerProfile(e.team2[0].user_id)),class:"clickable-player"},[e.team2[0].photo_url?(o(),c(P,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team2[0].photo_url,alt:"Foto del jugador"},null,8,Ke)]),_:1})):(o(),n("span",Oe,d(e.team2[0].first_name||"Jugador 1 Equipo 2"),1)),t("div",We,d(e.team2[0].first_name)+" - "+d(e.formatCategory(e.team2[0].category)),1)])):(o(),c(f,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[5]||(a[5]=s=>e.openAddPlayerDialog(2,0))}))]),t("div",Xe,[e.team2[1]?(o(),n("div",{key:0,onClick:a[6]||(a[6]=s=>e.viewPlayerProfile(e.team2[1].user_id)),class:"clickable-player"},[e.team2[1].photo_url?(o(),c(P,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team2[1].photo_url,alt:"Foto del jugador"},null,8,Ze)]),_:1})):(o(),n("span",$e,d(e.team2[1].first_name||"Jugador 2 Equipo 2"),1)),t("div",ea,d(e.team2[1].first_name)+" - "+d(e.formatCategory(e.team2[1].category)),1)])):(o(),c(f,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[7]||(a[7]=s=>e.openAddPlayerDialog(2,1))}))]),a[13]||(a[13]=t("div",{class:"line1"},null,-1)),a[14]||(a[14]=t("div",{class:"player parejaA vertical-text"},"Pareja A",-1)),a[15]||(a[15]=t("div",{class:"net"},null,-1)),a[16]||(a[16]=t("div",{class:"line2"},null,-1)),a[17]||(a[17]=t("div",{class:"player parejaB vertical-text"},"Pareja B",-1)),a[18]||(a[18]=t("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1}),r(B,{class:"match-card text-white q-pa-md"},{default:i(()=>[r(j,{class:"score-input"},{default:i(()=>[a[23]||(a[23]=t("h3",{class:"text-center text-white"},"Resultado",-1)),t("div",aa,[a[20]||(a[20]=t("div",{class:"header"},null,-1)),(o(!0),n(E,null,I(e.scoreTable,(s,p)=>(o(),n("div",{class:"header",key:"header-"+p}," Set "+d(p+1),1))),128)),a[21]||(a[21]=t("div",{class:"team-label"},"Pareja A",-1)),(o(!0),n(E,null,I(e.scoreTable,(s,p)=>(o(),n("div",{key:"team1-"+p,class:"score-cell"},[r(z,{modelValue:s.team1score,"onUpdate:modelValue":g=>s.team1score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue"])]))),128)),a[22]||(a[22]=t("div",{class:"team-label"},"Pareja B",-1)),(o(!0),n(E,null,I(e.scoreTable,(s,p)=>(o(),n("div",{key:"team2-"+p,class:"score-cell"},[r(z,{modelValue:s.team2score,"onUpdate:modelValue":g=>s.team2score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),r(f,{label:"Guardar Resultado",color:"primary",class:"q-mt-md",onClick:e.saveScore},null,8,["onClick"])]),_:1})]),_:1})]))]),_:1})]),_:1}),r(me,{modelValue:e.addPlayerDialog,"onUpdate:modelValue":a[9]||(a[9]=s=>e.addPlayerDialog=s)},{default:i(()=>[r(B,{style:{"min-width":"300px","max-width":"500px",width:"90vw"},class:"bg-black text-white"},{default:i(()=>[r(j,null,{default:i(()=>[a[25]||(a[25]=t("div",{class:"text-h6"},"Agregar Jugador",-1)),r(z,{modelValue:e.searchInput,"onUpdate:modelValue":[a[8]||(a[8]=s=>e.searchInput=s),e.searchPlayers],label:"Buscar por nombre",outlined:"",dense:"",class:"q-mb-md"},{prepend:i(()=>[r(S,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"]),e.searchingPlayers?(o(),n("div",ta,[r(ne,{color:"primary",size:"md"})])):e.displayedPlayers.length>0?(o(),c(fe,{key:1,bordered:"",separator:"",class:"rounded-borders"},{default:i(()=>[e.searchInput?C("",!0):(o(),c(A,{key:0,header:"",class:"text-white"},{default:i(()=>a[24]||(a[24]=[x("Sugerencias")])),_:1})),(o(!0),n(E,null,I(e.displayedPlayers,s=>(o(),c(ge,{key:s.user_id,clickable:"",onClick:p=>e.selectPlayer(s),class:"text-white"},{default:i(()=>[r(Y,{avatar:""},{default:i(()=>[r(P,{size:"48px"},{default:i(()=>[s.photo_url?(o(),n("img",{key:0,src:s.photo_url,alt:"Foto del jugador"},null,8,oa)):(o(),c(S,{key:1,name:"person",size:"48px"}))]),_:2},1024)]),_:2},1024),r(Y,null,{default:i(()=>[r(A,{class:"text-white"},{default:i(()=>[x(d(s.first_name)+" "+d(s.last_name),1)]),_:2},1024),r(A,{caption:"",class:"text-grey-5"},{default:i(()=>[x(d(e.formatCategory(s.category)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):e.searchInput?(o(),n("div",ra," No se encontraron jugadores ")):C("",!0)]),_:1}),r(de,{align:"right"},{default:i(()=>[ce(r(f,{flat:"",label:"Cancelar",color:"negative"},null,512),[[ve]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(h)]),_:1})}var Ua=Ve(Ne,[["render",la],["__scopeId","data-v-458bf553"]]);export{Ua as default};
