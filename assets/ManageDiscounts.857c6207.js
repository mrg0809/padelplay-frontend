import{Q as U,a as q}from"./QToolbar.fc79887e.js";import{a as w,r as x,B as N,aa as B,q as m,G as y,H as t,v as o,ad as g,J as v,ab as F,ac as V,I as S,aW as T,K as s,ah as O,aO as P,s as h,ae as E,af as R,y as A,x as p}from"./index.9df047e9.js";import{Q as G}from"./QHeader.59f6ab7c.js";import{Q as c}from"./QSelect.52e691f8.js";import{Q as H}from"./QForm.96ec2e1b.js";import{Q as D}from"./QItemLabel.4373daf4.js";import{Q as L,a as J}from"./QItem.c028cd76.js";import{Q as W}from"./QList.07f095c7.js";import{Q as j}from"./QPage.3f03e3b3.js";import{Q as K,a as z}from"./QLayout.7b0d0242.js";import{C as X}from"./ClubNavigationMenu.ad39d222.js";import{u as Y}from"./use-quasar.d3983b74.js";import{a as C}from"./api.2af71db3.js";import{_ as Z}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.201c3a2b.js";import"./QMenu.faf47994.js";import"./position-engine.e234bce9.js";import"./selection.b2d879b3.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QTabs.0475e115.js";import"./QFooter.5bc3010c.js";const $={components:{ClubNavigationMenu:X},methods:{goBack(){this.$router.back()}},setup(){const d=Y(),e=w({club_id:null,type:null,discount_percentage:null,fixed_price:null,applicable_days:[],start_time:null,end_time:null,start_date:null,end_date:null,description:""}),f=x([]),a=async()=>{try{const n=await C.get("/promo");f.value=n.data}catch{d.notify({type:"negative",message:"Error al cargar los descuentos"})}},k=()=>{const n=localStorage.getItem("token");if(n){const r=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(atob(r)).club_id}return null},b=async()=>{var n,i;try{e.club_id=k(),e.type=e.type.value,e.applicable_days=e.applicable_days.map(r=>r.value),await C.post("/promo",e),d.notify({type:"positive",message:"Descuento o promoci\xF3n creado exitosamente"}),a(),u()}catch(r){console.error("Error en submitDiscount:",r.response||r),d.notify({type:"negative",message:((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.detail)||"Error al guardar el descuento o promoci\xF3n"})}},u=()=>{e.discount_percentage=0,e.fixed_price=0,e.applicable_days=[],e.start_time=null,e.end_time=null,e.start_date=null,e.end_date=null,e.description=""};N(()=>{a()});const l=[{label:"Descuento",value:"discount"}],I=[{label:"Lunes",value:1},{label:"Martes",value:2},{label:"Mi\xE9rcoles",value:3},{label:"Jueves",value:4},{label:"Viernes",value:5},{label:"S\xE1bado",value:6},{label:"Domingo",value:0}],M=Array.from({length:48},(n,i)=>{const r=Math.floor(i/2),Q=i%2===0?"00":"30";return`${r.toString().padStart(2,"0")}:${Q}`}),_=x(null);return{form:e,discounts:f,discountTypes:l,daysOfWeek:I,submitDiscount:b,resetInputs:u,timeOptions:M,applicableDaysSelectRef:_,closeSelect:()=>{_.value&&_.value.hidePopup()}}}};function ee(d,e,f,a,k,b){const u=B("ClubNavigationMenu");return m(),y(K,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[o(G,{class:"bg-primary text-white"},{default:t(()=>[o(U,null,{default:t(()=>[o(q,null,{default:t(()=>e[9]||(e[9]=[g("Gestionar Promociones")])),_:1}),o(v,{flat:"",round:"",icon:"arrow_back",onClick:b.goBack,label:"REGRESAR"},null,8,["onClick"])]),_:1})]),_:1}),o(z,null,{default:t(()=>[o(j,{class:"q-pa-md"},{default:t(()=>[o(F,{dark:"",class:"q-pa-md bg-dark"},{default:t(()=>[o(V,null,{default:t(()=>e[10]||(e[10]=[S("h2",{class:"text-h5 text-white"},"Gesti\xF3n de Descuentos y Promociones",-1)])),_:1}),o(H,{onSubmit:T(a.submitDiscount,["prevent"])},{default:t(()=>[o(V,{class:"q-gutter-y-md"},{default:t(()=>[o(c,{modelValue:a.form.type,"onUpdate:modelValue":[e[0]||(e[0]=l=>a.form.type=l),a.resetInputs],options:a.discountTypes,label:"Tipo","option-value":"value","option-label":"label",dense:"",outlined:"",dark:"",required:""},null,8,["modelValue","options","onUpdate:modelValue"]),o(s,{modelValue:a.form.name,"onUpdate:modelValue":e[1]||(e[1]=l=>a.form.name=l),label:"Nombre de promo",type:"text",dense:"",outlined:"",dark:"",min:"0",required:""},null,8,["modelValue"]),o(s,{modelValue:a.form.fixed_price,"onUpdate:modelValue":e[2]||(e[2]=l=>a.form.fixed_price=l),modelModifiers:{number:!0},label:"Precio Fijo",type:"number",dense:"",outlined:"",dark:"",min:"0",required:""},null,8,["modelValue"]),o(c,{ref:"applicableDaysSelectRef",modelValue:a.form.applicable_days,"onUpdate:modelValue":e[3]||(e[3]=l=>a.form.applicable_days=l),options:a.daysOfWeek,label:"D\xEDas Aplicables",multiple:"","option-value":"value","option-label":"label",dense:"",outlined:"",dark:"","use-chips":""},{append:t(()=>[o(v,{round:"",dense:"",flat:"",icon:"check",onClick:a.closeSelect},null,8,["onClick"])]),_:1},8,["modelValue","options"]),o(c,{modelValue:a.form.start_time,"onUpdate:modelValue":e[4]||(e[4]=l=>a.form.start_time=l),options:a.timeOptions,label:"Hora de Inicio",outlined:"",dense:"",dark:"",required:""},null,8,["modelValue","options"]),o(c,{modelValue:a.form.end_time,"onUpdate:modelValue":e[5]||(e[5]=l=>a.form.end_time=l),options:a.timeOptions,label:"Hora de Fin",outlined:"",dense:"",dark:"",required:""},null,8,["modelValue","options"]),o(s,{modelValue:a.form.start_date,"onUpdate:modelValue":e[6]||(e[6]=l=>a.form.start_date=l),label:"Fecha de Inicio",type:"date",dense:"",outlined:"",dark:""},null,8,["modelValue"]),o(s,{modelValue:a.form.end_date,"onUpdate:modelValue":e[7]||(e[7]=l=>a.form.end_date=l),label:"Fecha de Fin",type:"date",dense:"",outlined:"",dark:""},null,8,["modelValue"]),o(s,{modelValue:a.form.description,"onUpdate:modelValue":e[8]||(e[8]=l=>a.form.description=l),label:"Descripci\xF3n",type:"textarea",dense:"",outlined:"",dark:""},null,8,["modelValue"])]),_:1}),o(O,{align:"right"},{default:t(()=>[o(v,{label:"Guardar",type:"submit",color:"primary"})]),_:1})]),_:1},8,["onSubmit"]),o(P,{spaced:""}),a.discounts.length?(m(),y(V,{key:0},{default:t(()=>[e[11]||(e[11]=S("h3",{class:"text-h6 text-white"},"Descuentos y Promociones Actuales",-1)),o(W,{dark:""},{default:t(()=>[(m(!0),h(R,null,E(a.discounts,l=>(m(),y(L,{key:l.id,clickable:""},{default:t(()=>[o(J,null,{default:t(()=>[o(D,null,{default:t(()=>[g(p(l.name),1)]),_:2},1024),o(D,{caption:""},{default:t(()=>[g(" Tipo: "+p(l.type)+" | Vigencia: "+p(l.start_date||"Indefinido")+" - "+p(l.end_date||"Indefinido"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1}),o(u)]),_:1})}var Se=Z($,[["render",ee],["__scopeId","data-v-6f89532c"]]);export{Se as default};
