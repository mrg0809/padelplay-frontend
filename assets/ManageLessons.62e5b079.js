import{F as U,r as c,B,a8 as M,q as p,G as b,H as s,v as l,I as f,ab as i,J as L,s as S,ac as N,ad as F,a9 as E,aa as Q,K as t,ah as H,x as d}from"./index.cf1ae381.js";import{Q as P}from"./QHeader.22bc8748.js";import{Q as _}from"./QItemLabel.bad9e799.js";import{Q as R,a as J}from"./QItem.ff5f9822.js";import{Q as j}from"./QList.060f9b6d.js";import{Q as z}from"./QPage.3d29d4c0.js";import{Q as A,a as G}from"./QLayout.3b12d370.js";import{Q as x}from"./QSelect.20d9335a.js";import{Q as K}from"./QForm.cdd9f9da.js";import{s as C}from"./supabase.ad40cb04.js";import{u as T}from"./use-quasar.fa8835f9.js";import{u as O}from"./userStore.f5a1e81d.js";import{a as k}from"./api.f1a1189d.js";import{C as W}from"./ClubNavigationMenu.e493d6d8.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.8375ad21.js";import"./QMenu.d6639417.js";import"./position-engine.b650c4e5.js";import"./selection.e1a99fb1.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./pinia.063153d6.js";import"./QTabs.2d6a2a07.js";import"./QFooter.b33a1995.js";const Y={name:"ManageLessons",components:{ClubNavigationMenu:W},setup(){const V=U(),a=T(),u=O(),o=c([]),v=c([]),g=c([]),r=c(!1),e=c({name:"",description:"",lesson_date:"",lesson_time:"",duration:60,coach:"",court_id:"",lesson_type:"public",max_participants:null}),q=()=>{V.back()},I=async()=>{const n=await C.from("coaches").select("*").eq("club_id",u.clubId),w=await C.from("courts").select("*").eq("club_id",u.clubId);v.value=n.data.map(m=>({label:m.name,value:m.id})),g.value=w.data.map(m=>({label:m.name,value:m.id})),r.value=!0},D=async()=>{try{const n={name:e.value.name,description:e.value.description,lesson_date:e.value.lesson_date,lesson_time:e.value.lesson_time,duration:e.value.duration,lesson_type:e.value.lesson_type,club_id:u.clubId,court_id:e.value.court_id.value,coach:e.value.coach.value,price:e.value.price,max_participants:e.value.max_participants?parseInt(e.value.max_participants):null};(await k.post("/lessons",n)).data.message==="Lecci\xF3n creada exitosamente"&&(a.notify({type:"positive",message:"Lecci\xF3n creada exitosamente"}),r.value=!1,y())}catch(n){a.notify({type:"negative",message:"Error al crear la lecci\xF3n"}),console.error("Error al crear la lecci\xF3n:",n)}finally{r.value=!1}},y=async()=>{const n=await k.get(`/lessons?club_id=${u.clubId}`);o.value=n.data};return B(()=>{y()}),{goBack:q,lessons:o,coaches:v,courts:g,lessonDialog:r,newLesson:e,openLessonDialog:I,createLesson:D}}},Z={class:"header-content"},h={class:"header-icons"};function $(V,a,u,o,v,g){const r=M("ClubNavigationMenu");return p(),b(A,{view:"hHh lpR fFf",class:"body text-white"},{default:s(()=>[l(P,{elevated:"",class:"bg-primary text-white"},{default:s(()=>[f("div",Z,[a[10]||(a[10]=f("div",{class:"greeting"},[f("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"}),i(" Configura clases ")],-1)),f("div",h,[l(L,{flat:"",round:"",icon:"arrow_back",onClick:o.goBack},null,8,["onClick"])])])]),_:1}),l(G,null,{default:s(()=>[l(z,{class:"q-pa-md"},{default:s(()=>[l(j,{bordered:"",class:"q-mb-md"},{default:s(()=>[(p(!0),S(F,null,N(o.lessons,e=>(p(),b(R,{key:e.id,class:"q-my-sm"},{default:s(()=>[l(J,null,{default:s(()=>[l(_,null,{default:s(()=>[i(d(e.name),1)]),_:2},1024),l(_,{caption:""},{default:s(()=>[i(d(e.description),1)]),_:2},1024),l(_,{caption:""},{default:s(()=>[i(d(e.lesson_date)+" a las "+d(e.lesson_time),1)]),_:2},1024),e.max_participants?(p(),b(_,{key:0,caption:""},{default:s(()=>[i(" Capacidad: "+d(e.available_slots||0)+"/"+d(e.max_participants)+" disponibles ",1)]),_:2},1024)):(p(),b(_,{key:1,caption:""},{default:s(()=>a[11]||(a[11]=[i(" Capacidad: Ilimitada ")])),_:1}))]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(L,{glossy:"",round:"",size:"lg",color:"black",icon:"add",class:"fixed-bottom-right q-mb-xl",onClick:o.openLessonDialog},null,8,["onClick"])]),_:1})]),_:1}),l(H,{modelValue:o.lessonDialog,"onUpdate:modelValue":a[9]||(a[9]=e=>o.lessonDialog=e)},{default:s(()=>[l(E,{class:"q-pa-md bg-black"},{default:s(()=>[l(Q,null,{default:s(()=>a[12]||(a[12]=[f("div",{class:"text-h6"},"Agregar nueva lecci\xF3n",-1)])),_:1}),l(Q,null,{default:s(()=>[l(K,{onSubmit:o.createLesson},{default:s(()=>[l(t,{modelValue:o.newLesson.name,"onUpdate:modelValue":a[0]||(a[0]=e=>o.newLesson.name=e),label:"Nombre",required:""},null,8,["modelValue"]),l(t,{modelValue:o.newLesson.description,"onUpdate:modelValue":a[1]||(a[1]=e=>o.newLesson.description=e),label:"Descripci\xF3n"},null,8,["modelValue"]),l(t,{modelValue:o.newLesson.lesson_date,"onUpdate:modelValue":a[2]||(a[2]=e=>o.newLesson.lesson_date=e),type:"date",label:"Fecha",required:""},null,8,["modelValue"]),l(t,{modelValue:o.newLesson.lesson_time,"onUpdate:modelValue":a[3]||(a[3]=e=>o.newLesson.lesson_time=e),type:"time",label:"Hora",required:""},null,8,["modelValue"]),l(t,{modelValue:o.newLesson.duration,"onUpdate:modelValue":a[4]||(a[4]=e=>o.newLesson.duration=e),type:"number",label:"Duraci\xF3n (minutos)",required:""},null,8,["modelValue"]),l(x,{modelValue:o.newLesson.coach,"onUpdate:modelValue":a[5]||(a[5]=e=>o.newLesson.coach=e),options:o.coaches,label:"Entrenador",required:""},null,8,["modelValue","options"]),l(x,{modelValue:o.newLesson.court_id,"onUpdate:modelValue":a[6]||(a[6]=e=>o.newLesson.court_id=e),options:o.courts,label:"Cancha",required:""},null,8,["modelValue","options"]),l(t,{modelValue:o.newLesson.price,"onUpdate:modelValue":a[7]||(a[7]=e=>o.newLesson.price=e),type:"number",label:"Precio por Jugador",required:""},null,8,["modelValue"]),l(t,{modelValue:o.newLesson.max_participants,"onUpdate:modelValue":a[8]||(a[8]=e=>o.newLesson.max_participants=e),type:"number",label:"M\xE1ximo de Participantes",hint:"Deja vac\xEDo para ilimitado"},null,8,["modelValue"]),l(L,{type:"submit",color:"green",label:"Crear lecci\xF3n"})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(r)]),_:1})}var xe=X(Y,[["render",$],["__scopeId","data-v-3b386d2e"]]);export{xe as default};
