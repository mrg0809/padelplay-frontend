import{r as u,F as h,B as f,q as c,G as v,H as n,v as r,I as l,s as d,Q as b,y as p,ae as k,x as y,J as w}from"./index.71d630fb.js";import{Q as C}from"./QPage.ce9abbf4.js";import{Q as x,a as A}from"./QLayout.c08f0fa0.js";import{u as Q}from"./userStore.0094877c.js";import{o as U}from"./auth.7e9c5332.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.014ff78d.js";import"./supabase.60a2aacd.js";import"./api.f1a1189d.js";const S={class:"callback-container"},L={key:0,class:"loading-container"},O={key:1,class:"error-container"},B={class:"error-text"},N={__name:"AuthCallbackPage",setup(E){const i=u(!0),a=u(null),o=h(),_=Q();f(async()=>{try{console.log("OAuth callback page loaded"),console.log("Current URL:",window.location.href),console.log("URL hash:",window.location.hash),console.log("URL search params:",window.location.search);const{access_token:e}=await U.handleOAuthCallback();localStorage.setItem("token",e),_.setUserDataFromToken(e);const m=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=JSON.parse(atob(m));console.log("OAuth login successful, user type:",t.user_type),t.user_type==="superuser"?o.push("/dashboard/superuser"):t.user_type==="admin"?o.push("/dashboard/admin"):t.user_type==="club"?o.push("/dashboard/club"):o.push("/dashboard/player")}catch(e){console.error("OAuth callback error:",e),e.message&&e.message.includes("No active session found")?a.value="No se encontr\xF3 una sesi\xF3n activa. Esto puede suceder si la configuraci\xF3n de OAuth no est\xE1 completa. Revisa OAUTH_SETUP.md para m\xE1s informaci\xF3n.":e.response&&e.response.status===503?a.value="Error de configuraci\xF3n de la base de datos. Contacta al administrador.":a.value="Error durante la autenticaci\xF3n. Por favor, intenta de nuevo.",i.value=!1}});const g=()=>{o.push("/")};return(e,s)=>(c(),v(x,{view:"lHh Lpr lFf"},{default:n(()=>[r(A,null,{default:n(()=>[r(C,{class:"auth-callback-page"},{default:n(()=>[l("div",S,[s[1]||(s[1]=l("img",{src:"/src/assets/logo.jpeg",alt:"Logo",class:"callback-logo"},null,-1)),i.value?(c(),d("div",L,[r(b,{size:"lg",color:"white"}),s[0]||(s[0]=l("p",{class:"loading-text"},"Procesando autenticaci\xF3n...",-1))])):p("",!0),a.value?(c(),d("div",O,[r(k,{name:"error",size:"lg",color:"red"}),l("p",B,y(a.value),1),r(w,{label:"Volver al inicio",color:"white","text-color":"black",onClick:g})])):p("",!0)])]),_:1})]),_:1})]),_:1}))}};var j=P(N,[["__scopeId","data-v-185b8376"]]);export{j as default};
