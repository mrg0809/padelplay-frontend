import{F as B,a9 as E,r as _,B as V,aa as F,q as n,G as y,H as t,v as a,I as s,ad as M,J as w,s as C,ab as x,ac as l,aO as P,ag as v,x as Q,K as L,y as A}from"./index.3f1076a3.js";import{Q as R}from"./QHeader.435fe33d.js";import{Q as T}from"./QSpinnerGears.70e81a6b.js";import{Q as j}from"./QInnerLoading.940b8bb6.js";import{Q as q}from"./QImg.3196af78.js";import{Q as h}from"./QBanner.7d1e7c29.js";import{Q as O}from"./QForm.336a6287.js";import{Q as H}from"./QPage.76b9f650.js";import{Q as U,a as G}from"./QLayout.fe9d4509.js";import{u as J}from"./use-quasar.0801e5c5.js";import{a as I}from"./api.2af71db3.js";import{n as K}from"./navigationUtils.2c4b9dee.js";import{u as W}from"./userStore.83e3996f.js";import{C as X}from"./ClubNavigationMenu.b111cae3.js";import{_ as Y}from"./MP_RGB_horizontal.ee11db59.js";import{_ as Z}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.79532550.js";import"./QTabs.a46b14bb.js";import"./rtl.276c3f1b.js";import"./QFooter.1bfeb9e5.js";const $={name:"ManageAccounts",components:{ClubNavigationMenu:X},setup(){const d=B(),e=E(),c=J(),o=W(),g=_(!0),p=_(!1),f=_({mercadopago_seller_id:null,stripe_account_id:null,has_mercadopago_seller_id:!1,has_stripe_account_id:!1,last_updated:null}),u=_({accountId:""}),D=()=>{d.back()},k=async()=>{try{g.value=!0;const r=await I.get("/clubs/payment-accounts");f.value=r.data}catch(r){console.error("Error loading payment accounts:",r),c.notify({type:"negative",message:"Error al cargar la informaci\xF3n de cuentas de pago"})}finally{g.value=!1}},S=async()=>{var r,b;try{p.value=!0;const i=o.clubId;if(!i){c.notify({type:"negative",message:"No se pudo obtener el ID del club. Por favor, inicie sesi\xF3n nuevamente."});return}console.log("Connecting MercadoPago OAuth with club_id:",i);const m=await I.get(`/payments/mercadopago-oauth/authorize?club_id=${i}`);if(console.log("OAuth authorize response:",m.data),m.data&&m.data.authorization_url)console.log("Redirecting to:",m.data.authorization_url),window.location.href=m.data.authorization_url;else throw new Error("No se recibi\xF3 la URL de autorizaci\xF3n")}catch(i){console.error("Error connecting MercadoPago:",i),c.notify({type:"negative",message:((b=(r=i.response)==null?void 0:r.data)==null?void 0:b.detail)||"Error al conectar con MercadoPago. Verifique su configuraci\xF3n."})}finally{p.value=!1}},z=r=>r?new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",N=()=>{const r=e.query.mercadopago;r==="success"?(c.notify({type:"positive",message:"\xA1Cuenta de MercadoPago conectada exitosamente!",timeout:3e3}),d.replace({query:{}}),k()):r==="error"&&(c.notify({type:"negative",message:"Error al conectar la cuenta de MercadoPago. Por favor, intente nuevamente.",timeout:3e3}),d.replace({query:{}}))};return V(()=>{k(),N()}),{loading:g,connectingMercadoPago:p,paymentAccounts:f,stripeForm:u,goBack:D,connectMercadoPago:S,formatDate:z,goToDashboard:()=>{K(d,o)}}}},aa={class:"header-content"},ea={class:"greeting"},oa={class:"header-icons"},ta={key:0,class:"q-gutter-md"},sa={class:"row items-center justify-between"},ra={class:"col-auto"},na={key:0,class:"q-mb-md"},ca={class:"text-caption q-mt-xs"},ia={key:1,class:"q-mb-md"},la={class:"row justify-center q-mt-md"},da={class:"row items-center justify-between"},ua={class:"col-auto"},ma={class:"q-gutter-md"},ga={class:"text-caption text-grey-7"};function pa(d,e,c,o,g,p){const f=F("ClubNavigationMenu");return n(),y(U,{view:"hHh lpR fFf",class:"body text-white"},{default:t(()=>[a(R,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[s("div",aa,[s("div",ea,[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...u)=>o.goToDashboard&&o.goToDashboard(...u))}),e[2]||(e[2]=M(" Cuentas de Pago "))]),s("div",oa,[a(w,{flat:"",round:"",icon:"arrow_back",onClick:o.goBack},null,8,["onClick"])])])]),_:1}),a(G,null,{default:t(()=>[a(H,{class:"q-pa-md"},{default:t(()=>[a(j,{showing:o.loading},{default:t(()=>[a(T,{size:"50px",color:"primary"})]),_:1},8,["showing"]),o.loading?A("",!0):(n(),C("div",ta,[a(x,{class:"info-card"},{default:t(()=>[a(l,null,{default:t(()=>e[3]||(e[3]=[s("div",{class:"text-h6 text-primary"},"Informaci\xF3n de Cuentas de Pago",-1),s("p",{class:"text-body2 q-mt-sm"}," Configure sus cuentas de pago para recibir transferencias autom\xE1ticas cuando los jugadores realicen pagos en su club. Estos datos son encriptados y almacenados de forma segura. ",-1)])),_:1})]),_:1}),a(x,{class:"payment-card"},{default:t(()=>[a(l,null,{default:t(()=>[s("div",sa,[e[4]||(e[4]=s("div",{class:"col"},[s("div",{class:"text-h6 text-primary"},"MercadoPago"),s("div",{class:"text-body2 text-grey-7"},"Conecte su cuenta de MercadoPago para recibir pagos autom\xE1ticamente")],-1)),s("div",ra,[a(q,{src:Y,style:{width:"80px",height:"40px"},contain:""})])])]),_:1}),a(P),a(l,null,{default:t(()=>[o.paymentAccounts.has_mercadopago_seller_id?(n(),C("div",na,[a(h,{class:"bg-positive text-white rounded-borders"},{avatar:t(()=>[a(v,{name:"check_circle",color:"white"})]),default:t(()=>[e[5]||(e[5]=s("div",{class:"text-weight-medium"},"Cuenta de MercadoPago Conectada",-1)),s("div",ca," ID de Vendedor: "+Q(o.paymentAccounts.mercadopago_seller_id),1)]),_:1})])):(n(),C("div",ia,[a(h,{class:"bg-warning text-white rounded-borders"},{avatar:t(()=>[a(v,{name:"warning",color:"white"})]),default:t(()=>[e[6]||(e[6]=s("div",{class:"text-weight-medium"},"Cuenta de MercadoPago No Conectada",-1)),e[7]||(e[7]=s("div",{class:"text-caption q-mt-xs"}," Conecte su cuenta para recibir pagos de reservas, clases y torneos ",-1))]),_:1})])),s("div",la,[o.paymentAccounts.has_mercadopago_seller_id?(n(),y(w,{key:1,color:"secondary",label:"Reconectar MercadoPago",icon:"refresh",size:"lg",loading:o.connectingMercadoPago,onClick:o.connectMercadoPago,class:"full-width",outline:""},null,8,["loading","onClick"])):(n(),y(w,{key:0,color:"primary",label:"Conectar con MercadoPago",icon:"link",size:"lg",loading:o.connectingMercadoPago,onClick:o.connectMercadoPago,class:"full-width"},null,8,["loading","onClick"]))]),a(h,{class:"bg-info text-white rounded-borders q-mt-md"},{avatar:t(()=>[a(v,{name:"info",color:"white"})]),default:t(()=>[e[8]||(e[8]=s("div",{class:"text-body2"}," Al conectar su cuenta, ser\xE1 redirigido a MercadoPago para autorizar el acceso de forma segura. No compartimos sus credenciales - todo se maneja mediante OAuth. ",-1))]),_:1})]),_:1})]),_:1}),a(x,{class:"payment-card"},{default:t(()=>[a(l,null,{default:t(()=>[s("div",da,[e[9]||(e[9]=s("div",{class:"col"},[s("div",{class:"text-h6 text-primary"},"Stripe"),s("div",{class:"text-body2 text-grey-7"},"Configure su cuenta de Stripe para recibir pagos (pr\xF3ximamente)")],-1)),s("div",ua,[a(q,{src:"https://stripe.com/img/v3/newsroom/social.png",style:{width:"80px",height:"40px"},contain:""})])])]),_:1}),a(P),a(l,null,{default:t(()=>[a(O,null,{default:t(()=>[s("div",ma,[a(L,{modelValue:o.stripeForm.accountId,"onUpdate:modelValue":e[1]||(e[1]=u=>o.stripeForm.accountId=u),label:"Stripe Account ID",placeholder:o.paymentAccounts.stripe_account_id||"acct_xxxxxxxxxxxxxxxxxx",outlined:"",dense:"",suffix:o.paymentAccounts.has_stripe_account_id?"(Configurado)":"",hint:o.paymentAccounts.has_stripe_account_id?`Actual: ${o.paymentAccounts.stripe_account_id}`:"ID de su cuenta de Stripe Connect",disable:!0},null,8,["modelValue","placeholder","suffix","hint"]),a(h,{class:"bg-black-3"},{avatar:t(()=>[a(v,{name:"info",color:"primary"})]),default:t(()=>[e[10]||(e[10]=M(" La integraci\xF3n con Stripe estar\xE1 disponible pr\xF3ximamente para mercados internacionales. "))]),_:1})])]),_:1})]),_:1})]),_:1}),o.paymentAccounts.last_updated?(n(),y(x,{key:0,class:"q-mt-md"},{default:t(()=>[a(l,{class:"text-center"},{default:t(()=>[s("div",ga," \xDAltima actualizaci\xF3n: "+Q(o.formatDate(o.paymentAccounts.last_updated)),1)]),_:1})]),_:1})):A("",!0)]))]),_:1})]),_:1}),a(f)]),_:1})}var Ea=Z($,[["render",pa],["__scopeId","data-v-9edfb888"]]);export{Ea as default};
