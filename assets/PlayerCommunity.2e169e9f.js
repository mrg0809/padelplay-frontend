import{Q as A}from"./QHeader.6c821f61.js";import{Q as M}from"./QInnerLoading.a360e175.js";import{x as U,r as m,y as z,w as j,h as q,a6 as N,o as t,z as d,A as l,d as e,B as u,a as f,E as H,ac as R,aK as G,ab as S,aa as x,bG as C,a9 as y,t as h,D,aT as F}from"./index.7e1eb1fb.js";import{Q as K,a as I}from"./QTabs.126199a6.js";import{Q as B,a as g}from"./QItem.ba33f348.js";import{Q as v}from"./QItemLabel.a9ded771.js";import{Q as T}from"./QList.1a20363e.js";import{a as J,Q as V}from"./QTabPanel.2a9a9eb7.js";import{Q as O}from"./QPage.52873f45.js";import{Q as W,a as X}from"./QLayout.3adb72cb.js";import{n as Y}from"./navigationUtils.2c4b9dee.js";import{P as Z}from"./PlayerNavigationMenu.958f1de2.js";import{N as $}from"./NotificationBell.a406470b.js";import{B as ee}from"./BannerPromoScrolling.235ca23c.js";import{f as oe,a as ae,b as le,i as re,c as te,u as se}from"./community.0c600427.js";import{s as ne}from"./commun.c202e6ca.js";import{_ as ie}from"./plugin-vue_export-helper.21dcd24c.js";import"./rtl.276c3f1b.js";import"./use-panel.b4d4474f.js";import"./touch.9135741d.js";import"./selection.c251650e.js";import"./use-render-cache.3aae9b27.js";import"./QFooter.2bdcd75c.js";import"./QBadge.2b9406be.js";import"./api.43112139.js";import"./admin.d9825531.js";import"./supabase.6e6ca5a2.js";const ce=n=>n?`${n.first_name||""} ${n.last_name||""}`.trim()||"Usuario":"",de=n=>n||"https://cdn.quasar.dev/img/avatar.png";const ue={components:{PlayerNavigationMenu:Z,BannerPromoScrolling:ee,NotificationBell:$},setup(){const n=U(),s=m(""),_=m(!1),a=m("following"),i=z(),w=m([]),k=m([]),P=m([]),p=m(!0),o=async()=>{try{console.log("Loading following for user:",i.userId),w.value=await oe(i.userId)}catch(r){console.error("Error loading following:",r)}},c=async()=>{try{k.value=await ae(i.userId)}catch(r){console.error("Error loading followers:",r)}},Q=async()=>{_.value=!0;try{P.value=await le(i.userId)}catch(r){console.error("Error loading suggested players:",r)}finally{_.value=!1}},L=async()=>{_.value=!0;try{const r=await ne(s.value.trim());a.value==="suggestions"&&(P.value=r)}catch(r){console.error("Error searching players:",r)}finally{_.value=!1}},E=r=>w.value&&re(w.value,r);return j(a,r=>{r==="following"?o():r==="followers"?c():r==="suggestions"&&Q()}),q(()=>{i.userId?(p.value=!1,o(),c(),Q()):(console.error("No user ID found in userStore"),p.value=!1)}),{searchQuery:s,searching:_,selectedTab:a,following:w,followers:k,isLoading:p,suggestedPlayers:P,searchPlayers:L,isFollowing:E,viewPlayerProfile:r=>{n.push(`/player/${r}`)},followPlayer:async r=>{try{await te(i.userId,r),o(),c(),Q()}catch(b){console.error("Error following player:",b)}},unfollowPlayer:async r=>{try{await se(i.userId,r),o(),c(),Q()}catch(b){console.error("Error unfollowing player:",b)}},getPlayerAvatar:de,formatPlayerName:ce,goToDashboard:()=>{Y(n,i)}}}},fe={class:"header-content"},me={class:"greeting"},ge={class:"header-icons"},_e={key:0},ye={key:1},he={class:"search-bar"},ve=["src"],we={key:1,class:"text-center"},Pe=["src"],pe={key:1,class:"text-center"},ke=["src"],Qe={key:1,class:"text-center"};function be(n,s,_,a,i,w){const k=N("NotificationBell"),P=N("BannerPromoScrolling"),p=N("PlayerNavigationMenu");return t(),d(W,{view:"hHh lpR fFf",class:"text-white"},{default:l(()=>[e(A,{elevated:"",class:"text-white"},{default:l(()=>[u("div",fe,[u("div",me,[u("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:s[0]||(s[0]=(...o)=>a.goToDashboard&&a.goToDashboard(...o))})]),u("div",ge,[e(k)])]),e(P)]),_:1}),e(X,{class:"home"},{default:l(()=>[e(O,{class:"q-pa-md"},{default:l(()=>[a.isLoading?(t(),f("div",_e,[e(M,{showing:!0,size:"xl",color:"primary"})])):(t(),f("div",ye,[u("div",he,[e(H,{modelValue:a.searchQuery,"onUpdate:modelValue":s[1]||(s[1]=o=>a.searchQuery=o),filled:"",dense:"",placeholder:"Buscar jugador por nombre",onInput:a.searchPlayers,class:"text-dark"},{prepend:l(()=>[e(R,{name:"search",class:"text-primary",color:"white"})]),_:1},8,["modelValue","onInput"])]),e(K,{modelValue:a.selectedTab,"onUpdate:modelValue":s[2]||(s[2]=o=>a.selectedTab=o),align:"justify",class:"text-white"},{default:l(()=>[e(I,{name:"following",label:"Siguiendo"}),e(I,{name:"followers",label:"Seguidores"}),e(I,{name:"suggestions",label:"Sugerencias"})]),_:1},8,["modelValue"]),e(G,{class:"q-my-md",color:"white"}),e(J,{modelValue:a.selectedTab,"onUpdate:modelValue":s[3]||(s[3]=o=>a.selectedTab=o),animated:""},{default:l(()=>[e(V,{name:"following"},{default:l(()=>[a.following.length>0?(t(),d(T,{key:0},{default:l(()=>[(t(!0),f(S,null,x(a.following,o=>(t(),d(B,{key:o.user_id,clickable:"",onClick:c=>a.viewPlayerProfile(o.user_id)},{default:l(()=>[e(g,{avatar:""},{default:l(()=>[e(C,null,{default:l(()=>[u("img",{src:a.getPlayerAvatar(o.photo_url)},null,8,ve)]),_:2},1024)]),_:2},1024),e(g,null,{default:l(()=>[e(v,null,{default:l(()=>[y(h(a.formatPlayerName(o)),1)]),_:2},1024),e(v,{caption:""},{default:l(()=>[y(h(o.category),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(t(),f("div",we,"No est\xE1s siguiendo a nadie."))]),_:1}),e(V,{name:"followers"},{default:l(()=>[a.followers.length>0?(t(),d(T,{key:0},{default:l(()=>[(t(!0),f(S,null,x(a.followers,o=>(t(),d(B,{key:o.user_id,clickable:"",onClick:c=>a.viewPlayerProfile(o.user_id)},{default:l(()=>[e(g,{avatar:""},{default:l(()=>[e(C,null,{default:l(()=>[u("img",{src:a.getPlayerAvatar(o.photo_url)},null,8,Pe)]),_:2},1024)]),_:2},1024),e(g,null,{default:l(()=>[e(v,null,{default:l(()=>[y(h(a.formatPlayerName(o)),1)]),_:2},1024),e(v,{caption:""},{default:l(()=>[y(h(o.category),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(t(),f("div",pe,"No tienes seguidores."))]),_:1}),e(V,{name:"suggestions"},{default:l(()=>[a.suggestedPlayers.length>0?(t(),d(T,{key:0},{default:l(()=>[(t(!0),f(S,null,x(a.suggestedPlayers,o=>(t(),d(B,{key:o.user_id,clickable:"",onClick:c=>a.viewPlayerProfile(o.user_id)},{default:l(()=>[e(g,{avatar:""},{default:l(()=>[e(C,null,{default:l(()=>[u("img",{src:a.getPlayerAvatar(o.photo_url)},null,8,ke)]),_:2},1024)]),_:2},1024),e(g,null,{default:l(()=>[e(v,null,{default:l(()=>[y(h(a.formatPlayerName(o)),1)]),_:2},1024),e(v,{caption:""},{default:l(()=>[y(h(o.category),1)]),_:2},1024)]),_:2},1024),e(g,{side:""},{default:l(()=>[a.isFollowing(o.user_id)?(t(),d(D,{key:1,color:"red",label:"Dejar de seguir",size:"sm",onClick:F(c=>a.unfollowPlayer(o.user_id),["stop"])},null,8,["onClick"])):(t(),d(D,{key:0,color:"primary",label:"Seguir",size:"sm",onClick:F(c=>a.followPlayer(o.user_id),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(t(),f("div",Qe,"No hay sugerencias."))]),_:1})]),_:1},8,["modelValue"])]))]),_:1})]),_:1}),e(p)]),_:1})}var ao=ie(ue,[["render",be]]);export{ao as default};
