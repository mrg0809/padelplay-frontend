import{Q as S}from"./QHeader.08eb5fd8.js";import{bC as M,x as D,r as P,y as j,h as L,a6 as v,o as d,z as I,A as k,d as c,B as t,t as h,a as g,aa as T,ab as B,bs as Q,aT as W,ac as w}from"./index.673cf58d.js";import{Q as z,a as A}from"./QLayout.6bdb52fd.js";import{u as R}from"./use-quasar.8083eaf6.js";import{N as U}from"./NotificationBell.219cf34c.js";import{P as $}from"./PlayerNavigationMenu.a7f813ce.js";import{P as F}from"./PlayerTopMenu.225cb5eb.js";import{B as q}from"./BannerPromoScrolling.adcb119c.js";import{a as b}from"./api.5f33f013.js";import{f as H}from"./dateUtils.5c115d8d.js";import{f as V}from"./hourUtils.51636ade.js";import{u as O}from"./useMeta.6d0d5e17.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBadge.dc3230c9.js";import"./QTabs.decd7594.js";import"./rtl.276c3f1b.js";import"./QFooter.925a22ea.js";import"./QItem.129857ec.js";import"./QList.0e5fa6ef.js";import"./QBtnDropdown.81d386d3.js";import"./QBtnGroup.bf413420.js";import"./QMenu.3db3e33e.js";import"./position-engine.e7dd3b6a.js";import"./selection.3a608fc8.js";import"./haptics.b006d2ba.js";import"./admin.929dac80.js";async function J(r,o,i=500,n={}){var _;if(!r||typeof((_=r.loading)==null?void 0:_.show)!="function"){console.error("runTaskWithMinLoading: Se requiere el objeto $q con el plugin Loading.");try{return await o()}catch(a){throw M.create({type:"negative",message:"Ocurri\xF3 un error inesperado.",caption:a.message}),a}}if(typeof o!="function"){const a=new Error('runTaskWithMinLoading: el par\xE1metro "task" debe ser una funci\xF3n as\xEDncrona.');return console.error(a),Promise.reject(a)}r.loading.show(n);const p=new Promise(a=>setTimeout(a,i));let u,m;const y=o().then(a=>{u=a}).catch(a=>{m=a,console.error("Error durante la ejecuci\xF3n de la tarea en runTaskWithMinLoading:",a),M.create({type:"negative",message:"Fall\xF3 la operaci\xF3n.",caption:(a==null?void 0:a.message)||"Error desconocido"})});try{await Promise.all([y,p])}finally{r.loading.hide()}if(m)throw m;return u}const K=async r=>{try{return(await b.get("/events/player/upcoming_events/")).data}catch(o){return console.error("Error fetching upcoming player events from API:",o),[]}},X=async()=>{var r,o;try{return(o=(r=(await b.get("/padelite/player/upcoming-matches")).data)==null?void 0:r.data)!=null?o:[]}catch(i){return console.error("Error fetching Padelite upcoming matches:",i),[]}};const Y={name:"DashboardPlayer",components:{NotificationBell:U,NavigationMenu:$,PlayerTopMenu:F,BannerPromoScrolling:q},setup(){O({title:"Dashboard"});const r=R(),o=D(),i=P([]),n=P(null),p=P(!0),u=j(),m=[{name:"Reservar cancha",icon:"edit_calendar",image_url:"/menu/reserva.jpeg",route:"reservas"},{name:"Unirse a un partido",icon:"sports_tennis",image_url:"/menu/unirse.jpeg",route:"unete"},{name:"Torneos",icon:"o_emoji_events",image_url:"/menu/torneo.jpeg",route:"torneos"},{name:"Clases de P\xE1del",icon:"o_school",image_url:"/menu/clases.jpeg",route:"reservas"}],y=async()=>await K(u.userId),_=e=>{e.type==="padelite_match"&&e.team_id?o.push(`/padelite/team/${e.team_id}`):e.type==="match"?o.push(`/player/match/${e.id}`):e.type==="lesson"&&e.lesson_type==="private"?o.push(`/player/privatelesson/${e.id}`):e.type==="lesson"&&e.lesson_type==="public"&&o.push(`/player/detallessesion/${e.id}`)},a=e=>{e.name==="Clases de P\xE1del"?o.push({path:`/player/${e.route}`,query:{from:"lessons"}}):o.push(`/player/${e.route}`)},s=e=>e.slice().sort((l,f)=>{const x=l.match_date||l.lesson_date,E=f.match_date||f.lesson_date;if(x!==E)return(x||"").localeCompare(E||"");const C=l.match_time||l.lesson_time||"",N=f.match_time||f.lesson_time||"";return String(C).localeCompare(String(N))});return L(async()=>{p.value=!0,i.value=[];try{const[e,l]=await Promise.all([J(r,y,1500),X()]);i.value=s([...e||[],...l||[]])}catch(e){console.error("Error fetching upcoming events:",e),i.value=[]}finally{p.value=!1}}),{full_name:n,options:m,upcomingEvents:i,isInitiallyLoading:p,formatDate:H,formatTimeWithoutSeconds:V,goToEventDetails:_,navigateTo:a,userStore:u}}},Z={class:"header-content"},ee={class:"greeting"},te={class:"greeting-text"},oe={class:"text-grey"},se={class:"header-icons"},ae={class:"player-container"},ne={class:"home"},re={class:"options-grid"},ie=["onClick"],le=["onClick"],ce={class:"option-overlay"},me={class:"overlay-left"},de={class:"overlay-icon"},pe={class:"overlay-text"},ue={class:"overlay-title"},_e={class:"next-events-section"},he={class:"events-container"},ge={key:0,class:"empty-events"},ye={key:1,class:"events-carousel"},fe=["onClick"],ve={class:"event-info"},Pe={class:"event-date"},ke={class:"event-time"},we={class:"event-club"},xe={class:"event-court"};function Ee(r,o,i,n,p,u){const m=v("NotificationBell"),y=v("PlayerTopMenu"),_=v("BannerPromoScrolling"),a=v("NavigationMenu");return d(),I(z,{view:"hHh lpR fFf"},{default:k(()=>[c(S,{elevated:"",class:"text-white"},{default:k(()=>[t("div",Z,[t("div",ee,[o[1]||(o[1]=t("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"},null,-1)),t("div",te,[o[0]||(o[0]=t("p",null,"Bienvenido",-1)),t("p",oe,h(n.userStore.fullName),1)])]),t("div",se,[c(m),c(y)])]),c(_)]),_:1}),c(A,null,{default:k(()=>[t("div",ae,[t("div",ne,[t("div",re,[(d(!0),g(B,null,T(n.options,s=>(d(),g("div",{key:s.name,class:"option-card",style:Q({backgroundImage:`url(${s.image_url})`}),onClick:e=>n.navigateTo(s)},[t("div",{class:"option-arrow",onClick:W(e=>n.navigateTo(s),["stop"])},[c(w,{name:"arrow_forward",size:"18px"})],8,le),t("div",ce,[t("div",me,[t("div",de,[c(w,{name:s.icon,size:"48px"},null,8,["name"])]),t("div",pe,[t("div",ue,h(s.name),1)])])])],12,ie))),128))]),t("div",_e,[o[3]||(o[3]=t("div",{class:"next-events bg-primary"},[t("h4",{class:"text-black text-weight-bold"},"Mis Eventos:")],-1)),t("div",he,[n.upcomingEvents.length===0&&!n.isInitiallyLoading?(d(),g("div",ge,[...o[2]||(o[2]=[t("div",{class:"q-pa-md text-center text-grey text-weight-bold"}," No tienes pr\xF3ximos eventos registrados. ",-1)])])):(d(),g("div",ye,[(d(!0),g(B,null,T(n.upcomingEvents,s=>{var e,l;return d(),g("div",{key:s.type==="padelite_match"?`padelite-${s.id}`:s.id,class:"event-card",onClick:f=>n.goToEventDetails(s)},[c(w,{name:s.type==="padelite_match"?"emoji_events":s.type==="match"?s.tournament_id?"emoji_events":"sports_tennis":"o_school",class:"event-icon material-icons-outlined",size:"35px"},null,8,["name"]),t("div",ve,[t("p",Pe,h(n.formatDate(s.match_date||s.lesson_date)),1),t("p",ke,h(n.formatTimeWithoutSeconds(s.match_time||s.lesson_time)),1),t("p",we,h(s.type==="padelite_match"?s.tournament_name||"Partido Padelite":(e=s.clubs)==null?void 0:e.name),1),t("p",xe,h((l=s.courts)==null?void 0:l.name),1)])],8,fe)}),128))]))])])])])]),_:1}),c(a)]),_:1})}var Xe=G(Y,[["render",Ee],["__scopeId","data-v-4fe5ca9a"]]);export{Xe as default};
