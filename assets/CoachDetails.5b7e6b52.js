import{Q as R}from"./QHeader.50bc2e62.js";import{a9 as F,F as z,r as S,j as L,B as j,aa as x,q as p,G as C,H as f,v as c,I as o,ab as J,ac as G,s as b,bE as V,x as y,J as k,af as N,ae as q,y as P,ad as W,ag as K}from"./index.2a30a2c5.js";import{Q as U}from"./QSpinnerCube.31bd6ccc.js";import{Q as X}from"./QPage.5044f4b9.js";import{Q as Y,a as Z}from"./QLayout.8d0b6f53.js";import{a as $}from"./coaches.b51ca1e4.js";import{n as ee}from"./navigationUtils.2c4b9dee.js";import{u as ae}from"./summaryStore.b3e7dd7d.js";import{a as te}from"./api.2af71db3.js";import{N as oe}from"./NotificationBell.d95cbc64.js";import{B as le}from"./BannerPromoScrolling.5aa7830c.js";import{P as se}from"./PlayerNavigationMenu.963e5d5c.js";import{_ as re}from"./plugin-vue_export-helper.21dcd24c.js";import"./supabase.aa6636fe.js";import"./pinia.82f3fcef.js";import"./QBadge.e3a9fe90.js";import"./admin.c99b9bfe.js";import"./QTabs.51c705f8.js";import"./rtl.276c3f1b.js";import"./QFooter.6e10ed36.js";const ne=g=>{const n={};for(const h of g){const e=h.day,u=h.start_time,v=h.end_time;if(n[e]=[],u&&v){const[l,D]=u.split(":").map(Number),[_,t]=v.split(":").map(Number);let s=l,r=D;for(;s<_||s===_&&r<t;){const d=`${String(s).padStart(2,"0")}:${String(r).padStart(2,"0")}`;n[e].push(d),r+=60,r>=60&&(s++,r-=60)}}}return n},ie=g=>{const n=[],h=new Date,e=["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"];for(let u=0;u<15;u++){const v=new Date(h);v.setDate(h.getDate()+u);const l=e[v.getDay()];g[l]&&n.push({day:l,date:v,formattedDate:`${v.getDate()}`,month:v.toLocaleString("default",{month:"short"})})}return n};const ce={components:{NotificationBell:oe,BannerPromoScrolling:le,PlayerNavigationMenu:se},setup(){const g=F(),n=z(),h=ae(),e=g.params.coachId,u=g.query.clubId,v=g.query.clubName,l=S(null),D=S({}),_=S(null),t=S([]),s=S(null),r=S(null),d=S(null),Q=L(()=>{if(!l.value)return[];const a=[];return l.value.price_for_one!=null&&a.push({people:1,price:l.value.price_for_one,label:"1"}),l.value.price_for_two!=null&&a.push({people:2,price:l.value.price_for_two,label:"2"}),l.value.price_for_three!=null&&a.push({people:3,price:l.value.price_for_three,label:"3"}),l.value.price_for_four!=null&&a.push({people:4,price:l.value.price_for_four,label:"4"}),a}),B=async()=>{l.value=null,r.value=null,_.value=null,d.value=null,s.value=null;try{const a=await $(e,u);l.value=a,a!=null&&a.availability?(D.value=ne(a.availability),t.value=ie(D.value,14)):t.value=[]}catch(a){console.error("Error al cargar detalles del coach:",a)}},I=a=>{var T;const m=t.value.find(i=>i.date.getTime()===a.getTime());m&&m.date.getTime()!==((T=r.value)==null?void 0:T.date.getTime())&&(r.value=m,_.value=null,d.value=null,s.value=null,E())},O=a=>{_.value=a,d.value=null},M=a=>{d.value=a},E=async()=>{var a;if(!r.value||!u||!e){s.value=[];return}s.value=null;try{const m=await te.get("/lessons/available-times",{params:{club_id:u,date:r.value.date.toISOString().split("T")[0],coach_id:e}});if((a=m.data)!=null&&a.available_times){const T=new Set;Object.values(m.data.available_times).forEach(i=>{Array.isArray(i)&&i.forEach(w=>T.add(w))}),s.value=Array.from(T).sort()}else s.value=[]}catch(m){console.error("Error fetching available times:",m),s.value=[]}},H=()=>{const a=l.value,m=r.value,T=_.value,i=d.value,w=u,A={summaryTitle:"Resumen de Entrenamiento",itemDetails:[{label:"Club",value:v||"No especificado"},{label:"Coach",value:(a==null?void 0:a.name)||"No especificado"},{label:"Fecha",value:(m==null?void 0:m.date.toISOString().split("T")[0])||"No especificada"},{label:"Horario",value:`${T} hrs.`||"No especificada"},{label:"Duraci\xF3n",value:"60 minutos"},{label:"Participantes",value:(i==null?void 0:i.people)||0}],baseData:{clubId:w,price:(i==null?void 0:i.price)||0,participants:(i==null?void 0:i.people)||1,type:"class",id:a==null?void 0:a.id},allowPaymentSplit:!0,showPublicToggle:!1,commissionRate:4,extraData:{coachFocus:a==null?void 0:a.coach_focus}};h.setSummaryDetails(A),n.push({name:"OrderSummary"})};return j(B),{coach:l,selectedTime:_,selectTime:O,availableDates:t,selectedDate:r,selectDay:I,availableTimes:s,priceOptions:Q,selectedPriceOption:d,selectPriceOption:M,proceedToSummary:H,goToDashboard:()=>{ee(n,userStore)}}}},ue={class:"header-content"},de={class:"greeting"},me={class:"header-icons"},pe={key:0,class:"q-pa-md q-gutter-md"},ve={class:"text-center q-mb-md"},_e=["src"],fe={class:"q-mt-lg days-container"},he={class:"days-scroll"},ge={class:"month-label"},be={key:0,class:"q-mt-md"},ye={class:"time-slots"},Te={key:1,class:"q-mt-md"},Se={class:"price-options-container"},De={class:"column text-left"},ke={class:"row items-center"},Ce={class:"text-h6"},we={class:"text-caption text-white"},xe={key:2,class:"q-mt-lg text-center"},Ne={key:1,class:"q-pa-md text-center"};function qe(g,n,h,e,u,v){const l=x("NotificationBell"),D=x("BannerPromoScrolling"),_=x("PlayerNavigationMenu");return p(),C(Y,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:f(()=>[c(R,{elevated:"",class:"text-white"},{default:f(()=>[o("div",ue,[o("div",de,[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:n[0]||(n[0]=(...t)=>e.goToDashboard&&e.goToDashboard(...t))})]),o("div",me,[c(l)])]),c(D)]),_:1}),c(Z,{class:"home"},{default:f(()=>[c(X,{class:"q-pa-md"},{default:f(()=>[c(J,null,{default:f(()=>[c(G,null,{default:f(()=>[e.coach?(p(),b("div",pe,[o("div",ve,[c(V,{size:"200px"},{default:f(()=>{var t;return[o("img",{src:((t=e.coach.players)==null?void 0:t.photo_url)||"default-avatar.png"},null,8,_e)]}),_:1})]),o("h3",null,y(e.coach.name),1),o("p",null,"Especialidad: "+y(e.coach.coach_focus),1),o("p",null,"Resumen: "+y(e.coach.coach_resume),1),o("div",fe,[c(k,{flat:"",round:"",icon:"arrow_back",size:"xs"}),o("div",he,[(p(!0),b(N,null,q(e.availableDates,(t,s)=>{var r,d;return p(),C(k,{key:s,name:s,outline:((r=e.selectedDate)==null?void 0:r.date.getTime())!==t.date.getTime(),color:((d=e.selectedDate)==null?void 0:d.date.getTime())===t.date.getTime()?"green":"white",class:"day-button",onClick:Q=>e.selectDay(t.date)},{default:f(()=>[o("div",null,y(t.formattedDate),1),o("div",ge,y(t.month),1)]),_:2},1032,["name","outline","color","onClick"])}),128))]),c(k,{flat:"",round:"",icon:"arrow_forward",size:"xs"})]),e.availableTimes&&e.selectedDate?(p(),b("div",be,[n[1]||(n[1]=o("h4",null,"Horarios Disponibles:",-1)),o("div",ye,[(p(!0),b(N,null,q(e.availableTimes,t=>(p(),C(k,{key:t,onClick:s=>e.selectTime(t),color:e.selectedTime===t?"green":"white",outline:e.selectedTime!==t,class:"time-option-btn"},{default:f(()=>[W(y(t),1)]),_:2},1032,["onClick","color","outline"]))),128))])])):P("",!0),e.selectedTime&&e.priceOptions&&e.priceOptions.length>0?(p(),b("div",Te,[n[2]||(n[2]=o("h4",null,"Selecciona el n\xFAmero de personas:",-1)),o("div",Se,[(p(!0),b(N,null,q(e.priceOptions,t=>{var s,r;return p(),C(k,{key:t.people,onClick:d=>e.selectPriceOption(t),color:((s=e.selectedPriceOption)==null?void 0:s.people)===t.people?"green":"secondary",outline:((r=e.selectedPriceOption)==null?void 0:r.people)!==t.people,class:"price-option-btn",padding:"sm"},{default:f(()=>[o("div",De,[o("div",ke,[o("span",Ce,y(t.label),1),c(K,{name:"group",class:"q-mr-xs"})]),o("span",we,"$"+y(t.price.toFixed(2)),1)])]),_:2},1032,["onClick","color","outline"])}),128))])])):P("",!0),e.selectedPriceOption?(p(),b("div",xe,[c(k,{color:"green",label:"Continuar Reserva",onClick:e.proceedToSummary,class:"full-width",size:"md"},null,8,["onClick"])])):P("",!0)])):(p(),b("div",Ne,[c(U,{color:"orange",size:"5.5em"}),n[3]||(n[3]=o("p",{class:"q-mt-md"},"Cargando detalles del coach...",-1))]))]),_:1})]),_:1})]),_:1}),c(_)]),_:1})]),_:1})}var Ye=re(ce,[["render",qe],["__scopeId","data-v-07250fa4"]]);export{Ye as default};
