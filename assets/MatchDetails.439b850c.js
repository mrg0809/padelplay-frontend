import{Q as pe}from"./QHeader.c54c4dab.js";import{Q as ye}from"./QSpinnerDots.a5145f25.js";import{a7 as fe,F as ge,r as u,B as ve,bB as Q,a8 as w,q as t,G as m,H as i,v as s,I as o,y as P,s as n,a9 as B,aa as I,J as b,ae as V,ab as x,x as d,bC as N,ad as z,ac as A,K as F,Q as _e,af as he,ag as be,ah as ke}from"./index.743d29a7.js";import{Q as xe}from"./QPage.399b9a9b.js";import{Q as Ce,a as we}from"./QLayout.166d0f49.js";import{Q as R}from"./QItemLabel.7f11a839.js";import{Q as Pe,a as X}from"./QItem.bb9945a3.js";import{Q as De}from"./QList.c022c1d9.js";import{C as Me}from"./ClosePopup.951eef86.js";import{a as Y}from"./api.2af71db3.js";import{u as Qe}from"./use-quasar.cb0f3cc7.js";import{u as Se}from"./userStore.816e15f7.js";import{P as Ve}from"./PlayerNavigationMenu.8bca405a.js";import{B as Ne}from"./BannerPromoScrolling.4460955c.js";import{N as qe}from"./NotificationBell.9de04b9a.js";import{P as Ee}from"./PlayerTopMenu.8f53381e.js";import{D as je}from"./DesktopNavigation.f275b32b.js";import{C as Te}from"./ClubTopMenu.109bef8f.js";import{C as Be}from"./ClubNavigationMenu.4add66c8.js";import{s as Ie}from"./players.e69560cb.js";import{f as ze}from"./community.ed745a42.js";import{s as Ae}from"./shareUtils.421200a3.js";import{_ as Ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.85866dd7.js";import"./QTabs.243f63db.js";import"./rtl.276c3f1b.js";import"./QFooter.962d26d2.js";import"./admin.c99b9bfe.js";import"./QBadge.de4b017c.js";import"./QBtnDropdown.d13c71af.js";import"./QMenu.8b53cacd.js";import"./position-engine.bd78d608.js";import"./selection.93b2e93c.js";import"./QTooltip.eec396fd.js";import"./supabase.846d8680.js";const Je={components:{BannerPromoScrolling:Ne,NotificationBell:qe,PlayerNavigationMenu:Ve,PlayerTopMenu:Ee,DesktopNavigation:je,ClubTopMenu:Te,ClubNavigationMenu:Be},setup(){const f=fe(),a=ge(),p=Qe(),e=Se(),c=u(null),k=u([]),q=u([]),E=u(!0),D=u(""),j=u(null),T=u(null),S=u(!1),C=u(!1),r=u([]),y=u([]),g=u([]),L=u([{name:"Set 1",team1score:null,team2score:null},{name:"Set 2",team1score:null,team2score:null},{name:"Set 3",team1score:null,team2score:null}]),U=u(!1),Z=()=>{var _,h;if(!((_=c.value)!=null&&_.match_date)||!((h=c.value)!=null&&h.match_time)){U.value=!1;return}const l=Q(`${c.value.match_date} ${c.value.match_time}`),v=Q();U.value=v.isAfter(l)},H=async()=>{try{const l=await Y.get(`/matches/match/${f.params.matchId}`);c.value=l.data,k.value=l.data.team1_players||[],q.value=l.data.team2_players||[],Z()}catch(l){console.error("Error al cargar los detalles del partido:",l.message),p.notify({type:"negative",message:"Error al cargar los detalles del partido."})}finally{E.value=!1}},$={primera:"1\xBA",segunda:"2\xBA",tercera:"3\xBA",cuarta:"4\xBA",quinta:"5\xBA",sexta:"6\xBA"};function ee(l){return $[l==null?void 0:l.toLowerCase()]||l}const ae=l=>{if(!l){console.warn("Cannot navigate to player profile: playerId is undefined"),p.notify({type:"warning",message:"No se puede acceder al perfil de este jugador"});return}J.value?a.push(`/player/${l}?from=club`):a.push(`/player/${l}`)},te=async(l,v)=>{j.value=l,T.value=v,D.value="",r.value=[],S.value=!0,await oe()},oe=async()=>{try{C.value=!0;const l=await ze(e.userId);y.value=l.slice(0,4),g.value=y.value}catch(l){console.error("Error loading suggested players:",l),y.value=[],g.value=[]}finally{C.value=!1}},le=async()=>{if(D.value.trim()===""){g.value=y.value;return}try{C.value=!0;const l=await Ie(D.value);r.value=l,g.value=l}catch(l){console.error("Error searching players:",l),r.value=[],g.value=[]}finally{C.value=!1}},se=async l=>{var v,_;try{const h={email_or_phone:l.user_id,match_id:f.params.matchId,team:j.value,position:T.value,club_name:c.value.club_name||"No especificado",player_name:l.first_name||"Jugador desconocido",match_date:c.value.match_date||"Fecha desconocida",match_time:c.value.match_time||"Hora desconocida"},M=await Y.post("/matches/add-player",h);M.data.status==="success"?(p.notify({type:"positive",message:"Jugador agregado exitosamente."}),H()):M.data.status==="invited"&&p.notify({type:"info",message:"Jugador invitado a unirse a PadelPlay."}),S.value=!1}catch(h){console.error("Error al agregar jugador:",h.message),p.notify({type:"negative",message:((_=(v=h.response)==null?void 0:v.data)==null?void 0:_.detail)||"Error al agregar jugador."})}},re=async()=>{try{await Y.put(`/matches/match/${f.params.matchId}`,{score:L.value}),p.notify({type:"positive",message:"Resultado guardado exitosamente."})}catch(l){console.error("Error al guardar el resultado:",l.message),p.notify({type:"negative",message:"Error al guardar el resultado."})}},ie=async()=>{var l,v;try{const _=`${window.location.origin}/join/match/${f.params.matchId}`,h="Te invitamos a este gran juego";let M="";if(c.value&&c.value.match_date){Q.locale("es-mx");const ce=Q(c.value.match_date).format("dddd, D [de] MMMM [del] YYYY"),[K,W]=ce.split(" de "),me=K.charAt(0).toUpperCase()+K.slice(1),ue=W.charAt(0).toUpperCase()+W.slice(1);M=me+" de "+ue}const G=((l=c.value)==null?void 0:l.club_name)||"nuestro club",O=(v=c.value)!=null&&v.match_time?c.value.match_time.slice(0,5):"",de=M&&O?`\xA1\xDAnete a este partido de p\xE1del en ${G}! ${M} a las ${O} hrs.`:`\xA1\xDAnete a este partido de p\xE1del en ${G}!`;await Ae(h,_,de)}catch(_){console.error("Error al compartir el partido:",_),p.notify({type:"negative",message:"Error al compartir el partido."})}},ne=()=>{a.back()},J=u(!1);return ve(()=>{f.query.from==="club"&&(J.value=!0),H()}),{matchDetails:c,team1:k,team2:q,loading:E,scoreTable:L,addPlayerDialog:S,searchInput:D,searchingPlayers:C,displayedPlayers:g,openAddPlayerDialog:te,searchPlayers:le,selectPlayer:se,saveScore:re,shareMatch:ie,goBack:ne,formatCategory:ee,viewPlayerProfile:ae,isClubView:J,canEditScore:U}},methods:{openChat(){this.$router.push(`/matches/${this.$route.params.matchId}/chat`)},formatDate(f){Q.locale("es-mx");const a=Q(f).format("dddd, D [de] MMMM [del] YYYY"),[p,e]=a.split(" de "),c=p.charAt(0).toUpperCase()+p.slice(1),k=e.charAt(0).toUpperCase()+e.slice(1);return c+" de "+k},goToMaps(){const f=this.matchDetails.latitude,a=this.matchDetails.longitude;if(f&&a){const p=`https://www.google.com/maps?q=${f},${a}`;window.open(p,"_blank")}else this.$q.notify({message:"Ubicaci\xF3n no disponible",color:"negative",position:"top"})}}},Fe={class:"header-content"},Re={class:"header-icons"},Ye={key:0,class:"text-center"},Le={key:1},He={class:"row items-center",style:{position:"relative",width:"100%","margin-bottom":"20px"}},Ge={class:"row",style:{position:"absolute",right:"0"}},Oe={class:"court-container"},Ke={class:"court"},We={class:"player team1-player1"},Xe=["src"],Ze={key:1},$e={class:"text-caption"},ea={class:"player team1-player2"},aa=["src"],ta={key:1},oa={class:"text-caption"},la={class:"player team2-player1"},sa=["src"],ra={key:1},ia={class:"text-caption"},na={class:"player team2-player2"},da=["src"],ca={key:1},ma={class:"text-caption"},ua={key:0,class:"text-center text-grey q-mb-md"},pa={class:"score-grid"},ya={key:0,class:"text-center q-pa-md"},fa=["src"],ga={key:2,class:"text-center text-grey-5 q-pa-md"};function va(f,a,p,e,c,k){const q=w("NotificationBell"),E=w("PlayerTopMenu"),D=w("ClubTopMenu"),j=w("BannerPromoScrolling"),T=w("DesktopNavigation"),S=w("ClubNavigationMenu"),C=w("PlayerNavigationMenu");return t(),m(Ce,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:i(()=>[s(pe,{elevated:"",class:"text-white"},{default:i(()=>[o("div",Fe,[a[10]||(a[10]=o("div",{class:"greeting"},[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})],-1)),o("div",Re,[s(q),e.isClubView?P("",!0):(t(),m(E,{key:0})),e.isClubView?(t(),m(D,{key:1})):P("",!0)])]),s(j)]),_:1}),e.isClubView?P("",!0):(t(),m(T,{key:0})),e.isClubView?(t(),m(S,{key:1})):P("",!0),s(we,null,{default:i(()=>[s(xe,{class:"q-pa-md"},{default:i(()=>[e.loading?(t(),n("div",Ye,[s(ye,{color:"primary",size:"xl"})])):(t(),n("div",Le,[s(B,{class:"text-white q-pa-md match-card"},{default:i(()=>[s(I,null,{default:i(()=>[o("div",He,[s(b,{flat:"",onClick:e.shareMatch,style:{position:"absolute",left:"0"}},{default:i(()=>[s(V,{name:"o_share",size:"md"})]),_:1},8,["onClick"]),a[11]||(a[11]=o("h3",{class:"text-h5 text-white",style:{flex:"1",margin:"0","text-align":"center"}},"Reserva",-1)),o("div",Ge,[s(b,{flat:"",onClick:k.openChat},{default:i(()=>[s(V,{name:"o_chat",size:"md"})]),_:1},8,["onClick"])])]),o("p",null,[x(" Juegas en el club "+d(e.matchDetails.club_name||"No disponible")+" ",1),s(b,{size:"sm",flat:"",round:"",color:"orange",icon:"o_location_on",onClick:k.goToMaps},null,8,["onClick"]),x(" el dia "+d(k.formatDate(e.matchDetails.match_date))+" a las "+d(e.matchDetails.match_time.slice(0,5))+" hrs. En la cancha "+d(e.matchDetails.court_name||"No disponible")+". ",1)]),a[12]||(a[12]=o("p",null,[x("Categoria jugadores: Abierto"),o("br"),x(" Tipo de partido: Cerrado"),o("br")],-1))]),_:1})]),_:1}),s(B,{class:"match-card text-white q-pa-md"},{default:i(()=>[s(I,{class:"q-mt-md"},{default:i(()=>[a[19]||(a[19]=o("h3",{class:"text-center text-white"},"Jugadores",-1)),o("div",Oe,[o("div",Ke,[o("div",We,[e.team1[0]?(t(),n("div",{key:0,onClick:a[0]||(a[0]=r=>e.viewPlayerProfile(e.team1[0].user_id)),class:"clickable-player"},[e.team1[0].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team1[0].photo_url,alt:"Foto del jugador"},null,8,Xe)]),_:1})):(t(),n("span",Ze,d(e.team1[0].first_name||"Jugador 1 Equipo 1"),1)),o("div",$e,d(e.team1[0].first_name)+" - "+d(e.formatCategory(e.team1[0].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[1]||(a[1]=r=>e.openAddPlayerDialog(1,0))}))]),o("div",ea,[e.team1[1]?(t(),n("div",{key:0,onClick:a[2]||(a[2]=r=>e.viewPlayerProfile(e.team1[1].user_id)),class:"clickable-player"},[e.team1[1].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team1[1].photo_url,alt:"Foto del jugador"},null,8,aa)]),_:1})):(t(),n("span",ta,d(e.team1[1].first_name||"Jugador 2 Equipo 1"),1)),o("div",oa,d(e.team1[1].first_name)+" - "+d(e.formatCategory(e.team1[1].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[3]||(a[3]=r=>e.openAddPlayerDialog(1,1))}))]),o("div",la,[e.team2[0]?(t(),n("div",{key:0,onClick:a[4]||(a[4]=r=>e.viewPlayerProfile(e.team2[0].user_id)),class:"clickable-player"},[e.team2[0].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team2[0].photo_url,alt:"Foto del jugador"},null,8,sa)]),_:1})):(t(),n("span",ra,d(e.team2[0].first_name||"Jugador 1 Equipo 2"),1)),o("div",ia,d(e.team2[0].first_name)+" - "+d(e.formatCategory(e.team2[0].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[5]||(a[5]=r=>e.openAddPlayerDialog(2,0))}))]),o("div",na,[e.team2[1]?(t(),n("div",{key:0,onClick:a[6]||(a[6]=r=>e.viewPlayerProfile(e.team2[1].user_id)),class:"clickable-player"},[e.team2[1].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team2[1].photo_url,alt:"Foto del jugador"},null,8,da)]),_:1})):(t(),n("span",ca,d(e.team2[1].first_name||"Jugador 2 Equipo 2"),1)),o("div",ma,d(e.team2[1].first_name)+" - "+d(e.formatCategory(e.team2[1].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[7]||(a[7]=r=>e.openAddPlayerDialog(2,1))}))]),a[13]||(a[13]=o("div",{class:"line1"},null,-1)),a[14]||(a[14]=o("div",{class:"player parejaA vertical-text"},"Pareja A",-1)),a[15]||(a[15]=o("div",{class:"net"},null,-1)),a[16]||(a[16]=o("div",{class:"line2"},null,-1)),a[17]||(a[17]=o("div",{class:"player parejaB vertical-text"},"Pareja B",-1)),a[18]||(a[18]=o("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1}),s(B,{class:"match-card text-white q-pa-md"},{default:i(()=>[s(I,{class:"score-input"},{default:i(()=>[a[24]||(a[24]=o("h3",{class:"text-center text-white"},"Resultado",-1)),e.canEditScore?P("",!0):(t(),n("div",ua,[s(V,{name:"info",size:"sm",class:"q-mr-xs"}),a[20]||(a[20]=x(" Los resultados solo pueden ser ingresados despu\xE9s del partido "))])),o("div",pa,[a[21]||(a[21]=o("div",{class:"header"},null,-1)),(t(!0),n(z,null,A(e.scoreTable,(r,y)=>(t(),n("div",{class:"header",key:"header-"+y}," Set "+d(y+1),1))),128)),a[22]||(a[22]=o("div",{class:"team-label"},"Pareja A",-1)),(t(!0),n(z,null,A(e.scoreTable,(r,y)=>(t(),n("div",{key:"team1-"+y,class:"score-cell"},[s(F,{modelValue:r.team1score,"onUpdate:modelValue":g=>r.team1score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,disable:!e.canEditScore,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","disable"])]))),128)),a[23]||(a[23]=o("div",{class:"team-label"},"Pareja B",-1)),(t(!0),n(z,null,A(e.scoreTable,(r,y)=>(t(),n("div",{key:"team2-"+y,class:"score-cell"},[s(F,{modelValue:r.team2score,"onUpdate:modelValue":g=>r.team2score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,disable:!e.canEditScore,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","disable"])]))),128))]),s(b,{label:"Guardar Resultado",color:"primary",class:"q-mt-md",disable:!e.canEditScore,onClick:e.saveScore},null,8,["disable","onClick"])]),_:1})]),_:1})]))]),_:1})]),_:1}),s(ke,{modelValue:e.addPlayerDialog,"onUpdate:modelValue":a[9]||(a[9]=r=>e.addPlayerDialog=r)},{default:i(()=>[s(B,{style:{"min-width":"300px","max-width":"500px",width:"90vw"},class:"bg-black text-white"},{default:i(()=>[s(I,null,{default:i(()=>[a[26]||(a[26]=o("div",{class:"text-h6"},"Agregar Jugador",-1)),s(F,{modelValue:e.searchInput,"onUpdate:modelValue":[a[8]||(a[8]=r=>e.searchInput=r),e.searchPlayers],label:"Buscar por nombre",outlined:"",dense:"",class:"q-mb-md"},{prepend:i(()=>[s(V,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"]),e.searchingPlayers?(t(),n("div",ya,[s(_e,{color:"primary",size:"md"})])):e.displayedPlayers.length>0?(t(),m(De,{key:1,bordered:"",separator:"",class:"rounded-borders"},{default:i(()=>[e.searchInput?P("",!0):(t(),m(R,{key:0,header:"",class:"text-white"},{default:i(()=>a[25]||(a[25]=[x("Sugerencias")])),_:1})),(t(!0),n(z,null,A(e.displayedPlayers,r=>(t(),m(Pe,{key:r.user_id,clickable:"",onClick:y=>e.selectPlayer(r),class:"text-white"},{default:i(()=>[s(X,{avatar:""},{default:i(()=>[s(N,{size:"48px"},{default:i(()=>[r.photo_url?(t(),n("img",{key:0,src:r.photo_url,alt:"Foto del jugador"},null,8,fa)):(t(),m(V,{key:1,name:"person",size:"48px"}))]),_:2},1024)]),_:2},1024),s(X,null,{default:i(()=>[s(R,{class:"text-white"},{default:i(()=>[x(d(r.first_name)+" "+d(r.last_name),1)]),_:2},1024),s(R,{caption:"",class:"text-grey-5"},{default:i(()=>[x(d(e.formatCategory(r.category)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):e.searchInput?(t(),n("div",ga," No se encontraron jugadores ")):P("",!0)]),_:1}),s(he,{align:"right"},{default:i(()=>[be(s(b,{flat:"",label:"Cancelar",color:"negative"},null,512),[[Me]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(C)]),_:1})}var $a=Ue(Je,[["render",va],["__scopeId","data-v-3ad9d831"]]);export{$a as default};
