import{Q as F}from"./QHeader.289f0645.js";import{x as T,r as k,f as g,h as X,o as n,z as l,A as t,d as e,B as o,a as D,a7 as h,a8 as x,t as i,e as v,Q as H,ac as R,aa as U,ab as Y,bE as L,a9 as c,aP as $}from"./index.687b44e8.js";import{Q as j,a as y}from"./QItem.eb9291fb.js";import{Q as d}from"./QItemLabel.bbebea39.js";import{Q as G}from"./QList.1288e946.js";import{Q as J}from"./QPage.fcc9aae1.js";import{Q as K,a as O}from"./QLayout.30990248.js";import{u as W}from"./use-quasar.ba375293.js";import{a as Z,A as tt}from"./AssociationTopMenu.c2c9d0dc.js";import{N as et}from"./NotificationBell.9fdba392.js";import{B as at}from"./BannerPromoScrolling.1700e538.js";import{l as st}from"./association.b92d73c6.js";import{_ as ot}from"./plugin-vue_export-helper.21dcd24c.js";import"./QTabs.979bee57.js";import"./rtl.276c3f1b.js";import"./QFooter.b7b22f15.js";import"./QBtnDropdown.17175f2e.js";import"./QBtnGroup.6b9d07ee.js";import"./QMenu.df8dfc7c.js";import"./position-engine.46674690.js";import"./selection.0f785986.js";import"./haptics.57409bd0.js";import"./QBadge.0c3a126f.js";import"./api.1c42dce4.js";const rt={class:"header-content"},nt={class:"header-icons"},it={key:0,class:"row q-col-gutter-md q-mb-md"},lt={class:"col-12 col-sm-6"},ct={class:"text-h4 text-primary"},dt={class:"text-caption text-grey"},ut={class:"col-12 col-sm-6"},mt={class:"text-h4 text-primary"},pt={class:"text-caption text-grey"},ft=["src","alt"],_t={class:"text-right"},gt={__name:"AssociationAfiliados",setup(ht){const C=W(),E=T(),p=k(!0),u=k([]),b=new Date,f=b.getFullYear(),_=b.getMonth(),w=new Date(f,_,1),S=new Date(f,_+1,0,23,59,59),A=new Date(f,_-1,1),q=new Date(f,_,0,23,59,59),Q=(r,a,s)=>{if(!r)return!1;const m=new Date(r);return m>=a&&m<=s},B=g(()=>u.value.filter(r=>Q(r.affiliation_date,w,S)).length),N=g(()=>u.value.filter(r=>Q(r.affiliation_date,A,q)).length),I=g(()=>w.toLocaleDateString("es-MX",{month:"long",year:"numeric"})),P=g(()=>A.toLocaleDateString("es-MX",{month:"long",year:"numeric"})),z=()=>E.push("/dashboard/association"),M=r=>r?new Date(r).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric"}):"",V=r=>{if(!r)return!1;const a=new Date(r),s=new Date,m=Math.ceil((a-s)/(1e3*60*60*24));return m<=30&&m>=0};return X(async()=>{var r,a;p.value=!0;try{const s=await st();u.value=s.data||[]}catch(s){console.error("Error loading affiliates:",s),C.notify({type:"negative",message:((a=(r=s.response)==null?void 0:r.data)==null?void 0:a.detail)||"Error al cargar afiliados"}),u.value=[]}finally{p.value=!1}}),(r,a)=>(n(),l(K,{view:"hHh lpR fFf",class:"text-white"},{default:t(()=>[e(F,{elevated:"",class:"text-white"},{default:t(()=>[o("div",rt,[o("div",{class:"greeting"},[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:z}),a[0]||(a[0]=o("span",{class:"text-subtitle1"},"Afiliados",-1))]),o("div",nt,[e(et),e(Z)])]),e(at)]),_:1}),e(O,null,{default:t(()=>[e(J,{class:"q-pa-md"},{default:t(()=>[a[6]||(a[6]=o("div",{class:"text-h5 q-mb-md"},"Afiliados",-1)),p.value?v("",!0):(n(),D("div",it,[o("div",lt,[e(h,{flat:"",bordered:"",class:"bg-grey-9 text-white info-card"},{default:t(()=>[e(x,{class:"text-center"},{default:t(()=>[a[1]||(a[1]=o("div",{class:"text-caption text-grey"},"Afiliaciones mes actual",-1)),o("div",ct,i(B.value),1),o("div",dt,i(I.value),1)]),_:1})]),_:1})]),o("div",ut,[e(h,{flat:"",bordered:"",class:"bg-grey-9 text-white info-card"},{default:t(()=>[e(x,{class:"text-center"},{default:t(()=>[a[2]||(a[2]=o("div",{class:"text-caption text-grey"},"Afiliaciones mes anterior",-1)),o("div",mt,i(N.value),1),o("div",pt,i(P.value),1)]),_:1})]),_:1})])])),p.value?(n(),l(h,{key:1,flat:"",bordered:"",class:"bg-grey-9 text-white"},{default:t(()=>[e(x,{class:"text-center"},{default:t(()=>[e(H,{color:"primary",size:"40px"})]),_:1})]),_:1})):u.value.length?(n(),l(G,{key:3,bordered:"",class:"rounded-borders bg-transparent"},{default:t(()=>[(n(!0),D(Y,null,U(u.value,s=>(n(),l(j,{key:s.id,class:"q-mb-sm bg-grey-9"},{default:t(()=>[e(y,{avatar:""},{default:t(()=>[s.photo_url?(n(),l(L,{key:0},{default:t(()=>[o("img",{src:s.photo_url,alt:s.player_name},null,8,ft)]),_:2},1024)):(n(),l(L,{key:1,color:"primary","text-color":"white"},{default:t(()=>[c(i(s.player_name.charAt(0).toUpperCase()),1)]),_:2},1024))]),_:2},1024),e(y,null,{default:t(()=>[e(d,{class:"text-weight-medium"},{default:t(()=>[c(i(s.player_name),1)]),_:2},1024),s.email?(n(),l(d,{key:0,caption:""},{default:t(()=>[c(i(s.email),1)]),_:2},1024)):v("",!0),s.phone?(n(),l(d,{key:1,caption:""},{default:t(()=>[c(i(s.phone),1)]),_:2},1024)):v("",!0)]),_:2},1024),e(y,{side:""},{default:t(()=>[o("div",_t,[e(d,{caption:"",class:"text-grey"},{default:t(()=>[...a[4]||(a[4]=[c("Afiliado desde",-1)])]),_:1}),e(d,{class:"text-weight-medium"},{default:t(()=>[c(i(M(s.affiliation_date)),1)]),_:2},1024),e(d,{caption:"",class:"text-grey q-mt-xs"},{default:t(()=>[...a[5]||(a[5]=[c("Expira",-1)])]),_:1}),e(d,{class:$(V(s.expiration_date)?"text-negative":"")},{default:t(()=>[c(i(M(s.expiration_date)),1)]),_:2},1032,["class"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),l(h,{key:2,flat:"",bordered:"",class:"bg-grey-9 text-white"},{default:t(()=>[e(x,{class:"text-center"},{default:t(()=>[e(R,{name:"o_groups",size:"48px",class:"q-mb-sm"}),a[3]||(a[3]=o("p",null,"No hay afiliados registrados.",-1))]),_:1})]),_:1}))]),_:1})]),_:1}),e(tt)]),_:1}))}};var Rt=ot(gt,[["__scopeId","data-v-09a8c51a"]]);export{Rt as default};
