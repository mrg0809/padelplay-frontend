import{Q as me}from"./QHeader.1d41df4b.js";import{Q as ue}from"./QSpinnerDots.52063b1d.js";import{a7 as pe,F as ye,r as p,B as fe,bB as S,a8 as x,q as o,G as c,H as i,v as r,I as t,y as M,s as n,a9 as T,aa as I,J as v,ae as z,ab as b,x as d,bC as V,ad as A,ac as E,K as J,Q as ge,af as ve,ag as _e,ah as he}from"./index.44ff7f36.js";import{Q as ke}from"./QPage.01f0db4e.js";import{Q as xe,a as be}from"./QLayout.36e57c24.js";import{Q as F}from"./QItemLabel.07b36e9b.js";import{Q as Ce,a as W}from"./QItem.ca93871c.js";import{Q as we}from"./QList.843a2d7e.js";import{C as Pe}from"./ClosePopup.8af65d55.js";import{a as R}from"./api.2af71db3.js";import{u as De}from"./use-quasar.5b0bf7b9.js";import{u as Me}from"./userStore.c05073cd.js";import{P as Qe}from"./PlayerNavigationMenu.073d5db4.js";import{B as Ve}from"./BannerPromoScrolling.38e1cc22.js";import{N as Ne}from"./NotificationBell.d889e136.js";import{P as je}from"./PlayerTopMenu.0772c7da.js";import{D as qe}from"./DesktopNavigation.70841f70.js";import{C as Be}from"./ClubTopMenu.c328ae07.js";import{C as Se}from"./ClubNavigationMenu.8b6e6cad.js";import{s as Te}from"./players.b9c68a0f.js";import{f as Ie}from"./community.df7f253b.js";import{s as ze}from"./shareUtils.4a0e3388.js";import{_ as Ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.75ba5c8c.js";import"./QTabs.b7b4d746.js";import"./rtl.276c3f1b.js";import"./QFooter.f84d141a.js";import"./admin.c99b9bfe.js";import"./QBadge.dc626f3f.js";import"./QBtnDropdown.7d36efe6.js";import"./QMenu.75efc905.js";import"./position-engine.6138d72b.js";import"./selection.fc24a828.js";import"./QTooltip.81e13844.js";import"./supabase.62935925.js";const Ee={components:{BannerPromoScrolling:Ve,NotificationBell:Ne,PlayerNavigationMenu:Qe,PlayerTopMenu:je,DesktopNavigation:qe,ClubTopMenu:Be,ClubNavigationMenu:Se},setup(){const f=pe(),a=ye(),m=De(),e=Me(),u=p(null),_=p([]),N=p([]),j=p(!0),C=p(""),q=p(null),B=p(null),Q=p(!1),h=p(!1),s=p([]),y=p([]),g=p([]),Y=p([{name:"Set 1",team1score:0,team2score:0},{name:"Set 2",team1score:0,team2score:0},{name:"Set 3",team1score:0,team2score:0}]),L=async()=>{try{const l=await R.get(`/matches/match/${f.params.matchId}`);u.value=l.data,_.value=l.data.team1_players||[],N.value=l.data.team2_players||[]}catch(l){console.error("Error al cargar los detalles del partido:",l.message),m.notify({type:"negative",message:"Error al cargar los detalles del partido."})}finally{j.value=!1}},X={primera:"1\xBA",segunda:"2\xBA",tercera:"3\xBA",cuarta:"4\xBA",quinta:"5\xBA",sexta:"6\xBA"};function Z(l){return X[l==null?void 0:l.toLowerCase()]||l}const $=l=>{if(!l){console.warn("Cannot navigate to player profile: playerId is undefined"),m.notify({type:"warning",message:"No se puede acceder al perfil de este jugador"});return}U.value?a.push(`/player/${l}?from=club`):a.push(`/player/${l}`)},ee=async(l,k)=>{q.value=l,B.value=k,C.value="",s.value=[],Q.value=!0,await ae()},ae=async()=>{try{h.value=!0;const l=await Ie(e.userId);y.value=l.slice(0,4),g.value=y.value}catch(l){console.error("Error loading suggested players:",l),y.value=[],g.value=[]}finally{h.value=!1}},te=async()=>{if(C.value.trim()===""){g.value=y.value;return}try{h.value=!0;const l=await Te(C.value);s.value=l,g.value=l}catch(l){console.error("Error searching players:",l),s.value=[],g.value=[]}finally{h.value=!1}},oe=async l=>{var k,w;try{const P={email_or_phone:l.user_id,match_id:f.params.matchId,team:q.value,position:B.value,club_name:u.value.club_name||"No especificado",player_name:l.first_name||"Jugador desconocido",match_date:u.value.match_date||"Fecha desconocida",match_time:u.value.match_time||"Hora desconocida"},D=await R.post("/matches/add-player",P);D.data.status==="success"?(m.notify({type:"positive",message:"Jugador agregado exitosamente."}),L()):D.data.status==="invited"&&m.notify({type:"info",message:"Jugador invitado a unirse a PadelPlay."}),Q.value=!1}catch(P){console.error("Error al agregar jugador:",P.message),m.notify({type:"negative",message:((w=(k=P.response)==null?void 0:k.data)==null?void 0:w.detail)||"Error al agregar jugador."})}},re=async()=>{try{await R.put(`/matches/match/${f.params.matchId}`,{score:Y.value}),m.notify({type:"positive",message:"Resultado guardado exitosamente."})}catch(l){console.error("Error al guardar el resultado:",l.message),m.notify({type:"negative",message:"Error al guardar el resultado."})}},le=async()=>{var l,k;try{const w=`${window.location.origin}/join/match/${f.params.matchId}`,P="Te invitamos a este gran juego";let D="";if(u.value&&u.value.match_date){S.locale("es-mx");const ne=S(u.value.match_date).format("dddd, D [de] MMMM [del] YYYY"),[O,K]=ne.split(" de "),de=O.charAt(0).toUpperCase()+O.slice(1),ce=K.charAt(0).toUpperCase()+K.slice(1);D=de+" de "+ce}const H=((l=u.value)==null?void 0:l.club_name)||"nuestro club",G=(k=u.value)!=null&&k.match_time?u.value.match_time.slice(0,5):"",ie=D&&G?`\xA1\xDAnete a este partido de p\xE1del en ${H}! ${D} a las ${G} hrs.`:`\xA1\xDAnete a este partido de p\xE1del en ${H}!`;await ze(P,w,ie)}catch(w){console.error("Error al compartir el partido:",w),m.notify({type:"negative",message:"Error al compartir el partido."})}},se=()=>{a.back()},U=p(!1);return fe(()=>{f.query.from==="club"&&(U.value=!0),L()}),{matchDetails:u,team1:_,team2:N,loading:j,scoreTable:Y,addPlayerDialog:Q,searchInput:C,searchingPlayers:h,displayedPlayers:g,openAddPlayerDialog:ee,searchPlayers:te,selectPlayer:oe,saveScore:re,shareMatch:le,goBack:se,formatCategory:Z,viewPlayerProfile:$,isClubView:U}},methods:{openChat(){this.$router.push(`/matches/${this.$route.params.matchId}/chat`)},formatDate(f){S.locale("es-mx");const a=S(f).format("dddd, D [de] MMMM [del] YYYY"),[m,e]=a.split(" de "),u=m.charAt(0).toUpperCase()+m.slice(1),_=e.charAt(0).toUpperCase()+e.slice(1);return u+" de "+_},goToMaps(){const f=this.matchDetails.latitude,a=this.matchDetails.longitude;if(f&&a){const m=`https://www.google.com/maps?q=${f},${a}`;window.open(m,"_blank")}else this.$q.notify({message:"Ubicaci\xF3n no disponible",color:"negative",position:"top"})}}},Ue={class:"header-content"},Je={class:"header-icons"},Fe={key:0,class:"text-center"},Re={key:1},Ye={class:"row items-center",style:{position:"relative",width:"100%","margin-bottom":"20px"}},Le={class:"row",style:{position:"absolute",right:"0"}},He={class:"court-container"},Ge={class:"court"},Oe={class:"player team1-player1"},Ke=["src"],We={key:1},Xe={class:"text-caption"},Ze={class:"player team1-player2"},$e=["src"],ea={key:1},aa={class:"text-caption"},ta={class:"player team2-player1"},oa=["src"],ra={key:1},la={class:"text-caption"},sa={class:"player team2-player2"},ia=["src"],na={key:1},da={class:"text-caption"},ca={class:"score-grid"},ma={key:0,class:"text-center q-pa-md"},ua=["src"],pa={key:2,class:"text-center text-grey-5 q-pa-md"};function ya(f,a,m,e,u,_){const N=x("NotificationBell"),j=x("PlayerTopMenu"),C=x("ClubTopMenu"),q=x("BannerPromoScrolling"),B=x("DesktopNavigation"),Q=x("ClubNavigationMenu"),h=x("PlayerNavigationMenu");return o(),c(xe,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:i(()=>[r(me,{elevated:"",class:"text-white"},{default:i(()=>[t("div",Ue,[a[10]||(a[10]=t("div",{class:"greeting"},[t("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})],-1)),t("div",Je,[r(N),e.isClubView?M("",!0):(o(),c(j,{key:0})),e.isClubView?(o(),c(C,{key:1})):M("",!0)])]),r(q)]),_:1}),e.isClubView?M("",!0):(o(),c(B,{key:0})),e.isClubView?(o(),c(Q,{key:1})):M("",!0),r(be,null,{default:i(()=>[r(ke,{class:"q-pa-md"},{default:i(()=>[e.loading?(o(),n("div",Fe,[r(ue,{color:"primary",size:"xl"})])):(o(),n("div",Re,[r(T,{class:"text-white q-pa-md match-card"},{default:i(()=>[r(I,null,{default:i(()=>[t("div",Ye,[r(v,{flat:"",onClick:e.shareMatch,style:{position:"absolute",left:"0"}},{default:i(()=>[r(z,{name:"o_share",size:"md"})]),_:1},8,["onClick"]),a[11]||(a[11]=t("h3",{class:"text-h5 text-white",style:{flex:"1",margin:"0","text-align":"center"}},"Reserva",-1)),t("div",Le,[r(v,{flat:"",onClick:_.openChat},{default:i(()=>[r(z,{name:"o_chat",size:"md"})]),_:1},8,["onClick"])])]),t("p",null,[b(" Juegas en el club "+d(e.matchDetails.club_name||"No disponible")+" ",1),r(v,{size:"sm",flat:"",round:"",color:"orange",icon:"o_location_on",onClick:_.goToMaps},null,8,["onClick"]),b(" el dia "+d(_.formatDate(e.matchDetails.match_date))+" a las "+d(e.matchDetails.match_time.slice(0,5))+" hrs. En la cancha "+d(e.matchDetails.court_name||"No disponible")+". ",1)]),a[12]||(a[12]=t("p",null,[b("Categoria jugadores: Abierto"),t("br"),b(" Tipo de partido: Cerrado"),t("br")],-1))]),_:1})]),_:1}),r(T,{class:"match-card text-white q-pa-md"},{default:i(()=>[r(I,{class:"q-mt-md"},{default:i(()=>[a[19]||(a[19]=t("h3",{class:"text-center text-white"},"Jugadores",-1)),t("div",He,[t("div",Ge,[t("div",Oe,[e.team1[0]?(o(),n("div",{key:0,onClick:a[0]||(a[0]=s=>e.viewPlayerProfile(e.team1[0].user_id)),class:"clickable-player"},[e.team1[0].photo_url?(o(),c(V,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team1[0].photo_url,alt:"Foto del jugador"},null,8,Ke)]),_:1})):(o(),n("span",We,d(e.team1[0].first_name||"Jugador 1 Equipo 1"),1)),t("div",Xe,d(e.team1[0].first_name)+" - "+d(e.formatCategory(e.team1[0].category)),1)])):(o(),c(v,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[1]||(a[1]=s=>e.openAddPlayerDialog(1,0))}))]),t("div",Ze,[e.team1[1]?(o(),n("div",{key:0,onClick:a[2]||(a[2]=s=>e.viewPlayerProfile(e.team1[1].user_id)),class:"clickable-player"},[e.team1[1].photo_url?(o(),c(V,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team1[1].photo_url,alt:"Foto del jugador"},null,8,$e)]),_:1})):(o(),n("span",ea,d(e.team1[1].first_name||"Jugador 2 Equipo 1"),1)),t("div",aa,d(e.team1[1].first_name)+" - "+d(e.formatCategory(e.team1[1].category)),1)])):(o(),c(v,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[3]||(a[3]=s=>e.openAddPlayerDialog(1,1))}))]),t("div",ta,[e.team2[0]?(o(),n("div",{key:0,onClick:a[4]||(a[4]=s=>e.viewPlayerProfile(e.team2[0].user_id)),class:"clickable-player"},[e.team2[0].photo_url?(o(),c(V,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team2[0].photo_url,alt:"Foto del jugador"},null,8,oa)]),_:1})):(o(),n("span",ra,d(e.team2[0].first_name||"Jugador 1 Equipo 2"),1)),t("div",la,d(e.team2[0].first_name)+" - "+d(e.formatCategory(e.team2[0].category)),1)])):(o(),c(v,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[5]||(a[5]=s=>e.openAddPlayerDialog(2,0))}))]),t("div",sa,[e.team2[1]?(o(),n("div",{key:0,onClick:a[6]||(a[6]=s=>e.viewPlayerProfile(e.team2[1].user_id)),class:"clickable-player"},[e.team2[1].photo_url?(o(),c(V,{key:0,size:"40px"},{default:i(()=>[t("img",{src:e.team2[1].photo_url,alt:"Foto del jugador"},null,8,ia)]),_:1})):(o(),n("span",na,d(e.team2[1].first_name||"Jugador 2 Equipo 2"),1)),t("div",da,d(e.team2[1].first_name)+" - "+d(e.formatCategory(e.team2[1].category)),1)])):(o(),c(v,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[7]||(a[7]=s=>e.openAddPlayerDialog(2,1))}))]),a[13]||(a[13]=t("div",{class:"line1"},null,-1)),a[14]||(a[14]=t("div",{class:"player parejaA vertical-text"},"Pareja A",-1)),a[15]||(a[15]=t("div",{class:"net"},null,-1)),a[16]||(a[16]=t("div",{class:"line2"},null,-1)),a[17]||(a[17]=t("div",{class:"player parejaB vertical-text"},"Pareja B",-1)),a[18]||(a[18]=t("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1}),r(T,{class:"match-card text-white q-pa-md"},{default:i(()=>[r(I,{class:"score-input"},{default:i(()=>[a[23]||(a[23]=t("h3",{class:"text-center text-white"},"Resultado",-1)),t("div",ca,[a[20]||(a[20]=t("div",{class:"header"},null,-1)),(o(!0),n(A,null,E(e.scoreTable,(s,y)=>(o(),n("div",{class:"header",key:"header-"+y}," Set "+d(y+1),1))),128)),a[21]||(a[21]=t("div",{class:"team-label"},"Pareja A",-1)),(o(!0),n(A,null,E(e.scoreTable,(s,y)=>(o(),n("div",{key:"team1-"+y,class:"score-cell"},[r(J,{modelValue:s.team1score,"onUpdate:modelValue":g=>s.team1score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue"])]))),128)),a[22]||(a[22]=t("div",{class:"team-label"},"Pareja B",-1)),(o(!0),n(A,null,E(e.scoreTable,(s,y)=>(o(),n("div",{key:"team2-"+y,class:"score-cell"},[r(J,{modelValue:s.team2score,"onUpdate:modelValue":g=>s.team2score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),r(v,{label:"Guardar Resultado",color:"primary",class:"q-mt-md",onClick:e.saveScore},null,8,["onClick"])]),_:1})]),_:1})]))]),_:1})]),_:1}),r(he,{modelValue:e.addPlayerDialog,"onUpdate:modelValue":a[9]||(a[9]=s=>e.addPlayerDialog=s)},{default:i(()=>[r(T,{style:{"min-width":"300px","max-width":"500px",width:"90vw"},class:"bg-black text-white"},{default:i(()=>[r(I,null,{default:i(()=>[a[25]||(a[25]=t("div",{class:"text-h6"},"Agregar Jugador",-1)),r(J,{modelValue:e.searchInput,"onUpdate:modelValue":[a[8]||(a[8]=s=>e.searchInput=s),e.searchPlayers],label:"Buscar por nombre",outlined:"",dense:"",class:"q-mb-md"},{prepend:i(()=>[r(z,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"]),e.searchingPlayers?(o(),n("div",ma,[r(ge,{color:"primary",size:"md"})])):e.displayedPlayers.length>0?(o(),c(we,{key:1,bordered:"",separator:"",class:"rounded-borders"},{default:i(()=>[e.searchInput?M("",!0):(o(),c(F,{key:0,header:"",class:"text-white"},{default:i(()=>a[24]||(a[24]=[b("Sugerencias")])),_:1})),(o(!0),n(A,null,E(e.displayedPlayers,s=>(o(),c(Ce,{key:s.user_id,clickable:"",onClick:y=>e.selectPlayer(s),class:"text-white"},{default:i(()=>[r(W,{avatar:""},{default:i(()=>[r(V,{size:"48px"},{default:i(()=>[s.photo_url?(o(),n("img",{key:0,src:s.photo_url,alt:"Foto del jugador"},null,8,ua)):(o(),c(z,{key:1,name:"person",size:"48px"}))]),_:2},1024)]),_:2},1024),r(W,null,{default:i(()=>[r(F,{class:"text-white"},{default:i(()=>[b(d(s.first_name)+" "+d(s.last_name),1)]),_:2},1024),r(F,{caption:"",class:"text-grey-5"},{default:i(()=>[b(d(e.formatCategory(s.category)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):e.searchInput?(o(),n("div",pa," No se encontraron jugadores ")):M("",!0)]),_:1}),r(ve,{align:"right"},{default:i(()=>[_e(r(v,{flat:"",label:"Cancelar",color:"negative"},null,512),[[Pe]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(h)]),_:1})}var Wa=Ae(Ee,[["render",ya],["__scopeId","data-v-118facf1"]]);export{Wa as default};
