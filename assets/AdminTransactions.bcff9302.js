import{Q}from"./QHeader.8ed599dc.js";import{a5 as C,f as N,a6 as d,o as c,z as u,A as e,d as t,B as o,D as b,a7 as p,a8 as f,E as v,t as i,a9 as g,ac as k,e as M}from"./index.44d6004f.js";import{Q as S}from"./QSelect.22e7e4d3.js";import{Q as V}from"./QBadge.182a08f3.js";import{Q as _}from"./QTd.97f21094.js";import{Q as B}from"./QTable.6fba1495.js";import{Q as q}from"./QBanner.fa548e9b.js";import{Q as P}from"./QPage.069cc100.js";import{Q as I,a as F}from"./QLayout.bdadfe99.js";import{B as U,b as E,d as R}from"./BannerPromoScrolling.0ad337b6.js";import{A as L}from"./AdminNavigationMenu.1c866cd8.js";import{S as O}from"./SuperuserNavigationMenu.6c1f81b5.js";import{A as X}from"./AdminTopMenu.92c066f4.js";import{S as z}from"./SuperuserTopMenu.8780f74d.js";import{N as H}from"./NotificationBell.03dce8ef.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.d99417f0.js";import"./QItem.cafd0d6f.js";import"./QItemLabel.30a3dfed.js";import"./QMenu.aa52843c.js";import"./position-engine.d7eef48c.js";import"./selection.ab0d7921.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.8f6ea51c.js";import"./QMarkupTable.8b85f498.js";import"./use-fullscreen.547a09d4.js";import"./api.dcb17b1f.js";import"./QTabs.02ad9b81.js";import"./QFooter.dec25843.js";import"./QBtnDropdown.9d90b70a.js";import"./QBtnGroup.0f4e86aa.js";import"./haptics.bd260566.js";const j={name:"AdminTransactions",components:{AdminNavigationMenu:L,SuperuserNavigationMenu:O,AdminTopMenu:X,SuperuserTopMenu:z,NotificationBell:H,BannerPromoScrolling:U},setup(){const a=C();return{isAdminPath:N(()=>a.path.startsWith("/admin"))}},data(){return{transactionData:{transactions:[],total_count:0},clubOptions:[],filters:{startDate:"",endDate:"",clubId:null},loading:!1,error:null,pagination:{rowsPerPage:15},columns:[{name:"order_date",required:!0,label:"Fecha",align:"left",field:"order_date",sortable:!0},{name:"transaction_id",label:"ID Transacci\xF3n",align:"left",field:"transaction_id"},{name:"user_name",label:"Usuario",align:"left",field:"user_name"},{name:"club_name",label:"Club",align:"left",field:"club_name"},{name:"total_amount",label:"Monto",align:"right",field:"total_amount",sortable:!0},{name:"payment_method",label:"M\xE9todo",align:"center",field:"payment_method"},{name:"payment_status",label:"Estado",align:"center",field:"payment_status"}]}},computed:{totalAmount(){return this.transactionData.transactions.reduce((a,l)=>a+(parseFloat(l.total_amount)||0),0)},averageAmount(){return this.transactionData.transactions.length>0?this.totalAmount/this.transactionData.transactions.length:0}},async mounted(){await this.loadClubs(),await this.loadTransactions()},methods:{async loadClubs(){try{const a=await E();this.clubOptions=[{label:"Todos los clubes",value:null},...a.clubs.map(l=>({label:l.name,value:l.id}))]}catch(a){console.error("Error loading clubs:",a)}},async loadTransactions(){this.loading=!0,this.error=null;try{const a={startDate:this.filters.startDate||void 0,endDate:this.filters.endDate||void 0,clubId:this.filters.clubId||void 0};this.transactionData=await R(a)}catch(a){this.error="Error al cargar las transacciones: "+a.message,console.error("Error loading transactions:",a)}finally{this.loading=!1}},clearFilters(){this.filters={startDate:"",endDate:"",clubId:null},this.loadTransactions()},onRequest(a){},formatCurrency(a){return a?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(a):"$0.00"},formatDate(a){return a?new Date(a).toLocaleDateString("es-MX"):"N/A"},formatStatus(a){return{succeeded:"Exitoso",pending:"Pendiente",failed:"Fallido",cancelled:"Cancelado"}[a]||a},getStatusColor(a){return{succeeded:"positive",pending:"warning",failed:"negative",cancelled:"grey"}[a]||"grey"}}},G={class:"header-content"},J={class:"header-icons"},K={class:"q-pa-md"},Y={class:"row q-mb-md"},Z={class:"col"},$={class:"row q-gutter-md items-end"},tt={class:"col-md-3 col-sm-6"},et={class:"col-md-3 col-sm-6"},at={class:"col-md-4 col-sm-12"},ot={class:"col-auto"},lt={class:"row q-gutter-md q-mb-lg"},st={class:"col-md-4"},nt={class:"text-h4 text-primary"},rt={class:"col-md-4"},it={class:"text-h4 text-positive"},dt={class:"col-md-4"},ct={class:"text-h4 text-secondary"},ut={class:"text-weight-bold"};function mt(a,l,pt,h,n,r){const y=d("NotificationBell"),w=d("AdminTopMenu"),D=d("SuperuserTopMenu"),A=d("BannerPromoScrolling"),T=d("AdminNavigationMenu"),x=d("SuperuserNavigationMenu");return c(),u(I,{view:"hHh lpR fFf",class:"bg-dark text-white layout-with-bottom-nav"},{default:e(()=>[t(Q,{elevated:"",class:"text-white admin-header"},{default:e(()=>[o("div",G,[l[3]||(l[3]=o("div",{class:"greeting"},[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"}),o("span",{class:"text-subtitle1"},"Transacciones")],-1)),o("div",J,[t(y),h.isAdminPath?(c(),u(w,{key:0})):(c(),u(D,{key:1}))])]),t(A)]),_:1}),t(F,null,{default:e(()=>[t(P,{padding:"",class:"bg-dark"},{default:e(()=>[o("div",K,[o("div",Y,[o("div",Z,[t(b,{flat:"",icon:"refresh",onClick:r.loadTransactions,loading:n.loading,label:"Actualizar",color:"white"},null,8,["onClick","loading"])])]),t(p,{class:"filter-card q-mb-md"},{default:e(()=>[t(f,null,{default:e(()=>[o("div",$,[o("div",tt,[t(v,{modelValue:n.filters.startDate,"onUpdate:modelValue":[l[0]||(l[0]=s=>n.filters.startDate=s),r.loadTransactions],type:"date",label:"Fecha inicio",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),o("div",et,[t(v,{modelValue:n.filters.endDate,"onUpdate:modelValue":[l[1]||(l[1]=s=>n.filters.endDate=s),r.loadTransactions],type:"date",label:"Fecha fin",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),o("div",at,[t(S,{modelValue:n.filters.clubId,"onUpdate:modelValue":[l[2]||(l[2]=s=>n.filters.clubId=s),r.loadTransactions],options:n.clubOptions,"option-value":"value","option-label":"label",label:"Filtrar por club",filled:"",dark:"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),o("div",ot,[t(b,{flat:"",icon:"clear",color:"grey-7",onClick:r.clearFilters,label:"Limpiar"},null,8,["onClick"])])])]),_:1})]),_:1}),o("div",lt,[o("div",st,[t(p,{class:"summary-card"},{default:e(()=>[t(f,null,{default:e(()=>[l[4]||(l[4]=o("div",{class:"text-h6 text-white"},"Total Transacciones",-1)),o("div",nt,i(n.transactionData.total_count),1)]),_:1})]),_:1})]),o("div",rt,[t(p,{class:"summary-card"},{default:e(()=>[t(f,null,{default:e(()=>[l[5]||(l[5]=o("div",{class:"text-h6 text-white"},"Monto Total",-1)),o("div",it,i(r.formatCurrency(r.totalAmount)),1)]),_:1})]),_:1})]),o("div",dt,[t(p,{class:"summary-card"},{default:e(()=>[t(f,null,{default:e(()=>[l[6]||(l[6]=o("div",{class:"text-h6 text-white"},"Promedio",-1)),o("div",ct,i(r.formatCurrency(r.averageAmount)),1)]),_:1})]),_:1})])]),t(p,{class:"table-card"},{default:e(()=>[t(f,{class:"q-pa-none"},{default:e(()=>[t(B,{rows:n.transactionData.transactions,columns:n.columns,"row-key":"id",flat:"",dark:"",loading:n.loading,pagination:n.pagination,onRequest:r.onRequest},{"body-cell-payment_status":e(s=>[t(_,{props:s},{default:e(()=>[t(V,{color:r.getStatusColor(s.value),label:r.formatStatus(s.value)},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-total_amount":e(s=>[t(_,{props:s},{default:e(()=>[o("span",ut,i(r.formatCurrency(s.value)),1)]),_:2},1032,["props"])]),"body-cell-order_date":e(s=>[t(_,{props:s},{default:e(()=>[g(i(r.formatDate(s.value)),1)]),_:2},1032,["props"])]),"body-cell-club_name":e(s=>[t(_,{props:s},{default:e(()=>{var m;return[g(i(((m=s.row.clubs)==null?void 0:m.name)||"N/A"),1)]}),_:2},1032,["props"])]),"body-cell-user_name":e(s=>[t(_,{props:s},{default:e(()=>{var m;return[g(i(((m=s.row.profiles)==null?void 0:m.full_name)||"N/A"),1)]}),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","pagination","onRequest"])]),_:1})]),_:1}),n.error?(c(),u(q,{key:0,class:"bg-negative text-white q-mt-md"},{avatar:e(()=>[t(k,{name:"error"})]),default:e(()=>[g(" "+i(n.error),1)]),_:1})):M("",!0)])]),_:1})]),_:1}),h.isAdminPath?(c(),u(T,{key:0})):(c(),u(x,{key:1}))]),_:1})}var jt=W(j,[["render",mt],["__scopeId","data-v-5e7cf6b2"]]);export{jt as default};
