import{Q as A}from"./QHeader.3f6f4adb.js";import{a7 as E,F as H,r as d,j as C,B as M,a8 as h,q as v,G as J,H as r,v as o,I as e,a9 as N,aa as x,ab as i,x as n,s as y,ac as k,ad as F,ae as R,af as I,J as g,ag as U,ah as j,K as z}from"./index.dacf2a6b.js";import{Q as G}from"./QTooltip.67fec9e0.js";import{Q as K}from"./QPage.7ba51001.js";import{Q as W,a as X}from"./QLayout.0bd35f57.js";import{Q as Y}from"./QItemLabel.c8775daa.js";import{Q as Z,a as w}from"./QItem.49b611a2.js";import{C as $}from"./ClosePopup.49ba6561.js";import{u as aa}from"./use-quasar.f8d1cd9e.js";import{g as ea}from"./products.4901d069.js";import{a as ta}from"./api.2af71db3.js";import{P as oa}from"./PlayerNavigationMenu.cb2e1c16.js";import{_ as la}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.d074ff22.js";import"./selection.e059ad94.js";import"./supabase.796930a3.js";import"./QTabs.28db22ee.js";import"./rtl.276c3f1b.js";import"./QFooter.61ef02ab.js";const ra={components:{PlayerNavigationMenu:oa},setup(){const u=E(),a=H(),q=aa(),t=d({clubId:u.query.clubId||"",clubName:u.query.clubName||"Club no especificado",coachName:u.query.coachName||"No especificado",courtId:u.query.courtId||"",courtName:u.query.courtName||"Cancha no especificada",date:u.query.date||"Fecha no especificada",people:u.query.people||0,time:u.query.time||"Hora no especificada",price:parseFloat(u.query.price)||0}),b=d(4),P=d(t.value.price+b.value*t.value.price/100),c=d(),l=d({}),p=d([]),_=d(!1),f=d("partial"),T=d([{label:"Pagar mi parte",value:"partial"},{label:"Pagar el total",value:"total"}]),V=C(()=>`Continuar al pago de $${f.value==="total"?m.value.toFixed(2):(m.value/4).toFixed(2)}`),D=C(()=>p.value&&Array.isArray(p.value)?p.value.reduce((s,Q)=>s+Q.product.price*Q.quantity,0):0),m=C(()=>P.value+D.value),B=()=>{_.value=!0},O=()=>{p.value=c.value.filter(s=>l.value[s.id]>0).map(s=>({product:s,quantity:l.value[s.id]})),_.value=!1},S=async()=>{try{const s=f.value==="total"?m.value:m.value/4,L=(await ta.post("payments/payment_order_and_split_payment",{total_price:m.value,pay_total:f.value==="total"})).data.payment_order_id;a.push({name:"StripePayment",query:{reservationDetails:JSON.stringify({...t.value,payment_order_id:L}),total:m.value,paymentOption:f.value,selectedProducts:JSON.stringify(p.value),amountToPay:s}})}catch(s){console.error("Error al obtener payment_order:",s),q.notify({type:"negative",message:"Error al generar orden de pago. Por favor intente de nuevo."})}};return M(async()=>{c.value=await ea(t.value.clubId),c.value.forEach(s=>l.value[s.id]=0)}),{reservationDetails:t,commission:b,subtotal:P,products:c,productQuantities:l,selectedProducts:p,productDialog:_,paymentOption:f,paymentOptions:T,total:m,showProductDialog:B,addProductToOrder:O,goToPayment:S,productTotal:D,paymentButtonLabel:V}}},na={class:"q-ml-lg"};function sa(u,a,q,t,b,P){const c=h("PlayerNavigationMenu");return v(),J(W,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:r(()=>[o(A,{elevated:"",class:"text-white"},{default:r(()=>a[1]||(a[1]=[e("div",{class:"header-content"},[e("div",{class:"greeting"},[e("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"})]),e("div",{class:"header-icons"})],-1)])),_:1}),o(X,null,{default:r(()=>[o(K,{class:"q-pa-md"},{default:r(()=>[o(N,{class:"text-white"},{default:r(()=>[o(x,null,{default:r(()=>a[2]||(a[2]=[e("h3",{class:"text-white"},"Entrenamiento:",-1)])),_:1}),o(x,null,{default:r(()=>[e("p",null,[a[3]||(a[3]=e("strong",null,"Club:",-1)),i(" "+n(t.reservationDetails.clubName),1)]),e("p",null,[a[4]||(a[4]=e("strong",null,"Coach:",-1)),i(" "+n(t.reservationDetails.coachName),1)]),e("p",null,[a[5]||(a[5]=e("strong",null,"Fecha:",-1)),i(" "+n(t.reservationDetails.date),1)]),e("p",null,[a[6]||(a[6]=e("strong",null,"Horario:",-1)),i(" "+n(t.reservationDetails.time)+" hrs.",1)]),a[13]||(a[13]=e("p",null,[e("strong",null,"Duraci\xF3n:"),i(" 60 minutos")],-1)),e("p",null,[a[7]||(a[7]=e("strong",null,"Participantes:",-1)),i(" "+n(t.reservationDetails.people),1)]),e("p",null,[a[8]||(a[8]=e("strong",null,"Precio:",-1)),i(" $"+n(t.reservationDetails.price.toFixed(2)),1)]),e("p",null,[a[9]||(a[9]=e("strong",null,"Subtotal:",-1)),i(" $"+n(t.subtotal.toFixed(2)),1)]),e("p",null,[a[10]||(a[10]=e("strong",null,"Adicionales:",-1)),i(" $"+n(t.productTotal),1)]),e("ul",na,[(v(!0),y(F,null,k(t.selectedProducts,l=>(v(),y("li",{key:l.product.id},n(l.product.name)+" x "+n(l.quantity)+" - $"+n((l.product.price*l.quantity).toFixed(2)),1))),128))]),e("p",null,[a[12]||(a[12]=e("strong",null,"Total a pagar:",-1)),i(" $"+n(t.total.toFixed(2))+" ",1),o(R,{name:"o_info",size:"xs",class:"cursor-help"},{default:r(()=>[o(G,{anchor:"top middle",self:"bottom middle",offset:[0,10]},{default:r(()=>a[11]||(a[11]=[i(" Precio total con impuestos y comisiones incluidas ")])),_:1})]),_:1})])]),_:1}),o(I,{align:"right"},{default:r(()=>[o(g,{label:"Agregar Productos",color:"primary",onClick:t.showProductDialog},null,8,["onClick"]),o(g,{label:t.paymentButtonLabel,color:"green",onClick:t.goToPayment},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),o(j,{modelValue:t.productDialog,"onUpdate:modelValue":a[0]||(a[0]=l=>t.productDialog=l)},{default:r(()=>[o(N,null,{default:r(()=>[o(x,null,{default:r(()=>[(v(!0),y(F,null,k(t.products,l=>(v(),y("div",{key:l.id,class:"q-mb-md"},[o(Z,null,{default:r(()=>[o(w,null,{default:r(()=>[o(Y,null,{default:r(()=>[i(n(l.name)+" - $"+n(l.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),o(w,{side:""},{default:r(()=>[o(z,{modelValue:t.productQuantities[l.id],"onUpdate:modelValue":p=>t.productQuantities[l.id]=p,type:"number",min:"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),o(I,{align:"right"},{default:r(()=>[o(g,{label:"Aceptar",color:"primary",onClick:t.addProductToOrder},null,8,["onClick"]),U(o(g,{label:"Cancelar",color:"grey-dark"},null,512),[[$]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(c)]),_:1})}var ka=la(ra,[["render",sa],["__scopeId","data-v-1f3261f0"]]);export{ka as default};
