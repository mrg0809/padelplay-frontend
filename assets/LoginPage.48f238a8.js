import{r,F as C,q as i,G as v,H as g,v as s,I as c,J as t,s as f,y as u,K as _,x as I}from"./index.0423b3df.js";import{Q as L}from"./QForm.e9ef244c.js";import{Q as x}from"./QPage.fc5cffac.js";import{Q as T,a as S}from"./QLayout.df606e8a.js";import{a as A}from"./api.f1a1189d.js";import{u as P}from"./userStore.a3d1466b.js";import{o as k}from"./auth.a817a5ce.js";import{_ as Q}from"./plugin-vue_export-helper.21dcd24c.js";import"./pinia.2a6edf20.js";import"./supabase.5916d516.js";const V={name:"LoginPage",setup(){const p=r(""),e=r(""),n=r(null),o=r(!1),d=r(!1),b=r(!1),a=C(),y=P();return{email:p,password:e,error:n,googleLoading:o,appleLoading:d,showTraditionalLogin:b,login:async()=>{n.value=null;try{const l=await A.post("/auth/login",{email:p.value,password:e.value}),{access_token:m}=l.data;localStorage.setItem("token",m);const w=m.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),h=JSON.parse(atob(w));y.setUserDataFromToken(m),h.user_type==="superuser"?a.push("/dashboard/superuser"):h.user_type==="admin"?a.push("/dashboard/admin"):h.user_type==="club"?a.push("/dashboard/club"):a.push("/dashboard/player")}catch(l){l.response&&l.response.data&&l.response.data.detail?n.value=l.response.data.detail:n.value="Ocurri\xF3 un error inesperado. Intenta de nuevo m\xE1s tarde.",console.error("Error al iniciar sesi\xF3n:",l)}},signInWithGoogle:async()=>{o.value=!0,n.value=null;try{await k.signInWithGoogle()}catch(l){n.value="Error al iniciar sesi\xF3n con Google",console.error("Google OAuth error:",l)}finally{o.value=!1}},signInWithApple:async()=>{d.value=!0,n.value=null;try{await k.signInWithApple()}catch(l){n.value="Apple OAuth no est\xE1 disponible a\xFAn. Pronto estar\xE1 habilitado.",console.error("Apple OAuth error:",l)}finally{d.value=!1}},goToSignup:()=>{a.push("/signup")},goToForgotPassword:()=>{a.push("/forgot-password")}}}},G={class:"login-container"},W={class:"oauth-buttons"},F={key:0,class:"traditional-login-toggle"},O={key:1,class:"divider"},U={key:0,class:"error-message"},B={class:"login-links"};function N(p,e,n,o,d,b){return i(),v(T,{view:"lHh Lpr lFf"},{default:g(()=>[s(S,null,{default:g(()=>[s(x,{class:"login-page"},{default:g(()=>[c("div",G,[e[4]||(e[4]=c("img",{src:"/logo.jpeg",alt:"Logo",class:"login-logo"},null,-1)),c("div",W,[s(t,{onClick:o.signInWithGoogle,loading:o.googleLoading,class:"google-btn",icon:"img:/google-icon.svg",label:"Continuar con Google",color:"white","text-color":"black","no-caps":"",style:{"margin-bottom":"12px"}},null,8,["onClick","loading"]),s(t,{onClick:o.signInWithApple,loading:o.appleLoading,class:"apple-btn",icon:"img:/apple-icon.svg",label:"Continuar con Apple",color:"dark","text-color":"white","no-caps":"",style:{"margin-bottom":"20px"}},null,8,["onClick","loading"])]),o.showTraditionalLogin?u("",!0):(i(),f("div",F,[s(t,{flat:"",label:"Ingresar con email y contrase\xF1a",color:"white",class:"toggle-link",onClick:e[0]||(e[0]=a=>o.showTraditionalLogin=!0),"no-caps":""})])),o.showTraditionalLogin?(i(),f("div",O,e[3]||(e[3]=[c("span",{class:"divider-text"},"o",-1)]))):u("",!0),o.showTraditionalLogin?(i(),v(L,{key:2,onSubmit:o.login,class:"login-form"},{default:g(()=>[s(_,{outlined:"",dark:"",modelValue:o.email,"onUpdate:modelValue":e[1]||(e[1]=a=>o.email=a),label:"Correo electr\xF3nico",type:"email",class:"q-mb-md input-dark"},null,8,["modelValue"]),s(_,{outlined:"",dark:"",modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=a=>o.password=a),label:"Contrase\xF1a",type:"password",class:"q-mb-md input-dark"},null,8,["modelValue"]),s(t,{label:"Iniciar sesi\xF3n",color:"white","text-color":"black",type:"submit",class:"login-btn"}),o.error?(i(),f("div",U,I(o.error),1)):u("",!0)]),_:1},8,["onSubmit"])):u("",!0),c("div",B,[s(t,{flat:"",label:"Crear una cuenta",color:"white",class:"login-link",onClick:o.goToSignup},null,8,["onClick"]),s(t,{flat:"",label:"Olvid\xE9 mi contrase\xF1a",color:"white",class:"login-link",onClick:o.goToForgotPassword},null,8,["onClick"])])])]),_:1})]),_:1})]),_:1})}var ao=Q(V,[["render",N],["__scopeId","data-v-082bda77"]]);export{ao as default};
