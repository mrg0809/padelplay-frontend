import{Q as N}from"./QToolbarTitle.ca61c75c.js";import{x as P,a5 as S,r as i,f as _,h as j,a6 as A,o as V,z as Q,A as s,s as F,d as r,a9 as U,D as c,aT as H,B as t,E as n,a as R,aa as G,ab as L,af as J,a7 as O,a8 as K,ad as W,ae as X,aS as Y}from"./index.687b44e8.js";import{Q as Z}from"./QToolbar.7ee4439e.js";import{Q as $}from"./QHeader.289f0645.js";import{Q as y}from"./QSelect.8af2919e.js";import{Q as ee}from"./QForm.c4c1505e.js";import{Q as oe}from"./QPage.fcc9aae1.js";import{Q as ae,a as re}from"./QLayout.30990248.js";import{C as le}from"./ClosePopup.89fae5e1.js";import{s as x}from"./supabase.66aa98e2.js";import{u as te}from"./use-quasar.ba375293.js";import{a as se}from"./api.1c42dce4.js";import{C as ne}from"./ClubNavigationMenu.44af5278.js";import{_ as ie}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.c9b5cbc6.js";import"./QItem.eb9291fb.js";import"./QItemLabel.bbebea39.js";import"./QMenu.df8dfc7c.js";import"./position-engine.46674690.js";import"./selection.0f785986.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QTabs.979bee57.js";import"./QFooter.b7b22f15.js";const de={name:"EditTournament",components:{ClubNavigationMenu:ne},setup(){const p=P(),o=S(),f=te(),e=i({name:"",start_date:"",start_time:"",category:"",gender:"",system:"",min_pairs:null,max_pairs:null,price_per_pair:null,prize:"",courts_used:[],details:""}),g=i(["primera","segunda","tercera","cuarta","quinta","libre","otro","open"]),b=i(["mixto","varonil","femenil"]),d=i(["eliminacion directa","round-robin","combinado","liga","retas"]),a=i([]),m=o.params.tournamentId,v=i(!1),q=_(()=>g.value.map(l=>({label:l.charAt(0).toUpperCase()+l.slice(1),value:l}))),w=_(()=>b.value.map(l=>({label:l.charAt(0).toUpperCase()+l.slice(1),value:l}))),T=_(()=>d.value.map(l=>({label:l.charAt(0).toUpperCase()+l.slice(1),value:l}))),k=async()=>{try{const{data:l,error:u}=await x.from("tournaments").select("*").eq("id",m).single();if(u)throw u;e.value={...l}}catch(l){console.error("Error al obtener detalles del torneo:",l.message)}},z=async()=>{try{const l=await F.getItem("token");if(l){const D=l.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),B=JSON.parse(atob(D)).club_id,{data:I,error:C}=await x.from("courts").select("id, name").eq("club_id",B);if(C)throw C;a.value=I}}catch(l){console.error("Error al obtener canchas:",l.message)}},E=()=>{v.value=!0},h=async()=>{try{v.value=!1;const l={...e.value,category:typeof e.value.category=="object"?e.value.category.value:e.value.category,gender:typeof e.value.gender=="object"?e.value.gender.value:e.value.gender,system:typeof e.value.system=="object"?e.value.system.value:e.value.system};if((await se.put(`/tournaments/${m}`,l)).status===200)console.log("200 ok"),f.notify({type:"positive",message:"Torneo actualizado exitosamente."}),p.push("/dashboard/club");else throw new Error("Error al actualizar el torneo.")}catch(l){console.error("Error al actualizar torneo:",l.message),f.notify({type:"negative",message:"Error al actualizar el torneo."})}},M=()=>{p.back()};return j(()=>{k(),z()}),{form:e,categories:g,genders:b,systems:d,categoriesCapitalized:q,gendersCapitalized:w,systemsCapitalized:T,courts:a,updateTournament:h,confirmUpdateTournament:E,confirmDialogVisible:v,goBack:M}}},me={class:"form-group"},ue={class:"form-group"},ce={class:"form-group"},pe={class:"form-group"},fe={class:"form-group"},ge={class:"form-group"},be={class:"form-group"},ve={class:"form-group"},_e={class:"form-group"},Ve={class:"form-group"},ye={class:"form-group"},Ce={class:"form-group"},Qe={class:"courts-grid"};function Ue(p,o,f,e,g,b){const d=A("ClubNavigationMenu");return V(),Q(ae,{view:"hHh lpR fFf",class:"text-white"},{default:s(()=>[r($,{class:"text-white header-content"},{default:s(()=>[r(Z,null,{default:s(()=>[r(N,null,{default:s(()=>[...o[13]||(o[13]=[U("Editar Torneo",-1)])]),_:1}),r(c,{flat:"",round:"",icon:"arrow_back",onClick:e.goBack},null,8,["onClick"])]),_:1})]),_:1}),r(re,null,{default:s(()=>[r(oe,{class:"q-pa-md"},{default:s(()=>[r(ee,{onSubmit:H(e.confirmUpdateTournament,["prevent"])},{default:s(()=>[t("div",me,[r(n,{modelValue:e.form.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.form.name=a),label:"Nombre del Torneo",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",ue,[r(n,{modelValue:e.form.start_date,"onUpdate:modelValue":o[1]||(o[1]=a=>e.form.start_date=a),label:"Fecha de Inicio",type:"date",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",ce,[r(n,{modelValue:e.form.start_time,"onUpdate:modelValue":o[2]||(o[2]=a=>e.form.start_time=a),label:"Hora de Inicio",type:"time",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",pe,[r(y,{modelValue:e.form.category,"onUpdate:modelValue":o[3]||(o[3]=a=>e.form.category=a),options:e.categoriesCapitalized,label:"Categor\xEDa",outlined:"",dense:"",required:""},null,8,["modelValue","options"])]),t("div",fe,[r(y,{modelValue:e.form.gender,"onUpdate:modelValue":o[4]||(o[4]=a=>e.form.gender=a),options:e.gendersCapitalized,label:"G\xE9nero",outlined:"",dense:"",required:""},null,8,["modelValue","options"])]),t("div",ge,[r(y,{modelValue:e.form.system,"onUpdate:modelValue":o[5]||(o[5]=a=>e.form.system=a),options:e.systemsCapitalized,label:"Sistema de Competencia",outlined:"",dense:"",required:""},null,8,["modelValue","options"])]),t("div",be,[r(n,{modelValue:e.form.details,"onUpdate:modelValue":o[6]||(o[6]=a=>e.form.details=a),label:"Detalles del Torneo",type:"textarea",outlined:"",dense:"",rows:"3",hint:"Especificaciones adicionales que se mostrar\xE1n a los jugadores"},null,8,["modelValue"])]),t("div",ve,[r(n,{modelValue:e.form.min_pairs,"onUpdate:modelValue":o[7]||(o[7]=a=>e.form.min_pairs=a),modelModifiers:{number:!0},label:"M\xEDnimo de Parejas",type:"number",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",_e,[r(n,{modelValue:e.form.max_pairs,"onUpdate:modelValue":o[8]||(o[8]=a=>e.form.max_pairs=a),modelModifiers:{number:!0},label:"M\xE1ximo de Parejas",type:"number",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",Ve,[r(n,{modelValue:e.form.price_per_pair,"onUpdate:modelValue":o[9]||(o[9]=a=>e.form.price_per_pair=a),modelModifiers:{number:!0},label:"Precio por Pareja",type:"number",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",ye,[r(n,{modelValue:e.form.prize,"onUpdate:modelValue":o[10]||(o[10]=a=>e.form.prize=a),label:"Premio",outlined:"",dense:"",required:""},null,8,["modelValue"])]),t("div",Ce,[o[14]||(o[14]=U(" Selecciona canchas para el torneo: ",-1)),t("div",Qe,[(V(!0),R(L,null,G(e.courts,a=>(V(),Q(Y,{key:a.id,modelValue:e.form.courts_used,"onUpdate:modelValue":o[11]||(o[11]=m=>e.form.courts_used=m),label:a.name,val:a.id,outlined:"",dense:""},null,8,["modelValue","label","val"]))),128))])]),r(c,{type:"submit",label:"Guardar Cambios",color:"primary",class:"q-mt-md full-width-btn"})]),_:1},8,["onSubmit"]),r(J,{modelValue:e.confirmDialogVisible,"onUpdate:modelValue":o[12]||(o[12]=a=>e.confirmDialogVisible=a)},{default:s(()=>[r(O,null,{default:s(()=>[r(K,null,{default:s(()=>[...o[15]||(o[15]=[t("div",{class:"text-h6"},"\xBFEst\xE1s seguro de guardar los cambios?",-1)])]),_:1}),r(W,{align:"right"},{default:s(()=>[X(r(c,{flat:"",label:"Cancelar",color:"negative"},null,512),[[le]]),r(c,{flat:"",label:"Confirmar",color:"positive",onClick:e.updateTournament},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),r(d)]),_:1})}var We=ie(de,[["render",Ue],["__scopeId","data-v-49d6ef4c"]]);export{We as default};
