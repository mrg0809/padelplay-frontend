import{F as Z,r as i,B as $,a8 as ee,q as n,G as s,H as o,v as a,I as f,ab as S,J as C,a9 as O,aa as _,s as q,ac as L,ad as N,y as p,K as h,af as ae,ag as oe,ah as le,bC as re,x,aK as te}from"./index.71d630fb.js";import{Q as ne}from"./QHeader.1501c452.js";import{Q as P,a as Q}from"./QItem.be3e7c8c.js";import{Q as U}from"./QItemLabel.00b7ff5b.js";import{Q as R}from"./QList.9f9e73f9.js";import{Q as se}from"./QPage.ce9abbf4.js";import{Q as ce,a as ie}from"./QLayout.c08f0fa0.js";import{Q as de}from"./QSelect.d41a5384.js";import{C as ue}from"./ClosePopup.bd252fc7.js";import{s as me}from"./supabase.60a2aacd.js";import{u as fe}from"./userStore.0094877c.js";import{C as pe}from"./ClubNavigationMenu.5ac16560.js";import{a as j}from"./api.f1a1189d.js";import{_ as ge}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.a466b45e.js";import"./QMenu.89f3ebb3.js";import"./position-engine.25e73adf.js";import"./selection.040452b6.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./pinia.014ff78d.js";import"./QTabs.00f0efae.js";import"./QFooter.a6cd6ca7.js";const _e={name:"ManageCoaches",components:{ClubNavigationMenu:pe},setup(){const F=Z(),l=fe(),w=i([]),e=i([]),v=i([]),k=i(!1),b=i(null),r=i(null),c=i(null),g=i(null),D=i(null),A=i(""),T=i(""),y=i(1),B=["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado","Domingo"],E=i(Array(7).fill(null).map(()=>({is_open:!1,start_time:"09:00",end_time:"13:00"}))),H=t=>{console.log("ir al coach"),F.push({name:"CoachProfile",params:{id:t}})},J=()=>{F.back()},I=async()=>{try{const{data:t,error:u}=await me.from("coaches").select(`
                id, 
                name, 
                coach_focus, 
                players(gender, photo_url, category)
            `).eq("club_id",l.clubId).eq("is_active",!0);if(u)throw u;w.value=t.map(d=>{var m,V,M;return{id:d.id,name:d.name,coach_focus:d.coach_focus,gender:((m=d.players)==null?void 0:m.gender)||"Desconocido",photo_url:((V=d.players)==null?void 0:V.photo_url)||null,category:((M=d.players)==null?void 0:M.category)||"No especificado"}})}catch(t){console.error("Error obteniendo coaches:",t.message)}},K=async()=>{try{const{data:t,error:u}=await j.get("/coaches/search-coaches");if(u)throw u;e.value=t,v.value=t}catch(t){console.error("Error obteniendo coaches disponibles:",t.message)}},W=(t,u)=>{u(()=>{const d=t.toLowerCase();v.value=e.value.filter(m=>m.name.toLowerCase().indexOf(d)>-1)})},z=async()=>{await K(),k.value=!0,y.value=1},G=()=>{y.value++},X=()=>{y.value--},Y=async()=>{if(!b.value){console.error("Debes seleccionar un jugador.");return}try{const t={user_id:b.value.user_id,club_id:l.clubId,name:b.value.name,price_for_one:r.value,price_for_two:c.value,price_for_three:g.value,price_for_four:D.value,coach_resume:A.value,coach_focus:T.value,availability:E.value.filter(m=>m.is_open).map((m,V)=>({day:B[V],start_time:m.start_time,end_time:m.end_time}))},{data:u,error:d}=await j.post("/coaches/add-coach",t);if(d)throw d;console.log("Coach agregado:",u),I(),k.value=!1}catch(t){console.error("Error agregando coach:",t.message)}};return $(I),{goBack:J,coaches:w,isCoachDialogOpen:k,openCoachDialog:z,availableCoaches:e,filteredAvailableCoaches:v,selectedCoach:b,priceForOne:r,priceForTwo:c,priceForThree:g,priceForFour:D,coachResume:A,coachFocus:T,currentStep:y,nextStep:G,previousStep:X,addCoach:Y,filterCoaches:W,daysOfWeek:B,generalSchedule:E,goToCoachProfile:H}}},he={class:"header-content"},be={class:"header-icons"},Ce={class:"q-mb-md"},ve=["src"],ke={class:"text-bold"};function ye(F,l,w,e,v,k){const b=ee("ClubNavigationMenu");return n(),s(ce,{view:"hHh lpR fFf"},{default:o(()=>[a(ne,{elevated:"",class:"bg-primary text-white"},{default:o(()=>[f("div",he,[l[8]||(l[8]=f("div",{class:"greeting"},[f("img",{src:"/src/assets/padelplay.png",alt:"Logo",class:"logo-icon"}),S(" Instructores ")],-1)),f("div",be,[a(C,{flat:"",round:"",icon:"arrow_back",onClick:e.goBack},null,8,["onClick"])])])]),_:1}),a(ie,null,{default:o(()=>[a(se,{class:"q-pa-md"},{default:o(()=>[f("div",Ce,[a(O,{class:"transparent-card"},{default:o(()=>[a(_,null,{default:o(()=>l[9]||(l[9]=[f("h5",{class:"text-black"},"Coaches:",-1)])),_:1}),e.coaches.length>0?(n(),s(_,{key:0},{default:o(()=>[a(R,{bordered:"",separator:""},{default:o(()=>[(n(!0),q(N,null,L(e.coaches,r=>(n(),s(P,{key:r.id},{default:o(()=>[a(Q,{avatar:""},{default:o(()=>[a(re,null,{default:o(()=>[f("img",{src:r.photo_url||"default-avatar.png"},null,8,ve)]),_:2},1024)]),_:2},1024),a(Q,{onClick:c=>e.goToCoachProfile(r.id)},{default:o(()=>[a(U,{class:"text-black"},{default:o(()=>[S(x(r.name),1)]),_:2},1024),r.coach_focus?(n(),s(U,{key:0,class:"text-black"},{default:o(()=>[S(x(r.coach_focus),1)]),_:2},1024)):p("",!0)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})):(n(),s(_,{key:1},{default:o(()=>[a(U,{class:"text-center text-black"},{default:o(()=>l[10]||(l[10]=[S(" A\xFAn no tienes coaches disponibles ")])),_:1})]),_:1}))]),_:1})]),a(C,{glossy:"",round:"",size:"lg",color:"black",icon:"add",class:"fixed-bottom-right q-mb-xl",onClick:e.openCoachDialog},null,8,["onClick"])]),_:1})]),_:1}),a(b),a(le,{modelValue:e.isCoachDialogOpen,"onUpdate:modelValue":l[7]||(l[7]=r=>e.isCoachDialogOpen=r),persistent:"","full-width":""},{default:o(()=>[a(O,{class:"bg-black"},{default:o(()=>[a(_,null,{default:o(()=>l[11]||(l[11]=[f("div",{class:"text-h6"},"Agregar Coach",-1)])),_:1}),e.currentStep===1?(n(),s(_,{key:0},{default:o(()=>[a(de,{modelValue:e.selectedCoach,"onUpdate:modelValue":l[0]||(l[0]=r=>e.selectedCoach=r),options:e.filteredAvailableCoaches,"option-label":"name","option-value":"user_id",label:"Buscar jugador",filled:"","use-input":"",onFilter:e.filterCoaches,class:"custom-select"},null,8,["modelValue","options","onFilter"])]),_:1})):p("",!0),e.currentStep===2?(n(),s(_,{key:1},{default:o(()=>[a(h,{modelValue:e.priceForOne,"onUpdate:modelValue":l[1]||(l[1]=r=>e.priceForOne=r),label:"Entrenamiento individual",filled:"",type:"number"},null,8,["modelValue"]),a(h,{modelValue:e.priceForTwo,"onUpdate:modelValue":l[2]||(l[2]=r=>e.priceForTwo=r),label:"Entrenamiento pareja",filled:"",type:"number"},null,8,["modelValue"]),a(h,{modelValue:e.priceForThree,"onUpdate:modelValue":l[3]||(l[3]=r=>e.priceForThree=r),label:"Entrenamiento 3 jugadores",filled:"",type:"number"},null,8,["modelValue"]),a(h,{modelValue:e.priceForFour,"onUpdate:modelValue":l[4]||(l[4]=r=>e.priceForFour=r),label:"Entrenamiento 4 jugadores",filled:"",type:"number"},null,8,["modelValue"])]),_:1})):p("",!0),e.currentStep===3?(n(),s(_,{key:2},{default:o(()=>[a(h,{modelValue:e.coachResume,"onUpdate:modelValue":l[5]||(l[5]=r=>e.coachResume=r),label:"Resumen del Coach",filled:"",type:"textarea"},null,8,["modelValue"]),a(h,{modelValue:e.coachFocus,"onUpdate:modelValue":l[6]||(l[6]=r=>e.coachFocus=r),label:"Enfoque del Coach",filled:"",type:"textarea"},null,8,["modelValue"])]),_:1})):p("",!0),e.currentStep===4?(n(),s(_,{key:3},{default:o(()=>[a(R,{bordered:""},{default:o(()=>[(n(!0),q(N,null,L(e.generalSchedule,(r,c)=>(n(),s(P,{key:c,class:"q-mb-md"},{default:o(()=>[a(Q,null,{default:o(()=>[f("div",ke,x(e.daysOfWeek[c]),1),a(te,{modelValue:e.generalSchedule[c].is_open,"onUpdate:modelValue":g=>e.generalSchedule[c].is_open=g,label:"\xBFDisponible?",dense:"",color:"black"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e.generalSchedule[c].is_open?(n(),s(Q,{key:0},{default:o(()=>[a(h,{modelValue:e.generalSchedule[c].start_time,"onUpdate:modelValue":g=>e.generalSchedule[c].start_time=g,label:"Hora de inicio",dense:"",outlined:"",color:"black",class:"text-black",mask:"time",rules:["time"]},null,8,["modelValue","onUpdate:modelValue"]),a(h,{modelValue:e.generalSchedule[c].end_time,"onUpdate:modelValue":g=>e.generalSchedule[c].end_time=g,label:"Hora de fin",dense:"",outlined:"",color:"black",class:"text-black",mask:"time",rules:["time"]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):p("",!0)]),_:2},1024))),128))]),_:1})]),_:1})):p("",!0),a(ae,{align:"right"},{default:o(()=>[oe(a(C,{flat:"",label:"Cancelar",color:"red"},null,512),[[ue]]),e.currentStep>1?(n(),s(C,{key:0,flat:"",label:"Anterior",color:"blue",onClick:e.previousStep},null,8,["onClick"])):p("",!0),e.currentStep<4?(n(),s(C,{key:1,flat:"",label:"Siguiente",color:"green",onClick:e.nextStep},null,8,["onClick"])):p("",!0),e.currentStep===4?(n(),s(C,{key:2,flat:"",label:"Agregar",color:"green",onClick:e.addCoach},null,8,["onClick"])):p("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ke=ge(_e,[["render",ye],["__scopeId","data-v-216a2ff3"]]);export{Ke as default};
