import{F as L,r as c,j as U,B as K,a8 as G,q as h,G as P,H as t,v as e,I as s,ab as V,J as x,s as H,a9 as g,aa as u,aM as k,K as v,ae as R,x as J,y as D,ah as T,bF as O,af as W}from"./index.16289384.js";import{Q as X}from"./QHeader.455f548f.js";import{Q as Y}from"./QSpinnerGears.c9809d05.js";import{Q as Z}from"./QInnerLoading.fd578618.js";import{Q as M}from"./QImg.58e87840.js";import{Q as E}from"./QForm.d2cfd403.js";import{Q as $}from"./QBanner.2a9965b2.js";import{Q as aa}from"./QPage.14746aa2.js";import{Q as ea,a as oa}from"./QLayout.7605203b.js";import{u as ta}from"./use-quasar.3ae438d6.js";import{a as F}from"./api.92f95132.js";import{C as sa}from"./ClubNavigationMenu.01303232.js";import{_ as na}from"./MP_RGB_horizontal.ee11db59.js";import{_ as la}from"./plugin-vue_export-helper.21dcd24c.js";import"./QTabs.7e37d315.js";import"./rtl.276c3f1b.js";import"./QFooter.2de1729e.js";const ra={name:"ManageAccounts",components:{ClubNavigationMenu:sa},setup(){const C=L(),o=ta(),f=c(!0),a=c(!1),_=c(!1),m=c(""),d=c(!1),n=c(""),w=c({mercadopago_email:null,mercadopago_client_id:null,stripe_account_id:null,has_mercadopago_email:!1,has_mercadopago_client_id:!1,has_stripe_account_id:!1,last_updated:null}),l=c({email:"",clientId:""}),p=c({accountId:""}),q=U(()=>l.value.email||l.value.clientId||p.value.accountId),S=()=>{C.back()},b=async()=>{try{f.value=!0;const r=await F.get("/clubs/payment-accounts");w.value=r.data}catch(r){console.error("Error loading payment accounts:",r),o.notify({type:"negative",message:"Error al cargar la informaci\xF3n de cuentas de pago"})}finally{f.value=!1}},B=()=>{m.value="",d.value=!1,n.value="",_.value=!0},A=()=>{_.value=!1,m.value="",d.value=!1,n.value=""},N=async()=>{var r,y,Q,I;if(!m.value){d.value=!0,n.value="La contrase\xF1a es requerida";return}try{a.value=!0,d.value=!1;const i={password_confirmation:m.value};l.value.email&&(i.mercadopago_email=l.value.email),l.value.clientId&&(i.mercadopago_client_id=l.value.clientId),p.value.accountId&&(i.stripe_account_id=p.value.accountId),await F.put("/clubs/payment-accounts",i),o.notify({type:"positive",message:"Cuentas de pago actualizadas exitosamente"}),A(),j(),await b()}catch(i){console.error("Error saving payment accounts:",i),((r=i.response)==null?void 0:r.status)===403?(d.value=!0,n.value="Contrase\xF1a incorrecta"):((y=i.response)==null?void 0:y.status)===400?o.notify({type:"negative",message:((I=(Q=i.response)==null?void 0:Q.data)==null?void 0:I.detail)||"Error de validaci\xF3n en los datos proporcionados"}):o.notify({type:"negative",message:"Error al actualizar las cuentas de pago"})}finally{a.value=!1}},j=()=>{l.value.email="",l.value.clientId="",p.value.accountId=""},z=r=>r?new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return K(()=>{b()}),{loading:f,saving:a,showPasswordDialog:_,passwordConfirmation:m,passwordError:d,passwordErrorMessage:n,paymentAccounts:w,mercadopagoForm:l,stripeForm:p,hasChanges:q,goBack:S,openPasswordDialog:B,closePasswordDialog:A,savePaymentAccounts:N,formatDate:z}}},ia={class:"header-content"},ca={class:"header-icons"},da={key:0,class:"q-gutter-md"},ua={class:"row items-center justify-between"},ma={class:"col-auto"},pa={class:"q-gutter-md"},ga={class:"row items-center justify-between"},fa={class:"col-auto"},_a={class:"q-gutter-md"},xa={class:"row justify-center q-mt-lg"},va={class:"text-caption text-grey-7"};function ya(C,o,f,a,_,m){const d=G("ClubNavigationMenu");return h(),P(ea,{view:"hHh lpR fFf",class:"body text-white"},{default:t(()=>[e(X,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[s("div",ia,[o[5]||(o[5]=s("div",{class:"greeting"},[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon"}),V(" Cuentas de Pago ")],-1)),s("div",ca,[e(x,{flat:"",round:"",icon:"arrow_back",onClick:a.goBack},null,8,["onClick"])])])]),_:1}),e(oa,null,{default:t(()=>[e(aa,{class:"q-pa-md"},{default:t(()=>[e(Z,{showing:a.loading},{default:t(()=>[e(Y,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a.loading?D("",!0):(h(),H("div",da,[e(g,{class:"info-card"},{default:t(()=>[e(u,null,{default:t(()=>o[6]||(o[6]=[s("div",{class:"text-h6 text-primary"},"Informaci\xF3n de Cuentas de Pago",-1),s("p",{class:"text-body2 q-mt-sm"}," Configure sus cuentas de pago para recibir transferencias autom\xE1ticas cuando los jugadores realicen pagos en su club. Estos datos son encriptados y almacenados de forma segura. ",-1)])),_:1})]),_:1}),e(g,{class:"payment-card"},{default:t(()=>[e(u,null,{default:t(()=>[s("div",ua,[o[7]||(o[7]=s("div",{class:"col"},[s("div",{class:"text-h6 text-primary"},"MercadoPago"),s("div",{class:"text-body2 text-grey-7"},"Configure su cuenta de MercadoPago para recibir pagos")],-1)),s("div",ma,[e(M,{src:na,style:{width:"80px",height:"40px"},contain:""})])])]),_:1}),e(k),e(u,null,{default:t(()=>[e(E,null,{default:t(()=>[s("div",pa,[e(v,{modelValue:a.mercadopagoForm.email,"onUpdate:modelValue":o[0]||(o[0]=n=>a.mercadopagoForm.email=n),label:"Email de MercadoPago",placeholder:a.paymentAccounts.mercadopago_email||"usuario@ejemplo.com",type:"email",outlined:"",dense:"",suffix:a.paymentAccounts.has_mercadopago_email?"(Configurado)":"",hint:a.paymentAccounts.has_mercadopago_email?`Actual: ${a.paymentAccounts.mercadopago_email}`:"Email asociado a su cuenta de MercadoPago"},null,8,["modelValue","placeholder","suffix","hint"]),e(v,{modelValue:a.mercadopagoForm.clientId,"onUpdate:modelValue":o[1]||(o[1]=n=>a.mercadopagoForm.clientId=n),label:"Client ID de MercadoPago",placeholder:a.paymentAccounts.mercadopago_client_id||"APP_USR-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",outlined:"",dense:"",suffix:a.paymentAccounts.has_mercadopago_client_id?"(Configurado)":"",hint:a.paymentAccounts.has_mercadopago_client_id?`Actual: ${a.paymentAccounts.mercadopago_client_id}`:"Client ID de su aplicaci\xF3n de MercadoPago"},null,8,["modelValue","placeholder","suffix","hint"])])]),_:1})]),_:1})]),_:1}),e(g,{class:"payment-card"},{default:t(()=>[e(u,null,{default:t(()=>[s("div",ga,[o[8]||(o[8]=s("div",{class:"col"},[s("div",{class:"text-h6 text-primary"},"Stripe"),s("div",{class:"text-body2 text-grey-7"},"Configure su cuenta de Stripe para recibir pagos (pr\xF3ximamente)")],-1)),s("div",fa,[e(M,{src:"https://stripe.com/img/v3/newsroom/social.png",style:{width:"80px",height:"40px"},contain:""})])])]),_:1}),e(k),e(u,null,{default:t(()=>[e(E,null,{default:t(()=>[s("div",_a,[e(v,{modelValue:a.stripeForm.accountId,"onUpdate:modelValue":o[2]||(o[2]=n=>a.stripeForm.accountId=n),label:"Stripe Account ID",placeholder:a.paymentAccounts.stripe_account_id||"acct_xxxxxxxxxxxxxxxxxx",outlined:"",dense:"",suffix:a.paymentAccounts.has_stripe_account_id?"(Configurado)":"",hint:a.paymentAccounts.has_stripe_account_id?`Actual: ${a.paymentAccounts.stripe_account_id}`:"ID de su cuenta de Stripe Connect",disable:!0},null,8,["modelValue","placeholder","suffix","hint"]),e($,{class:"bg-black-3"},{avatar:t(()=>[e(R,{name:"info",color:"primary"})]),default:t(()=>[o[9]||(o[9]=V(" La integraci\xF3n con Stripe estar\xE1 disponible pr\xF3ximamente para mercados internacionales. "))]),_:1})])]),_:1})]),_:1})]),_:1}),s("div",xa,[e(x,{color:"primary",label:"Guardar Configuraci\xF3n",icon:"save",size:"lg",loading:a.saving,onClick:a.openPasswordDialog,disable:!a.hasChanges},null,8,["loading","onClick","disable"])]),a.paymentAccounts.last_updated?(h(),P(g,{key:0,class:"q-mt-md"},{default:t(()=>[e(u,{class:"text-center"},{default:t(()=>[s("div",va," \xDAltima actualizaci\xF3n: "+J(a.formatDate(a.paymentAccounts.last_updated)),1)]),_:1})]),_:1})):D("",!0)])),e(T,{modelValue:a.showPasswordDialog,"onUpdate:modelValue":o[4]||(o[4]=n=>a.showPasswordDialog=n),persistent:""},{default:t(()=>[e(g,{style:{"min-width":"350px"}},{default:t(()=>[e(u,null,{default:t(()=>o[10]||(o[10]=[s("div",{class:"text-h6"},"Confirmar Cambios",-1),s("div",{class:"text-body2 q-mt-sm"}," Por seguridad, confirme su contrase\xF1a para actualizar la informaci\xF3n de cuentas de pago. ",-1)])),_:1}),e(u,{class:"q-pt-none"},{default:t(()=>[e(v,{modelValue:a.passwordConfirmation,"onUpdate:modelValue":o[3]||(o[3]=n=>a.passwordConfirmation=n),label:"Contrase\xF1a",type:"password",outlined:"",dense:"",autofocus:"",onKeyup:O(a.savePaymentAccounts,["enter"]),error:a.passwordError,"error-message":a.passwordErrorMessage},null,8,["modelValue","onKeyup","error","error-message"])]),_:1}),e(W,{align:"right"},{default:t(()=>[e(x,{flat:"",label:"Cancelar",color:"grey",onClick:a.closePasswordDialog},null,8,["onClick"]),e(x,{label:"Confirmar",color:"primary",onClick:a.savePaymentAccounts,loading:a.saving,disable:!a.passwordConfirmation},null,8,["onClick","loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d)]),_:1})}var Na=la(ra,[["render",ya],["__scopeId","data-v-12bf9c61"]]);export{Na as default};
