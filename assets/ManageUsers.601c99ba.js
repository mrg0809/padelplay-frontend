import{Q as v}from"./QHeader.289f0645.js";import{Q as U}from"./QSelect.8af2919e.js";import{Q as y}from"./QTable.d55388d6.js";import{a5 as k,x as B,f as C,a6 as d,o as c,z as m,A as u,d as o,B as t,t as p,D as f}from"./index.687b44e8.js";import{Q as A}from"./QPage.fcc9aae1.js";import{Q as w,a as x}from"./QLayout.30990248.js";import{s as P}from"./supabase.66aa98e2.js";import{N as Q}from"./NotificationBell.9fdba392.js";import{A as T}from"./AdminTopMenu.86b099e2.js";import{S as F}from"./SuperuserTopMenu.ed9d82e7.js";import{B as M}from"./BannerPromoScrolling.1700e538.js";import{_ as S}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.c9b5cbc6.js";import"./QItem.eb9291fb.js";import"./QItemLabel.bbebea39.js";import"./QMenu.df8dfc7c.js";import"./position-engine.46674690.js";import"./selection.0f785986.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.1288e946.js";import"./QMarkupTable.41f62a4b.js";import"./use-fullscreen.637c26ee.js";import"./QBadge.0c3a126f.js";import"./api.1c42dce4.js";import"./QBtnDropdown.17175f2e.js";import"./QBtnGroup.6b9d07ee.js";import"./haptics.57409bd0.js";const N={name:"ManageUsers",components:{NotificationBell:Q,AdminTopMenu:T,SuperuserTopMenu:F,BannerPromoScrolling:M},setup(){const s=k(),e=B(),r=C(()=>s.path.startsWith("/admin"));return{isAdminPath:r,goBack:()=>e.push(r.value?"/dashboard/admin":"/dashboard/superuser")}},data(){return{users:[],filteredUsers:[],selectedFilter:"all",filters:[{label:"Todos",value:"all"},{label:"Clubes",value:"club"},{label:"Padelite",value:"padelite"},{label:"Asociaciones",value:"association"}],columns:[{name:"email",label:"Correo",align:"left",field:"email"},{name:"name",label:"Nombre",align:"left",field:"name"}]}},computed:{totalClubs(){return this.users.filter(s=>s.user_type==="club").length},totalPadelite(){return this.users.filter(s=>s.user_type==="padelite").length},totalAssociations(){return this.users.filter(s=>s.user_type==="association").length}},methods:{async fetchUsers(){try{const{data:s,error:e}=await P.rpc("get_users_with_profiles");if(e){console.error("Error al obtener usuarios:",e.message);return}this.users=s.map(r=>({id:r.id,email:r.email,name:r.full_name,user_type:r.user_type})),console.log("Usuarios cargados:",this.users),this.filterUsers()}catch(s){console.error("Error inesperado:",s.message)}},filterUsers(){console.log("Filtro seleccionado:",this.selectedFilter),console.log("Usuarios antes de filtrar:",this.users),this.selectedFilter.value==="all"?this.filteredUsers=[...this.users]:this.filteredUsers=this.users.filter(s=>(console.log("Comparando:",s.user_type,"con",this.selectedFilter.value),s.user_type===this.selectedFilter.value)),console.log("Usuarios filtrados:",this.filteredUsers)},addUser(s){const e=this.$route.path.startsWith("/superuser")?"/superuser":"/admin";this.$router.push(`${e}/create-account`)}},watch:{selectedFilter:"filterUsers"},mounted(){this.fetchUsers()}},q={class:"header-content"},V={class:"greeting"},R={class:"header-icons"},D={class:"q-mb-md"},E={class:"q-mt-md text-white"},H={class:"q-mb-md text-right"};function L(s,e,r,n,i,l){const h=d("NotificationBell"),g=d("AdminTopMenu"),_=d("SuperuserTopMenu"),b=d("BannerPromoScrolling");return c(),m(w,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:u(()=>[o(v,{elevated:"",class:"text-white admin-header"},{default:u(()=>[t("div",q,[t("div",V,[t("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...a)=>n.goBack&&n.goBack(...a))}),e[5]||(e[5]=t("span",{class:"text-subtitle1"},"Usuarios",-1))]),t("div",R,[o(h),n.isAdminPath?(c(),m(g,{key:0})):(c(),m(_,{key:1}))])]),o(b)]),_:1}),o(x,null,{default:u(()=>[o(A,{class:"q-pa-md"},{default:u(()=>[t("div",D,[o(U,{modelValue:i.selectedFilter,"onUpdate:modelValue":e[1]||(e[1]=a=>i.selectedFilter=a),options:i.filters,label:"Filtrar por tipo de usuario",outlined:"",dense:"",color:"primary",onChange:l.filterUsers},null,8,["modelValue","options","onChange"])]),o(y,{flat:"",rows:i.filteredUsers,columns:i.columns,"row-key":"id",dense:"",class:"text-white bg-dark","hide-bottom":""},null,8,["rows","columns"]),t("div",E,[t("p",null,"Total Clubes: "+p(l.totalClubs),1),t("p",null,"Total Padelite: "+p(l.totalPadelite),1),t("p",null,"Total Asociaciones: "+p(l.totalAssociations),1)]),t("div",H,[o(f,{label:"Agregar Club",color:"primary",icon:"add",class:"q-mr-md",onClick:e[2]||(e[2]=a=>l.addUser("club"))}),o(f,{label:"Agregar Padelite",color:"primary",icon:"add",class:"q-mr-md",onClick:e[3]||(e[3]=a=>l.addUser("padelite"))}),o(f,{label:"Agregar Asociaci\xF3n",color:"primary",icon:"add",onClick:e[4]||(e[4]=a=>l.addUser("association"))})])]),_:1})]),_:1})]),_:1})}var ge=S(N,[["render",L],["__scopeId","data-v-0db58a68"]]);export{ge as default};
