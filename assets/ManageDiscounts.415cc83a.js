import{Q as M}from"./QToolbarTitle.9aa9d658.js";import{a0 as U,r as x,h as q,a6 as N,o as m,z as y,A as l,d as o,a9 as g,D as v,a7 as T,a8 as V,B as D,aT as B,E as s,ad as F,aK as E,a as P,aa as h,ab as A,e as O,s as R,t as p}from"./index.343c8145.js";import{Q as L}from"./QToolbar.998a6c3e.js";import{Q as G}from"./QHeader.74e9ea06.js";import{Q as c}from"./QSelect.3addf350.js";import{Q as H}from"./QForm.4454f63e.js";import{Q as S}from"./QItemLabel.05574ce5.js";import{Q as J,a as W}from"./QItem.a116c19a.js";import{Q as j}from"./QList.0714427a.js";import{Q as z}from"./QPage.c2a4954a.js";import{Q as K,a as X}from"./QLayout.cf8964e2.js";import{C as Y}from"./ClubNavigationMenu.bdd440a7.js";import{u as Z}from"./use-quasar.ffcb6c45.js";import{a as C}from"./api.c78da0f8.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.29699f7b.js";import"./QMenu.0333eeb9.js";import"./position-engine.74637788.js";import"./selection.77230eb1.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QTabs.ffe1e49b.js";import"./QFooter.32609e6a.js";const ee={components:{ClubNavigationMenu:Y},methods:{goBack(){this.$router.back()}},setup(){const d=Z(),e=U({club_id:null,type:null,discount_percentage:null,fixed_price:null,applicable_days:[],start_time:null,end_time:null,start_date:null,end_date:null,description:""}),f=x([]),a=async()=>{try{const n=await C.get("/promo");f.value=n.data}catch{d.notify({type:"negative",message:"Error al cargar los descuentos"})}},k=async()=>{const n=await R.getItem("token");if(n){const r=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(atob(r)).club_id}return null},b=async()=>{var n,i;try{e.club_id=await k(),e.type=e.type.value,e.applicable_days=e.applicable_days.map(r=>r.value),await C.post("/promo",e),d.notify({type:"positive",message:"Descuento o promoci\xF3n creado exitosamente"}),a(),u()}catch(r){console.error("Error en submitDiscount:",r.response||r),d.notify({type:"negative",message:((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.detail)||"Error al guardar el descuento o promoci\xF3n"})}},u=()=>{e.discount_percentage=0,e.fixed_price=0,e.applicable_days=[],e.start_time=null,e.end_time=null,e.start_date=null,e.end_date=null,e.description=""};q(()=>{a()});const t=[{label:"Descuento",value:"discount"}],I=[{label:"Lunes",value:1},{label:"Martes",value:2},{label:"Mi\xE9rcoles",value:3},{label:"Jueves",value:4},{label:"Viernes",value:5},{label:"S\xE1bado",value:6},{label:"Domingo",value:0}],w=Array.from({length:48},(n,i)=>{const r=Math.floor(i/2),Q=i%2===0?"00":"30";return`${r.toString().padStart(2,"0")}:${Q}`}),_=x(null);return{form:e,discounts:f,discountTypes:t,daysOfWeek:I,submitDiscount:b,resetInputs:u,timeOptions:w,applicableDaysSelectRef:_,closeSelect:()=>{_.value&&_.value.hidePopup()}}}};function ae(d,e,f,a,k,b){const u=N("ClubNavigationMenu");return m(),y(K,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:l(()=>[o(G,{class:"bg-primary text-white"},{default:l(()=>[o(L,null,{default:l(()=>[o(M,null,{default:l(()=>[...e[9]||(e[9]=[g("Gestionar Promociones",-1)])]),_:1}),o(v,{flat:"",round:"",icon:"arrow_back",onClick:b.goBack,label:"REGRESAR"},null,8,["onClick"])]),_:1})]),_:1}),o(X,null,{default:l(()=>[o(z,{class:"q-pa-md"},{default:l(()=>[o(T,{dark:"",class:"q-pa-md bg-dark"},{default:l(()=>[o(V,null,{default:l(()=>[...e[10]||(e[10]=[D("h2",{class:"text-h5 text-white"},"Gesti\xF3n de Descuentos y Promociones",-1)])]),_:1}),o(H,{onSubmit:B(a.submitDiscount,["prevent"])},{default:l(()=>[o(V,{class:"q-gutter-y-md"},{default:l(()=>[o(c,{modelValue:a.form.type,"onUpdate:modelValue":[e[0]||(e[0]=t=>a.form.type=t),a.resetInputs],options:a.discountTypes,label:"Tipo","option-value":"value","option-label":"label",dense:"",outlined:"",dark:"",required:""},null,8,["modelValue","options","onUpdate:modelValue"]),o(s,{modelValue:a.form.name,"onUpdate:modelValue":e[1]||(e[1]=t=>a.form.name=t),label:"Nombre de promo",type:"text",dense:"",outlined:"",dark:"",min:"0",required:""},null,8,["modelValue"]),o(s,{modelValue:a.form.fixed_price,"onUpdate:modelValue":e[2]||(e[2]=t=>a.form.fixed_price=t),modelModifiers:{number:!0},label:"Precio Fijo",type:"number",dense:"",outlined:"",dark:"",min:"0",required:""},null,8,["modelValue"]),o(c,{ref:"applicableDaysSelectRef",modelValue:a.form.applicable_days,"onUpdate:modelValue":e[3]||(e[3]=t=>a.form.applicable_days=t),options:a.daysOfWeek,label:"D\xEDas Aplicables",multiple:"","option-value":"value","option-label":"label",dense:"",outlined:"",dark:"","use-chips":""},{append:l(()=>[o(v,{round:"",dense:"",flat:"",icon:"check",onClick:a.closeSelect},null,8,["onClick"])]),_:1},8,["modelValue","options"]),o(c,{modelValue:a.form.start_time,"onUpdate:modelValue":e[4]||(e[4]=t=>a.form.start_time=t),options:a.timeOptions,label:"Hora de Inicio",outlined:"",dense:"",dark:"",required:""},null,8,["modelValue","options"]),o(c,{modelValue:a.form.end_time,"onUpdate:modelValue":e[5]||(e[5]=t=>a.form.end_time=t),options:a.timeOptions,label:"Hora de Fin",outlined:"",dense:"",dark:"",required:""},null,8,["modelValue","options"]),o(s,{modelValue:a.form.start_date,"onUpdate:modelValue":e[6]||(e[6]=t=>a.form.start_date=t),label:"Fecha de Inicio",type:"date",dense:"",outlined:"",dark:""},null,8,["modelValue"]),o(s,{modelValue:a.form.end_date,"onUpdate:modelValue":e[7]||(e[7]=t=>a.form.end_date=t),label:"Fecha de Fin",type:"date",dense:"",outlined:"",dark:""},null,8,["modelValue"]),o(s,{modelValue:a.form.description,"onUpdate:modelValue":e[8]||(e[8]=t=>a.form.description=t),label:"Descripci\xF3n",type:"textarea",dense:"",outlined:"",dark:""},null,8,["modelValue"])]),_:1}),o(F,{align:"right"},{default:l(()=>[o(v,{label:"Guardar",type:"submit",color:"primary"})]),_:1})]),_:1},8,["onSubmit"]),o(E,{spaced:""}),a.discounts.length?(m(),y(V,{key:0},{default:l(()=>[e[11]||(e[11]=D("h3",{class:"text-h6 text-white"},"Descuentos y Promociones Actuales",-1)),o(j,{dark:""},{default:l(()=>[(m(!0),P(A,null,h(a.discounts,t=>(m(),y(J,{key:t.id,clickable:""},{default:l(()=>[o(W,null,{default:l(()=>[o(S,null,{default:l(()=>[g(p(t.name),1)]),_:2},1024),o(S,{caption:""},{default:l(()=>[g(" Tipo: "+p(t.type)+" | Vigencia: "+p(t.start_date||"Indefinido")+" - "+p(t.end_date||"Indefinido"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):O("",!0)]),_:1})]),_:1})]),_:1}),o(u)]),_:1})}var Ce=$(ee,[["render",ae],["__scopeId","data-v-10296f32"]]);export{Ce as default};
