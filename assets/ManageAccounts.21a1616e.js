import{F as L,r as c,j as T,B as U,a8 as K,q as C,G as P,H as t,v as e,I as s,ab as D,J as x,s as G,a9 as g,aa as u,aM as k,K as v,ae as H,x as R,y as V,ah as J,bF as O,af as W}from"./index.2479bd01.js";import{Q as X}from"./QHeader.ca5ea2b4.js";import{Q as Y}from"./QSpinnerGears.8aae1024.js";import{Q as Z}from"./QInnerLoading.6fed6731.js";import{Q as M}from"./QImg.c2fe02c7.js";import{Q as E}from"./QForm.a32047c6.js";import{Q as $}from"./QBanner.e62d7c88.js";import{Q as aa}from"./QPage.3cd5c2ef.js";import{Q as ea,a as oa}from"./QLayout.70ecc874.js";import{u as ta}from"./use-quasar.ba979e2b.js";import{a as F}from"./api.2af71db3.js";import{n as sa}from"./navigationUtils.2c4b9dee.js";import{C as na}from"./ClubNavigationMenu.0f490a50.js";import{_ as ra}from"./MP_RGB_horizontal.ee11db59.js";import{_ as la}from"./plugin-vue_export-helper.21dcd24c.js";import"./QTabs.fbaedc0b.js";import"./rtl.276c3f1b.js";import"./QFooter.e6ff5f16.js";const ia={name:"ManageAccounts",components:{ClubNavigationMenu:na},setup(){const y=L(),o=ta(),f=c(!0),a=c(!1),_=c(!1),m=c(""),d=c(!1),n=c(""),b=c({mercadopago_email:null,mercadopago_client_id:null,stripe_account_id:null,has_mercadopago_email:!1,has_mercadopago_client_id:!1,has_stripe_account_id:!1,last_updated:null}),r=c({email:"",clientId:""}),p=c({accountId:""}),q=T(()=>r.value.email||r.value.clientId||p.value.accountId),S=()=>{y.back()},w=async()=>{try{f.value=!0;const l=await F.get("/clubs/payment-accounts");b.value=l.data}catch(l){console.error("Error loading payment accounts:",l),o.notify({type:"negative",message:"Error al cargar la informaci\xF3n de cuentas de pago"})}finally{f.value=!1}},B=()=>{m.value="",d.value=!1,n.value="",_.value=!0},A=()=>{_.value=!1,m.value="",d.value=!1,n.value=""},N=async()=>{var l,h,Q,I;if(!m.value){d.value=!0,n.value="La contrase\xF1a es requerida";return}try{a.value=!0,d.value=!1;const i={password_confirmation:m.value};r.value.email&&(i.mercadopago_email=r.value.email),r.value.clientId&&(i.mercadopago_client_id=r.value.clientId),p.value.accountId&&(i.stripe_account_id=p.value.accountId),await F.put("/clubs/payment-accounts",i),o.notify({type:"positive",message:"Cuentas de pago actualizadas exitosamente"}),A(),j(),await w()}catch(i){console.error("Error saving payment accounts:",i),((l=i.response)==null?void 0:l.status)===403?(d.value=!0,n.value="Contrase\xF1a incorrecta"):((h=i.response)==null?void 0:h.status)===400?o.notify({type:"negative",message:((I=(Q=i.response)==null?void 0:Q.data)==null?void 0:I.detail)||"Error de validaci\xF3n en los datos proporcionados"}):o.notify({type:"negative",message:"Error al actualizar las cuentas de pago"})}finally{a.value=!1}},j=()=>{r.value.email="",r.value.clientId="",p.value.accountId=""},z=l=>l?new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return U(()=>{w()}),{loading:f,saving:a,showPasswordDialog:_,passwordConfirmation:m,passwordError:d,passwordErrorMessage:n,paymentAccounts:b,mercadopagoForm:r,stripeForm:p,hasChanges:q,goBack:S,openPasswordDialog:B,closePasswordDialog:A,savePaymentAccounts:N,formatDate:z,goToDashboard:()=>{sa(y,userStore)}}}},ca={class:"header-content"},da={class:"greeting"},ua={class:"header-icons"},ma={key:0,class:"q-gutter-md"},pa={class:"row items-center justify-between"},ga={class:"col-auto"},fa={class:"q-gutter-md"},_a={class:"row items-center justify-between"},xa={class:"col-auto"},va={class:"q-gutter-md"},ya={class:"row justify-center q-mt-lg"},ha={class:"text-caption text-grey-7"};function Ca(y,o,f,a,_,m){const d=K("ClubNavigationMenu");return C(),P(ea,{view:"hHh lpR fFf",class:"body text-white"},{default:t(()=>[e(X,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[s("div",ca,[s("div",da,[s("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:o[0]||(o[0]=(...n)=>a.goToDashboard&&a.goToDashboard(...n))}),o[6]||(o[6]=D(" Cuentas de Pago "))]),s("div",ua,[e(x,{flat:"",round:"",icon:"arrow_back",onClick:a.goBack},null,8,["onClick"])])])]),_:1}),e(oa,null,{default:t(()=>[e(aa,{class:"q-pa-md"},{default:t(()=>[e(Z,{showing:a.loading},{default:t(()=>[e(Y,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a.loading?V("",!0):(C(),G("div",ma,[e(g,{class:"info-card"},{default:t(()=>[e(u,null,{default:t(()=>o[7]||(o[7]=[s("div",{class:"text-h6 text-primary"},"Informaci\xF3n de Cuentas de Pago",-1),s("p",{class:"text-body2 q-mt-sm"}," Configure sus cuentas de pago para recibir transferencias autom\xE1ticas cuando los jugadores realicen pagos en su club. Estos datos son encriptados y almacenados de forma segura. ",-1)])),_:1})]),_:1}),e(g,{class:"payment-card"},{default:t(()=>[e(u,null,{default:t(()=>[s("div",pa,[o[8]||(o[8]=s("div",{class:"col"},[s("div",{class:"text-h6 text-primary"},"MercadoPago"),s("div",{class:"text-body2 text-grey-7"},"Configure su cuenta de MercadoPago para recibir pagos")],-1)),s("div",ga,[e(M,{src:ra,style:{width:"80px",height:"40px"},contain:""})])])]),_:1}),e(k),e(u,null,{default:t(()=>[e(E,null,{default:t(()=>[s("div",fa,[e(v,{modelValue:a.mercadopagoForm.email,"onUpdate:modelValue":o[1]||(o[1]=n=>a.mercadopagoForm.email=n),label:"Email de MercadoPago",placeholder:a.paymentAccounts.mercadopago_email||"usuario@ejemplo.com",type:"email",outlined:"",dense:"",suffix:a.paymentAccounts.has_mercadopago_email?"(Configurado)":"",hint:a.paymentAccounts.has_mercadopago_email?`Actual: ${a.paymentAccounts.mercadopago_email}`:"Email asociado a su cuenta de MercadoPago"},null,8,["modelValue","placeholder","suffix","hint"]),e(v,{modelValue:a.mercadopagoForm.clientId,"onUpdate:modelValue":o[2]||(o[2]=n=>a.mercadopagoForm.clientId=n),label:"Client ID de MercadoPago",placeholder:a.paymentAccounts.mercadopago_client_id||"APP_USR-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",outlined:"",dense:"",suffix:a.paymentAccounts.has_mercadopago_client_id?"(Configurado)":"",hint:a.paymentAccounts.has_mercadopago_client_id?`Actual: ${a.paymentAccounts.mercadopago_client_id}`:"Client ID de su aplicaci\xF3n de MercadoPago"},null,8,["modelValue","placeholder","suffix","hint"])])]),_:1})]),_:1})]),_:1}),e(g,{class:"payment-card"},{default:t(()=>[e(u,null,{default:t(()=>[s("div",_a,[o[9]||(o[9]=s("div",{class:"col"},[s("div",{class:"text-h6 text-primary"},"Stripe"),s("div",{class:"text-body2 text-grey-7"},"Configure su cuenta de Stripe para recibir pagos (pr\xF3ximamente)")],-1)),s("div",xa,[e(M,{src:"https://stripe.com/img/v3/newsroom/social.png",style:{width:"80px",height:"40px"},contain:""})])])]),_:1}),e(k),e(u,null,{default:t(()=>[e(E,null,{default:t(()=>[s("div",va,[e(v,{modelValue:a.stripeForm.accountId,"onUpdate:modelValue":o[3]||(o[3]=n=>a.stripeForm.accountId=n),label:"Stripe Account ID",placeholder:a.paymentAccounts.stripe_account_id||"acct_xxxxxxxxxxxxxxxxxx",outlined:"",dense:"",suffix:a.paymentAccounts.has_stripe_account_id?"(Configurado)":"",hint:a.paymentAccounts.has_stripe_account_id?`Actual: ${a.paymentAccounts.stripe_account_id}`:"ID de su cuenta de Stripe Connect",disable:!0},null,8,["modelValue","placeholder","suffix","hint"]),e($,{class:"bg-black-3"},{avatar:t(()=>[e(H,{name:"info",color:"primary"})]),default:t(()=>[o[10]||(o[10]=D(" La integraci\xF3n con Stripe estar\xE1 disponible pr\xF3ximamente para mercados internacionales. "))]),_:1})])]),_:1})]),_:1})]),_:1}),s("div",ya,[e(x,{color:"primary",label:"Guardar Configuraci\xF3n",icon:"save",size:"lg",loading:a.saving,onClick:a.openPasswordDialog,disable:!a.hasChanges},null,8,["loading","onClick","disable"])]),a.paymentAccounts.last_updated?(C(),P(g,{key:0,class:"q-mt-md"},{default:t(()=>[e(u,{class:"text-center"},{default:t(()=>[s("div",ha," \xDAltima actualizaci\xF3n: "+R(a.formatDate(a.paymentAccounts.last_updated)),1)]),_:1})]),_:1})):V("",!0)])),e(J,{modelValue:a.showPasswordDialog,"onUpdate:modelValue":o[5]||(o[5]=n=>a.showPasswordDialog=n),persistent:""},{default:t(()=>[e(g,{style:{"min-width":"350px"}},{default:t(()=>[e(u,null,{default:t(()=>o[11]||(o[11]=[s("div",{class:"text-h6"},"Confirmar Cambios",-1),s("div",{class:"text-body2 q-mt-sm"}," Por seguridad, confirme su contrase\xF1a para actualizar la informaci\xF3n de cuentas de pago. ",-1)])),_:1}),e(u,{class:"q-pt-none"},{default:t(()=>[e(v,{modelValue:a.passwordConfirmation,"onUpdate:modelValue":o[4]||(o[4]=n=>a.passwordConfirmation=n),label:"Contrase\xF1a",type:"password",outlined:"",dense:"",autofocus:"",onKeyup:O(a.savePaymentAccounts,["enter"]),error:a.passwordError,"error-message":a.passwordErrorMessage},null,8,["modelValue","onKeyup","error","error-message"])]),_:1}),e(W,{align:"right"},{default:t(()=>[e(x,{flat:"",label:"Cancelar",color:"grey",onClick:a.closePasswordDialog},null,8,["onClick"]),e(x,{label:"Confirmar",color:"primary",onClick:a.savePaymentAccounts,loading:a.saving,disable:!a.passwordConfirmation},null,8,["onClick","loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d)]),_:1})}var Ta=la(ia,[["render",Ca],["__scopeId","data-v-4866ef7e"]]);export{Ta as default};
