import{a8 as y,q as _,G as p,H as t,v as a,ae as b,ab as c,J as g,I as s,a9 as u,aa as m,K as v,x as i,y as w}from"./index.16289384.js";import{Q as D,a as x}from"./QToolbar.d43fba3a.js";import{Q}from"./QHeader.455f548f.js";import{Q as T}from"./QSelect.b5b6a584.js";import{Q as C}from"./QBadge.fb3591e4.js";import{Q as f}from"./QTd.8910b94b.js";import{Q as A}from"./QTable.122f2f00.js";import{Q as V}from"./QBanner.2a9965b2.js";import{Q as q}from"./QPage.14746aa2.js";import{Q as k,a as I}from"./QLayout.7605203b.js";import{a as N,b as F}from"./admin.dfdc6f99.js";import{A as M}from"./AdminNavigationMenu.5742583c.js";import{_ as S}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.dbad0224.js";import"./QItem.0665de17.js";import"./QItemLabel.69569666.js";import"./QMenu.9eb0cccc.js";import"./position-engine.2d9c9af2.js";import"./selection.dbe812eb.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./QList.91cab200.js";import"./use-fullscreen.f07cda3a.js";import"./api.92f95132.js";import"./QTabs.7e37d315.js";import"./QFooter.2de1729e.js";const U={name:"AdminTransactions",components:{AdminNavigationMenu:M},data(){return{transactionData:{transactions:[],total_count:0},clubOptions:[],filters:{startDate:"",endDate:"",clubId:null},loading:!1,error:null,pagination:{rowsPerPage:15},columns:[{name:"order_date",required:!0,label:"Fecha",align:"left",field:"order_date",sortable:!0},{name:"transaction_id",label:"ID Transacci\xF3n",align:"left",field:"transaction_id"},{name:"user_name",label:"Usuario",align:"left",field:"user_name"},{name:"club_name",label:"Club",align:"left",field:"club_name"},{name:"total_amount",label:"Monto",align:"right",field:"total_amount",sortable:!0},{name:"payment_method",label:"M\xE9todo",align:"center",field:"payment_method"},{name:"payment_status",label:"Estado",align:"center",field:"payment_status"}]}},computed:{totalAmount(){return this.transactionData.transactions.reduce((e,l)=>e+(parseFloat(l.total_amount)||0),0)},averageAmount(){return this.transactionData.transactions.length>0?this.totalAmount/this.transactionData.transactions.length:0}},async mounted(){await this.loadClubs(),await this.loadTransactions()},methods:{async loadClubs(){try{const e=await N();this.clubOptions=[{label:"Todos los clubes",value:null},...e.clubs.map(l=>({label:l.name,value:l.id}))]}catch(e){console.error("Error loading clubs:",e)}},async loadTransactions(){this.loading=!0,this.error=null;try{const e={startDate:this.filters.startDate||void 0,endDate:this.filters.endDate||void 0,clubId:this.filters.clubId||void 0};this.transactionData=await F(e)}catch(e){this.error="Error al cargar las transacciones: "+e.message,console.error("Error loading transactions:",e)}finally{this.loading=!1}},clearFilters(){this.filters={startDate:"",endDate:"",clubId:null},this.loadTransactions()},onRequest(e){},formatCurrency(e){return e?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e):"$0.00"},formatDate(e){return e?new Date(e).toLocaleDateString("es-MX"):"N/A"},formatStatus(e){return{succeeded:"Exitoso",pending:"Pendiente",failed:"Fallido",cancelled:"Cancelado"}[e]||e},getStatusColor(e){return{succeeded:"positive",pending:"warning",failed:"negative",cancelled:"grey"}[e]||"grey"}}},B={class:"q-pa-md"},P={class:"row q-gutter-md items-end"},E={class:"col-md-3 col-sm-6"},R={class:"col-md-3 col-sm-6"},L={class:"col-md-4 col-sm-12"},H={class:"col-auto"},O={class:"row q-gutter-md q-mb-lg"},X={class:"col-md-4"},z={class:"text-h4 text-primary"},G={class:"col-md-4"},J={class:"text-h4 text-positive"},K={class:"col-md-4"},j={class:"text-h4 text-secondary"},W={class:"text-weight-bold"};function Y(e,l,Z,$,r,n){const h=y("AdminNavigationMenu");return _(),p(k,{view:"hHh lpR fFf",class:"bg-dark text-white"},{default:t(()=>[a(Q,{elevated:"",class:"bg-primary text-white"},{default:t(()=>[a(D,null,{default:t(()=>[a(x,null,{default:t(()=>[a(b,{name:"account_balance_wallet",class:"q-mr-sm"}),l[3]||(l[3]=c(" Transacciones "))]),_:1}),a(g,{flat:"",icon:"refresh",onClick:n.loadTransactions,loading:r.loading,label:"Actualizar"},null,8,["onClick","loading"])]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(q,{padding:"",class:"bg-dark"},{default:t(()=>[s("div",B,[l[7]||(l[7]=s("div",{class:"row q-mb-lg"},[s("div",{class:"col"},[s("p",{class:"text-grey-4"}," Consulta todas las transacciones de la plataforma ")])],-1)),a(u,{class:"filter-card q-mb-md"},{default:t(()=>[a(m,null,{default:t(()=>[s("div",P,[s("div",E,[a(v,{modelValue:r.filters.startDate,"onUpdate:modelValue":[l[0]||(l[0]=o=>r.filters.startDate=o),n.loadTransactions],type:"date",label:"Fecha inicio",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",R,[a(v,{modelValue:r.filters.endDate,"onUpdate:modelValue":[l[1]||(l[1]=o=>r.filters.endDate=o),n.loadTransactions],type:"date",label:"Fecha fin",filled:"",dark:""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",L,[a(T,{modelValue:r.filters.clubId,"onUpdate:modelValue":[l[2]||(l[2]=o=>r.filters.clubId=o),n.loadTransactions],options:r.clubOptions,"option-value":"value","option-label":"label",label:"Filtrar por club",filled:"",dark:"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",H,[a(g,{flat:"",icon:"clear",color:"grey-7",onClick:n.clearFilters,label:"Limpiar"},null,8,["onClick"])])])]),_:1})]),_:1}),s("div",O,[s("div",X,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[4]||(l[4]=s("div",{class:"text-h6 text-white"},"Total Transacciones",-1)),s("div",z,i(r.transactionData.total_count),1)]),_:1})]),_:1})]),s("div",G,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[5]||(l[5]=s("div",{class:"text-h6 text-white"},"Monto Total",-1)),s("div",J,i(n.formatCurrency(n.totalAmount)),1)]),_:1})]),_:1})]),s("div",K,[a(u,{class:"summary-card"},{default:t(()=>[a(m,null,{default:t(()=>[l[6]||(l[6]=s("div",{class:"text-h6 text-white"},"Promedio",-1)),s("div",j,i(n.formatCurrency(n.averageAmount)),1)]),_:1})]),_:1})])]),a(u,{class:"table-card"},{default:t(()=>[a(m,{class:"q-pa-none"},{default:t(()=>[a(A,{rows:r.transactionData.transactions,columns:r.columns,"row-key":"id",flat:"",dark:"",loading:r.loading,pagination:r.pagination,onRequest:n.onRequest},{"body-cell-payment_status":t(o=>[a(f,{props:o},{default:t(()=>[a(C,{color:n.getStatusColor(o.value),label:n.formatStatus(o.value)},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-total_amount":t(o=>[a(f,{props:o},{default:t(()=>[s("span",W,i(n.formatCurrency(o.value)),1)]),_:2},1032,["props"])]),"body-cell-order_date":t(o=>[a(f,{props:o},{default:t(()=>[c(i(n.formatDate(o.value)),1)]),_:2},1032,["props"])]),"body-cell-club_name":t(o=>[a(f,{props:o},{default:t(()=>{var d;return[c(i(((d=o.row.clubs)==null?void 0:d.name)||"N/A"),1)]}),_:2},1032,["props"])]),"body-cell-user_name":t(o=>[a(f,{props:o},{default:t(()=>{var d;return[c(i(((d=o.row.profiles)==null?void 0:d.full_name)||"N/A"),1)]}),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","pagination","onRequest"])]),_:1})]),_:1}),r.error?(_(),p(V,{key:0,class:"bg-negative text-white q-mt-md"},{avatar:t(()=>[a(b,{name:"error"})]),default:t(()=>[c(" "+i(r.error),1)]),_:1})):w("",!0)])]),_:1})]),_:1}),a(h)]),_:1})}var Ca=S(U,[["render",Y],["__scopeId","data-v-33df11b0"]]);export{Ca as default};
