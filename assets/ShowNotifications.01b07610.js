import{g as U,aq as j,as as F,r as V,f as I,b3 as X,S as O,j as S,k as H,ae as G,l as W,y as Y,o as h,z as w,A as r,d as s,B as g,D as q,a7 as J,a8 as K,e as N,a as L,ac as $,bW as Z,aa as ee,ab as te,a9 as B,t as E,aT as ie}from"./index.343c8145.js";import{Q as oe}from"./QHeader.74e9ea06.js";import{Q as ae}from"./QSpinnerDots.81304d51.js";import{Q as se,a as R}from"./QItem.a116c19a.js";import{Q as T}from"./QItemLabel.05574ce5.js";import{T as re}from"./TouchPan.f80222c1.js";import{u as ne}from"./use-render-cache.3aae9b27.js";import{Q as le}from"./QList.0714427a.js";import{Q as ce}from"./QPage.c2a4954a.js";import{Q as de,a as fe}from"./QLayout.cf8964e2.js";import{a as k}from"./api.c78da0f8.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./touch.9135741d.js";import"./selection.77230eb1.js";const M=[["left","center","start","width"],["right","center","end","width"],["top","start","center","height"],["bottom","end","center","height"]];var me=U({name:"QSlideItem",props:{...j,leftColor:String,rightColor:String,topColor:String,bottomColor:String,onSlide:Function},emits:["action","top","right","bottom","left"],setup(t,{slots:e,emit:y}){const{proxy:Q}=W(),{$q:m}=Q,f=F(t,m),{getCache:n}=ne(),p=V(null);let _=null,o={},x={},C={};const v=I(()=>m.lang.rtl===!0?{left:"right",right:"left"}:{left:"left",right:"right"}),z=I(()=>"q-slide-item q-item-type overflow-hidden"+(f.value===!0?" q-slide-item--dark q-dark":""));function D(){p.value.style.transform="translate(0,0)"}function A(i,u,l){t.onSlide!==void 0&&y("slide",{side:i,ratio:u,isReset:l})}function P(i){const u=p.value;if(i.isFirst)o={dir:null,size:{left:0,right:0,top:0,bottom:0},scale:0},u.classList.add("no-transition"),M.forEach(a=>{if(e[a[0]]!==void 0){const b=C[a[0]];b.style.transform="scale(1)",o.size[a[0]]=b.getBoundingClientRect()[a[3]]}}),o.axis=i.direction==="up"||i.direction==="down"?"Y":"X";else if(i.isFinal){u.classList.remove("no-transition"),o.scale===1?(u.style.transform=`translate${o.axis}(${o.dir*100}%)`,_!==null&&clearTimeout(_),_=setTimeout(()=>{_=null,y(o.showing,{reset:D}),y("action",{side:o.showing,reset:D})},230)):(u.style.transform="translate(0,0)",A(o.showing,0,!0));return}else i.direction=o.axis==="X"?i.offset.x<0?"left":"right":i.offset.y<0?"up":"down";if(e.left===void 0&&i.direction===v.value.right||e.right===void 0&&i.direction===v.value.left||e.top===void 0&&i.direction==="down"||e.bottom===void 0&&i.direction==="up"){u.style.transform="translate(0,0)";return}let l,d,c;o.axis==="X"?(d=i.direction==="left"?-1:1,l=d===1?v.value.left:v.value.right,c=i.distance.x):(d=i.direction==="up"?-2:2,l=d===2?"top":"bottom",c=i.distance.y),!(o.dir!==null&&Math.abs(d)!==Math.abs(o.dir))&&(o.dir!==d&&(["left","right","top","bottom"].forEach(a=>{x[a]&&(x[a].style.visibility=l===a?"visible":"hidden")}),o.showing=l,o.dir=d),o.scale=Math.max(0,Math.min(1,(c-40)/o.size[l])),u.style.transform=`translate${o.axis}(${c*d/Math.abs(d)}px)`,C[l].style.transform=`scale(${o.scale})`,A(l,o.scale,!1))}return X(()=>{x={},C={}}),O(()=>{_!==null&&clearTimeout(_)}),Object.assign(Q,{reset:D}),()=>{const i=[],u={left:e[v.value.right]!==void 0,right:e[v.value.left]!==void 0,up:e.bottom!==void 0,down:e.top!==void 0},l=Object.keys(u).filter(c=>u[c]===!0);M.forEach(c=>{const a=c[0];e[a]!==void 0&&i.push(S("div",{key:a,ref:b=>{x[a]=b},class:`q-slide-item__${a} absolute-full row no-wrap items-${c[1]} justify-${c[2]}`+(t[a+"Color"]!==void 0?` bg-${t[a+"Color"]}`:"")},[S("div",{ref:b=>{C[a]=b}},e[a]())]))});const d=S("div",{key:`${l.length===0?"only-":""} content`,ref:p,class:"q-slide-item__content"},H(e.default));return l.length===0?i.push(d):i.push(G(d,n("dir#"+l.join(""),()=>{const c={prevent:!0,stop:!0,mouse:!0};return l.forEach(a=>{c[a]=!0}),[[re,P,void 0,c]]}))),S("div",{class:z.value},i)}}});const he={data(){return{notifications:[],loading:!1}},setup(){return{userStore:Y()}},async mounted(){await this.fetchNotifications()},methods:{async fetchNotifications(){this.loading=!0;try{const e=(await k.get("/notifications/")).data;e&&Array.isArray(e.data)&&e.data.length>0?this.notifications=e.data:this.notifications=[]}catch(t){console.error("Error fetching notifications:",t),t.message&&t.message.includes("Mixed Content")&&console.error("Mixed Content Error detected in notifications. API Base URL:",k.defaults.baseURL),console.log("Current API configuration:",{baseURL:k.defaults.baseURL,hostname:window.location.hostname,protocol:window.location.protocol}),this.notifications=[],this.$q.notify({type:"negative",message:"Error al cargar las notificaciones. Por favor intenta m\xE1s tarde.",timeout:3e3})}finally{this.loading=!1}},async markAsRead(t,e){try{await k.put(`/notifications/${t}/read`),e?this.$router.push(e):this.fetchNotifications()}catch(y){console.error("Error marking notification as read:",y)}},async deleteNotification(t){try{await k.delete(`/notifications/${t}`),this.fetchNotifications()}catch(e){console.error("Error deleting notification:",e)}},onSlideLeft(t){this.deleteNotification(t)},confirmDeleteAll(){this.$q.dialog({title:"Borrar todas las notificaciones",message:"\xBFEliminar todas las notificaciones? Esta acci\xF3n no se puede deshacer.",cancel:{label:"Cancelar",color:"grey"},ok:{label:"Borrar todas",color:"secondary"},persistent:!0}).onOk(()=>{this.deleteAllNotifications()})},async deleteAllNotifications(){try{await k.delete("/notifications/all"),this.notifications=[],this.$q.notify({type:"positive",message:"Todas las notificaciones han sido eliminadas",timeout:2e3})}catch(t){console.error("Error deleting all notifications:",t),this.$q.notify({type:"negative",message:"Error al eliminar las notificaciones. Intenta de nuevo.",timeout:3e3})}},formatDate(t){if(!t)return"Fecha desconocida";const e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(t).toLocaleDateString("es-MX",e)},goBack(){this.$router.back()},goToDashboard(){const t=this.userStore.userType;t==="player"?this.$router.push("/dashboard/player"):t==="club"?this.$router.push("/dashboard/club"):t==="admin"?this.$router.push("/dashboard/admin"):this.$router.back()}}},ge={class:"header-content"},pe={class:"greeting"},ye={class:"header-icons"},_e={class:"row items-center justify-between"},ve={key:0,class:"text-center q-pa-xl"},be={key:1,class:"text-center q-my-md"};function ke(t,e,y,Q,m,f){return h(),w(de,{view:"hHh lpR fFf",class:"text-white"},{default:r(()=>[s(oe,{elevated:"",class:"bg-primary text-white"},{default:r(()=>[g("div",ge,[g("div",pe,[g("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:e[0]||(e[0]=(...n)=>f.goToDashboard&&f.goToDashboard(...n))})]),g("div",ye,[s(q,{flat:"",round:"",icon:"close",onClick:f.goBack},null,8,["onClick"])])])]),_:1}),s(fe,null,{default:r(()=>[s(ce,{class:"q-pa-md"},{default:r(()=>[s(J,{flat:"",bordered:"",class:"text-black"},{default:r(()=>[s(K,null,{default:r(()=>[g("div",_e,[e[1]||(e[1]=g("div",{class:"text-h6 text-primary"},"Notificaciones",-1)),!m.loading&&m.notifications.length>0?(h(),w(q,{key:0,color:"secondary",label:"Borrar todas",icon:"delete_sweep",outline:"",dense:"",onClick:f.confirmDeleteAll},null,8,["onClick"])):N("",!0)])]),_:1}),m.loading?(h(),L("div",ve,[s(ae,{size:"50px",color:"primary"}),e[2]||(e[2]=g("div",{class:"q-mt-md text-grey-7"},"Cargando notificaciones...",-1))])):m.notifications.length===0?(h(),L("div",be,[s($,{name:"o_notifications_off",size:"64px",color:"black"}),e[3]||(e[3]=g("p",null,"No tienes notificaciones pendientes.",-1))])):(h(),w(le,{key:2},{default:r(()=>[s(Z,{name:"notification-list",tag:"div",appear:""},{default:r(()=>[(h(!0),L(te,null,ee(m.notifications,n=>(h(),w(me,{key:n.id,onLeft:p=>f.onSlideLeft(n.id),"left-color":"grey-8",class:"notification-wrapper"},{left:r(()=>[s($,{name:"delete"})]),default:r(()=>[s(se,{clickable:"",class:"notification-item"},{default:r(()=>[s(R,{avatar:"",onClick:p=>f.markAsRead(n.id,n.route)},{default:r(()=>[s($,{name:"o_notifications",size:"36px",color:"white"})]),_:1},8,["onClick"]),s(R,{onClick:p=>f.markAsRead(n.id,n.route)},{default:r(()=>[s(T,{class:"text-bold"},{default:r(()=>[B(E(n.title),1)]),_:2},1024),s(T,{caption:""},{default:r(()=>[B(E(n.message),1)]),_:2},1024),s(T,{caption:"",class:"text-grey text-sm"},{default:r(()=>[B(E(f.formatDate(n.created_at)),1)]),_:2},1024)]),_:2},1032,["onClick"]),s(R,{side:""},{default:r(()=>[n.is_read?N("",!0):(h(),w(q,{key:0,flat:"",round:"",icon:"done",color:"primary",size:"sm",class:"q-mr-sm",onClick:ie(p=>f.markAsRead(n.id,n.route),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1032,["onLeft"]))),128))]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}var Ie=ue(he,[["render",ke],["__scopeId","data-v-f519a014"]]);export{Ie as default};
