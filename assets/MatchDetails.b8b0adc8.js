import{Q as pe}from"./QHeader.08eb5fd8.js";import{Q as ye}from"./QSpinnerDots.de4cab18.js";import{a5 as fe,x as ge,y as ve,r as u,h as _e,bD as Q,a6 as w,o as t,z as m,A as i,d as s,B as o,e as P,a as n,a7 as z,a8 as A,D as b,ac as V,a9 as x,t as d,bG as N,ab as B,aa as I,E as F,Q as he,ad as be,ae as ke,af as xe}from"./index.673cf58d.js";import{Q as Ce}from"./QPage.1da70bf2.js";import{Q as we,a as Pe}from"./QLayout.6bdb52fd.js";import{Q as R}from"./QItemLabel.20b62e60.js";import{Q as De,a as X}from"./QItem.129857ec.js";import{Q as Me}from"./QList.0e5fa6ef.js";import{C as Qe}from"./ClosePopup.3d5d03c6.js";import{a as Y}from"./api.5f33f013.js";import{u as Se}from"./use-quasar.8083eaf6.js";import{P as Ve}from"./PlayerNavigationMenu.a7f813ce.js";import{B as Ne}from"./BannerPromoScrolling.adcb119c.js";import{N as Ee}from"./NotificationBell.219cf34c.js";import{P as Te}from"./PlayerTopMenu.225cb5eb.js";import{D as je}from"./DesktopNavigation.7dde4d3c.js";import{C as qe}from"./ClubTopMenu.65024292.js";import{C as ze}from"./ClubNavigationMenu.34afbd5e.js";import{s as Ae}from"./players.daa757ea.js";import{f as Be}from"./community.0c600427.js";import{s as Ie}from"./shareUtils.e398f2a8.js";import{_ as Ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./QTabs.decd7594.js";import"./rtl.276c3f1b.js";import"./QFooter.925a22ea.js";import"./admin.929dac80.js";import"./QBadge.dc3230c9.js";import"./QBtnDropdown.81d386d3.js";import"./QBtnGroup.bf413420.js";import"./QMenu.3db3e33e.js";import"./position-engine.e7dd3b6a.js";import"./selection.3a608fc8.js";import"./haptics.b006d2ba.js";import"./QTooltip.3db8e9e4.js";import"./supabase.6e6ca5a2.js";const Je={components:{BannerPromoScrolling:Ne,NotificationBell:Ee,PlayerNavigationMenu:Ve,PlayerTopMenu:Te,DesktopNavigation:je,ClubTopMenu:qe,ClubNavigationMenu:ze},setup(){const y=fe(),a=ge(),p=Se(),e=ve(),c=u(null),k=u([]),E=u([]),T=u(!0),D=u(""),j=u(null),q=u(null),S=u(!1),C=u(!1),r=u([]),f=u([]),g=u([]),L=u([{name:"Set 1",team1score:null,team2score:null},{name:"Set 2",team1score:null,team2score:null},{name:"Set 3",team1score:null,team2score:null}]),U=u(!1),Z=()=>{var _,h;if(!((_=c.value)!=null&&_.match_date)||!((h=c.value)!=null&&h.match_time)){U.value=!1;return}const l=Q(`${c.value.match_date} ${c.value.match_time}`),v=Q();U.value=v.isAfter(l)},H=async()=>{try{const l=await Y.get(`/matches/match/${y.params.matchId}`);c.value=l.data,k.value=l.data.team1_players||[],E.value=l.data.team2_players||[],Z()}catch(l){console.error("Error al cargar los detalles del partido:",l.message),p.notify({type:"negative",message:"Error al cargar los detalles del partido."})}finally{T.value=!1}},$={primera:"1\xBA",segunda:"2\xBA",tercera:"3\xBA",cuarta:"4\xBA",quinta:"5\xBA",sexta:"6\xBA"};function ee(l){return $[l==null?void 0:l.toLowerCase()]||l}const ae=l=>{if(!l){console.warn("Cannot navigate to player profile: playerId is undefined"),p.notify({type:"warning",message:"No se puede acceder al perfil de este jugador"});return}J.value?a.push(`/player/${l}?from=club`):a.push(`/player/${l}`)},te=async(l,v)=>{j.value=l,q.value=v,D.value="",r.value=[],S.value=!0,await oe()},oe=async()=>{try{C.value=!0;const l=await Be(e.userId);f.value=l.slice(0,4),g.value=f.value}catch(l){console.error("Error loading suggested players:",l),f.value=[],g.value=[]}finally{C.value=!1}},le=async()=>{if(D.value.trim()===""){g.value=f.value;return}try{C.value=!0;const l=await Ae(D.value);r.value=l,g.value=l}catch(l){console.error("Error searching players:",l),r.value=[],g.value=[]}finally{C.value=!1}},se=async l=>{var v,_;try{const h={email_or_phone:l.user_id,match_id:y.params.matchId,team:j.value,position:q.value,club_name:c.value.club_name||"No especificado",player_name:l.first_name||"Jugador desconocido",match_date:c.value.match_date||"Fecha desconocida",match_time:c.value.match_time||"Hora desconocida"},M=await Y.post("/matches/add-player",h);M.data.status==="success"?(p.notify({type:"positive",message:"Jugador agregado exitosamente."}),H()):M.data.status==="invited"&&p.notify({type:"info",message:"Jugador invitado a unirse a PadelPlay."}),S.value=!1}catch(h){console.error("Error al agregar jugador:",h.message),p.notify({type:"negative",message:((_=(v=h.response)==null?void 0:v.data)==null?void 0:_.detail)||"Error al agregar jugador."})}},re=async()=>{try{await Y.put(`/matches/match/${y.params.matchId}`,{score:L.value}),p.notify({type:"positive",message:"Resultado guardado exitosamente."})}catch(l){console.error("Error al guardar el resultado:",l.message),p.notify({type:"negative",message:"Error al guardar el resultado."})}},ie=async()=>{var l,v;try{const _=`${window.location.origin}/join/match/${y.params.matchId}`,h="Te invitamos a este gran juego";let M="";if(c.value&&c.value.match_date){Q.locale("es-mx");const ce=Q(c.value.match_date).format("dddd, D [de] MMMM [del] YYYY"),[K,W]=ce.split(" de "),me=K.charAt(0).toUpperCase()+K.slice(1),ue=W.charAt(0).toUpperCase()+W.slice(1);M=me+" de "+ue}const G=((l=c.value)==null?void 0:l.club_name)||"nuestro club",O=(v=c.value)!=null&&v.match_time?c.value.match_time.slice(0,5):"",de=M&&O?`\xA1\xDAnete a este partido de p\xE1del en ${G}! ${M} a las ${O} hrs.`:`\xA1\xDAnete a este partido de p\xE1del en ${G}!`;await Ie(h,_,de)}catch(_){console.error("Error al compartir el partido:",_),p.notify({type:"negative",message:"Error al compartir el partido."})}},ne=()=>{a.back()},J=u(!1);return _e(()=>{y.query.from==="club"&&(J.value=!0),H()}),{matchDetails:c,team1:k,team2:E,loading:T,scoreTable:L,addPlayerDialog:S,searchInput:D,searchingPlayers:C,displayedPlayers:g,openAddPlayerDialog:te,searchPlayers:le,selectPlayer:se,saveScore:re,shareMatch:ie,goBack:ne,formatCategory:ee,viewPlayerProfile:ae,isClubView:J,canEditScore:U}},methods:{openChat(){this.$router.push(`/matches/${this.$route.params.matchId}/chat`)},formatDate(y){Q.locale("es-mx");const a=Q(y).format("dddd, D [de] MMMM [del] YYYY"),[p,e]=a.split(" de "),c=p.charAt(0).toUpperCase()+p.slice(1),k=e.charAt(0).toUpperCase()+e.slice(1);return c+" de "+k},goToMaps(){const y=this.matchDetails.latitude,a=this.matchDetails.longitude;if(y&&a){const p=`https://www.google.com/maps?q=${y},${a}`;window.open(p,"_blank")}else this.$q.notify({message:"Ubicaci\xF3n no disponible",color:"negative",position:"top"})}}},Fe={class:"header-content"},Re={class:"greeting"},Ye={class:"header-icons"},Le={key:0,class:"text-center"},He={key:1},Ge={class:"row items-center",style:{position:"relative",width:"100%","margin-bottom":"20px"}},Oe={class:"row",style:{position:"absolute",right:"0"}},Ke={class:"court-container"},We={class:"court"},Xe={class:"player team1-player1"},Ze=["src"],$e={key:1},ea={class:"text-caption"},aa={class:"player team1-player2"},ta=["src"],oa={key:1},la={class:"text-caption"},sa={class:"player team2-player1"},ra=["src"],ia={key:1},na={class:"text-caption"},da={class:"player team2-player2"},ca=["src"],ma={key:1},ua={class:"text-caption"},pa={key:0,class:"text-center text-grey q-mb-md"},ya={class:"score-grid"},fa={key:0,class:"text-center q-pa-md"},ga=["src"],va={key:2,class:"text-center text-grey-5 q-pa-md"};function _a(y,a,p,e,c,k){const E=w("NotificationBell"),T=w("PlayerTopMenu"),D=w("ClubTopMenu"),j=w("BannerPromoScrolling"),q=w("DesktopNavigation"),S=w("ClubNavigationMenu"),C=w("PlayerNavigationMenu");return t(),m(we,{view:"hHh lpR fFf",class:"text-white"},{default:i(()=>[s(pe,{elevated:"",class:"text-white"},{default:i(()=>[o("div",Fe,[o("div",Re,[o("img",{src:"/padelplay.png",alt:"Logo",class:"logo-icon clickable-logo",onClick:a[0]||(a[0]=(...r)=>y.goToDashboard&&y.goToDashboard(...r))})]),o("div",Ye,[s(E),e.isClubView?P("",!0):(t(),m(T,{key:0})),e.isClubView?(t(),m(D,{key:1})):P("",!0)])]),s(j)]),_:1}),e.isClubView?P("",!0):(t(),m(q,{key:0})),e.isClubView?(t(),m(S,{key:1})):P("",!0),s(Pe,null,{default:i(()=>[s(Ce,{class:"q-pa-md"},{default:i(()=>[e.loading?(t(),n("div",Le,[s(ye,{color:"primary",size:"xl"})])):(t(),n("div",He,[s(z,{class:"text-white q-pa-md match-card"},{default:i(()=>[s(A,null,{default:i(()=>[o("div",Ge,[s(b,{flat:"",onClick:e.shareMatch,style:{position:"absolute",left:"0"}},{default:i(()=>[s(V,{name:"o_share",size:"md"})]),_:1},8,["onClick"]),a[11]||(a[11]=o("h3",{class:"text-h5 text-white",style:{flex:"1",margin:"0","text-align":"center"}},"Reserva",-1)),o("div",Oe,[s(b,{flat:"",onClick:k.openChat},{default:i(()=>[s(V,{name:"o_chat",size:"md"})]),_:1},8,["onClick"])])]),o("p",null,[x(" Juegas en el club "+d(e.matchDetails.club_name||"No disponible")+" ",1),s(b,{size:"sm",flat:"",round:"",color:"orange",icon:"o_location_on",onClick:k.goToMaps},null,8,["onClick"]),x(" el dia "+d(k.formatDate(e.matchDetails.match_date))+" a las "+d(e.matchDetails.match_time.slice(0,5))+" hrs. En la cancha "+d(e.matchDetails.court_name||"No disponible")+". ",1)]),a[12]||(a[12]=o("p",null,[x("Categoria jugadores: Abierto"),o("br"),x(" Tipo de partido: Cerrado"),o("br")],-1))]),_:1})]),_:1}),s(z,{class:"match-card text-white q-pa-md"},{default:i(()=>[s(A,{class:"q-mt-md"},{default:i(()=>[a[19]||(a[19]=o("h3",{class:"text-center text-white"},"Jugadores",-1)),o("div",Ke,[o("div",We,[o("div",Xe,[e.team1[0]?(t(),n("div",{key:0,onClick:a[1]||(a[1]=r=>e.viewPlayerProfile(e.team1[0].user_id)),class:"clickable-player"},[e.team1[0].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team1[0].photo_url,alt:"Foto del jugador"},null,8,Ze)]),_:1})):(t(),n("span",$e,d(e.team1[0].first_name||"Jugador 1 Equipo 1"),1)),o("div",ea,d(e.team1[0].first_name)+" - "+d(e.formatCategory(e.team1[0].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[2]||(a[2]=r=>e.openAddPlayerDialog(1,0))}))]),o("div",aa,[e.team1[1]?(t(),n("div",{key:0,onClick:a[3]||(a[3]=r=>e.viewPlayerProfile(e.team1[1].user_id)),class:"clickable-player"},[e.team1[1].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team1[1].photo_url,alt:"Foto del jugador"},null,8,ta)]),_:1})):(t(),n("span",oa,d(e.team1[1].first_name||"Jugador 2 Equipo 1"),1)),o("div",la,d(e.team1[1].first_name)+" - "+d(e.formatCategory(e.team1[1].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[4]||(a[4]=r=>e.openAddPlayerDialog(1,1))}))]),o("div",sa,[e.team2[0]?(t(),n("div",{key:0,onClick:a[5]||(a[5]=r=>e.viewPlayerProfile(e.team2[0].user_id)),class:"clickable-player"},[e.team2[0].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team2[0].photo_url,alt:"Foto del jugador"},null,8,ra)]),_:1})):(t(),n("span",ia,d(e.team2[0].first_name||"Jugador 1 Equipo 2"),1)),o("div",na,d(e.team2[0].first_name)+" - "+d(e.formatCategory(e.team2[0].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[6]||(a[6]=r=>e.openAddPlayerDialog(2,0))}))]),o("div",da,[e.team2[1]?(t(),n("div",{key:0,onClick:a[7]||(a[7]=r=>e.viewPlayerProfile(e.team2[1].user_id)),class:"clickable-player"},[e.team2[1].photo_url?(t(),m(N,{key:0,size:"40px"},{default:i(()=>[o("img",{src:e.team2[1].photo_url,alt:"Foto del jugador"},null,8,ca)]),_:1})):(t(),n("span",ma,d(e.team2[1].first_name||"Jugador 2 Equipo 2"),1)),o("div",ua,d(e.team2[1].first_name)+" - "+d(e.formatCategory(e.team2[1].category)),1)])):(t(),m(b,{key:1,flat:"",round:"",icon:"o_person_add",onClick:a[8]||(a[8]=r=>e.openAddPlayerDialog(2,1))}))]),a[13]||(a[13]=o("div",{class:"line1"},null,-1)),a[14]||(a[14]=o("div",{class:"player parejaA vertical-text"},"Pareja A",-1)),a[15]||(a[15]=o("div",{class:"net"},null,-1)),a[16]||(a[16]=o("div",{class:"line2"},null,-1)),a[17]||(a[17]=o("div",{class:"player parejaB vertical-text"},"Pareja B",-1)),a[18]||(a[18]=o("div",{class:"horizontal-line"},null,-1))])])]),_:1})]),_:1}),s(z,{class:"match-card text-white q-pa-md"},{default:i(()=>[s(A,{class:"score-input"},{default:i(()=>[a[24]||(a[24]=o("h3",{class:"text-center text-white"},"Resultado",-1)),e.canEditScore?P("",!0):(t(),n("div",pa,[s(V,{name:"info",size:"sm",class:"q-mr-xs"}),a[20]||(a[20]=x(" Los resultados solo pueden ser ingresados despu\xE9s del partido ",-1))])),o("div",ya,[a[21]||(a[21]=o("div",{class:"header"},null,-1)),(t(!0),n(B,null,I(e.scoreTable,(r,f)=>(t(),n("div",{class:"header",key:"header-"+f}," Set "+d(f+1),1))),128)),a[22]||(a[22]=o("div",{class:"team-label"},"Pareja A",-1)),(t(!0),n(B,null,I(e.scoreTable,(r,f)=>(t(),n("div",{key:"team1-"+f,class:"score-cell"},[s(F,{modelValue:r.team1score,"onUpdate:modelValue":g=>r.team1score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,disable:!e.canEditScore,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","disable"])]))),128)),a[23]||(a[23]=o("div",{class:"team-label"},"Pareja B",-1)),(t(!0),n(B,null,I(e.scoreTable,(r,f)=>(t(),n("div",{key:"team2-"+f,class:"score-cell"},[s(F,{modelValue:r.team2score,"onUpdate:modelValue":g=>r.team2score=g,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",min:0,max:7,disable:!e.canEditScore,class:"text-white",style:{"max-width":"60px","text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","disable"])]))),128))]),s(b,{label:"Guardar Resultado",color:"primary",class:"q-mt-md",disable:!e.canEditScore,onClick:e.saveScore},null,8,["disable","onClick"])]),_:1})]),_:1})]))]),_:1})]),_:1}),s(xe,{modelValue:e.addPlayerDialog,"onUpdate:modelValue":a[10]||(a[10]=r=>e.addPlayerDialog=r)},{default:i(()=>[s(z,{style:{"min-width":"300px","max-width":"500px",width:"90vw"},class:"bg-black text-white"},{default:i(()=>[s(A,null,{default:i(()=>[a[26]||(a[26]=o("div",{class:"text-h6"},"Agregar Jugador",-1)),s(F,{modelValue:e.searchInput,"onUpdate:modelValue":[a[9]||(a[9]=r=>e.searchInput=r),e.searchPlayers],label:"Buscar por nombre",outlined:"",dense:"",class:"q-mb-md"},{prepend:i(()=>[s(V,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"]),e.searchingPlayers?(t(),n("div",fa,[s(he,{color:"primary",size:"md"})])):e.displayedPlayers.length>0?(t(),m(Me,{key:1,bordered:"",separator:"",class:"rounded-borders"},{default:i(()=>[e.searchInput?P("",!0):(t(),m(R,{key:0,header:"",class:"text-white"},{default:i(()=>[...a[25]||(a[25]=[x("Sugerencias",-1)])]),_:1})),(t(!0),n(B,null,I(e.displayedPlayers,r=>(t(),m(De,{key:r.user_id,clickable:"",onClick:f=>e.selectPlayer(r),class:"text-white"},{default:i(()=>[s(X,{avatar:""},{default:i(()=>[s(N,{size:"48px"},{default:i(()=>[r.photo_url?(t(),n("img",{key:0,src:r.photo_url,alt:"Foto del jugador"},null,8,ga)):(t(),m(V,{key:1,name:"person",size:"48px"}))]),_:2},1024)]),_:2},1024),s(X,null,{default:i(()=>[s(R,{class:"text-white"},{default:i(()=>[x(d(r.first_name)+" "+d(r.last_name),1)]),_:2},1024),s(R,{caption:"",class:"text-grey-5"},{default:i(()=>[x(d(e.formatCategory(r.category)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):e.searchInput?(t(),n("div",va," No se encontraron jugadores ")):P("",!0)]),_:1}),s(be,{align:"right"},{default:i(()=>[ke(s(b,{flat:"",label:"Cancelar",color:"negative"},null,512),[[Qe]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(C)]),_:1})}var et=Ue(Je,[["render",_a],["__scopeId","data-v-588f7571"]]);export{et as default};
